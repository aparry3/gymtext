{"version":3,"sources":["../../../../../node_modules/.pnpm/chalk%404.1.2/node_modules/chalk/source/templates.js","../../../../../node_modules/.pnpm/color-name%401.1.4/node_modules/color-name/index.js","../../../../../node_modules/.pnpm/color-convert%402.0.1/node_modules/color-convert/conversions.js","../../../../../node_modules/.pnpm/color-convert%402.0.1/node_modules/color-convert/route.js","../../../../../node_modules/.pnpm/color-convert%402.0.1/node_modules/color-convert/index.js","../../../../../node_modules/.pnpm/ansi-styles%404.3.0/node_modules/ansi-styles/index.js","../../../../../node_modules/.pnpm/chalk%404.1.2/node_modules/chalk/source/util.js","../../../../../node_modules/.pnpm/chalk%404.1.2/node_modules/chalk/source/index.js","../../../../../node_modules/.pnpm/minimalistic-assert%401.0.1/node_modules/minimalistic-assert/index.js","../../../../../node_modules/.pnpm/inherits%402.0.4/node_modules/inherits/inherits_browser.js","../../../../../node_modules/.pnpm/inherits%402.0.4/node_modules/inherits/inherits.js","../../../../../node_modules/.pnpm/hash.js%401.1.7/node_modules/hash.js/lib/hash/utils.js","../../../../../node_modules/.pnpm/hash.js%401.1.7/node_modules/hash.js/lib/hash/common.js","../../../../../node_modules/.pnpm/hash.js%401.1.7/node_modules/hash.js/lib/hash/sha/common.js","../../../../../node_modules/.pnpm/hash.js%401.1.7/node_modules/hash.js/lib/hash/sha/1.js","../../../../../node_modules/.pnpm/hash.js%401.1.7/node_modules/hash.js/lib/hash/sha/256.js","../../../../../node_modules/.pnpm/hash.js%401.1.7/node_modules/hash.js/lib/hash/sha/224.js","../../../../../node_modules/.pnpm/hash.js%401.1.7/node_modules/hash.js/lib/hash/sha/512.js","../../../../../node_modules/.pnpm/hash.js%401.1.7/node_modules/hash.js/lib/hash/sha/384.js","../../../../../node_modules/.pnpm/hash.js%401.1.7/node_modules/hash.js/lib/hash/sha.js","../../../../../node_modules/.pnpm/hash.js%401.1.7/node_modules/hash.js/lib/hash/ripemd.js","../../../../../node_modules/.pnpm/hash.js%401.1.7/node_modules/hash.js/lib/hash/hmac.js","../../../../../node_modules/.pnpm/hash.js%401.1.7/node_modules/hash.js/lib/hash.js","../../../../../node_modules/.pnpm/json-stringify-safe%405.0.1/node_modules/json-stringify-safe/stringify.js","../../../../../node_modules/.pnpm/serialize-error-cjs%400.1.4/node_modules/serialize-error-cjs/src/constructors.ts","../../../../../node_modules/.pnpm/serialize-error-cjs%400.1.4/node_modules/serialize-error-cjs/src/index.ts","../../../../../node_modules/.pnpm/ansi-regex%404.1.1/node_modules/ansi-regex/index.js","../../../../../node_modules/.pnpm/strip-ansi%405.2.0/node_modules/strip-ansi/index.js","../../../../../node_modules/.pnpm/%40inngest%2Bai%400.1.6/node_modules/%40inngest/ai/src/adapters/anthropic.ts","../../../../../node_modules/.pnpm/%40inngest%2Bai%400.1.6/node_modules/%40inngest/ai/src/adapters/gemini.ts","../../../../../node_modules/.pnpm/%40inngest%2Bai%400.1.6/node_modules/%40inngest/ai/src/adapters/openai.ts","../../../../../node_modules/.pnpm/%40inngest%2Bai%400.1.6/node_modules/%40inngest/ai/src/adapters/azure-openai.ts","../../../../../node_modules/.pnpm/%40inngest%2Bai%400.1.6/node_modules/%40inngest/ai/src/adapters/grok.ts","../../../../../node_modules/.pnpm/%40inngest%2Bai%400.1.6/node_modules/%40inngest/ai/src/adapters/index.ts","../../../../../node_modules/.pnpm/%40inngest%2Bai%400.1.6/node_modules/%40inngest/ai/src/env.ts","../../../../../node_modules/.pnpm/%40inngest%2Bai%400.1.6/node_modules/%40inngest/ai/src/models/anthropic.ts","../../../../../node_modules/.pnpm/%40inngest%2Bai%400.1.6/node_modules/%40inngest/ai/src/models/gemini.ts","../../../../../node_modules/.pnpm/%40inngest%2Bai%400.1.6/node_modules/%40inngest/ai/src/models/openai.ts","../../../../../node_modules/.pnpm/%40inngest%2Bai%400.1.6/node_modules/%40inngest/ai/src/models/azure-openai.ts","../../../../../node_modules/.pnpm/%40inngest%2Bai%400.1.6/node_modules/%40inngest/ai/src/models/deepseek.ts","../../../../../node_modules/.pnpm/%40inngest%2Bai%400.1.6/node_modules/%40inngest/ai/src/models/grok.ts","../../../../../node_modules/.pnpm/%40inngest%2Bai%400.1.6/node_modules/%40inngest/ai/src/models/index.ts","../../../../../node_modules/.pnpm/%40inngest%2Bai%400.1.6/node_modules/%40inngest/ai/src/index.ts","../../../../../node_modules/.pnpm/canonicalize%401.0.8/node_modules/canonicalize/lib/canonicalize.js","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/inngest/_virtual/rolldown_runtime.js","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/middleware/logger.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/version.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/helpers/net.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/helpers/temporal.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/components/Fetch.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/helpers/strings.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/components/execution/als.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/api/schema.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/components/execution/otel/access.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/helpers/crypto.ts","../../../../../packages/shared/src/server/connections/inngest/client.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/helpers/devserver.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/api/api.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/components/InngestStepTools.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/helpers/functions.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/components/StepError.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/components/InngestFunctionReference.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/components/RetryAfterError.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/helpers/env.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/types.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/components/InngestFunction.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/components/execution/InngestExecution.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/helpers/consts.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/components/execution/v0.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/components/NonRetriableError.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/helpers/promises.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/helpers/errors.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/components/execution/v2.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/components/execution/v1.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/components/InngestMiddleware.ts","../../../../../node_modules/.pnpm/inngest%403.44.2_next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1_aqryshwx65ukc2vlnvytyvdbs4/node_modules/src/components/Inngest.ts"],"sourcesContent":["'use strict';\nconst TEMPLATE_REGEX = /(?:\\\\(u(?:[a-f\\d]{4}|\\{[a-f\\d]{1,6}\\})|x[a-f\\d]{2}|.))|(?:\\{(~)?(\\w+(?:\\([^)]*\\))?(?:\\.\\w+(?:\\([^)]*\\))?)*)(?:[ \\t]|(?=\\r?\\n)))|(\\})|((?:.|[\\r\\n\\f])+?)/gi;\nconst STYLE_REGEX = /(?:^|\\.)(\\w+)(?:\\(([^)]*)\\))?/g;\nconst STRING_REGEX = /^(['\"])((?:\\\\.|(?!\\1)[^\\\\])*)\\1$/;\nconst ESCAPE_REGEX = /\\\\(u(?:[a-f\\d]{4}|{[a-f\\d]{1,6}})|x[a-f\\d]{2}|.)|([^\\\\])/gi;\n\nconst ESCAPES = new Map([\n\t['n', '\\n'],\n\t['r', '\\r'],\n\t['t', '\\t'],\n\t['b', '\\b'],\n\t['f', '\\f'],\n\t['v', '\\v'],\n\t['0', '\\0'],\n\t['\\\\', '\\\\'],\n\t['e', '\\u001B'],\n\t['a', '\\u0007']\n]);\n\nfunction unescape(c) {\n\tconst u = c[0] === 'u';\n\tconst bracket = c[1] === '{';\n\n\tif ((u && !bracket && c.length === 5) || (c[0] === 'x' && c.length === 3)) {\n\t\treturn String.fromCharCode(parseInt(c.slice(1), 16));\n\t}\n\n\tif (u && bracket) {\n\t\treturn String.fromCodePoint(parseInt(c.slice(2, -1), 16));\n\t}\n\n\treturn ESCAPES.get(c) || c;\n}\n\nfunction parseArguments(name, arguments_) {\n\tconst results = [];\n\tconst chunks = arguments_.trim().split(/\\s*,\\s*/g);\n\tlet matches;\n\n\tfor (const chunk of chunks) {\n\t\tconst number = Number(chunk);\n\t\tif (!Number.isNaN(number)) {\n\t\t\tresults.push(number);\n\t\t} else if ((matches = chunk.match(STRING_REGEX))) {\n\t\t\tresults.push(matches[2].replace(ESCAPE_REGEX, (m, escape, character) => escape ? unescape(escape) : character));\n\t\t} else {\n\t\t\tthrow new Error(`Invalid Chalk template style argument: ${chunk} (in style '${name}')`);\n\t\t}\n\t}\n\n\treturn results;\n}\n\nfunction parseStyle(style) {\n\tSTYLE_REGEX.lastIndex = 0;\n\n\tconst results = [];\n\tlet matches;\n\n\twhile ((matches = STYLE_REGEX.exec(style)) !== null) {\n\t\tconst name = matches[1];\n\n\t\tif (matches[2]) {\n\t\t\tconst args = parseArguments(name, matches[2]);\n\t\t\tresults.push([name].concat(args));\n\t\t} else {\n\t\t\tresults.push([name]);\n\t\t}\n\t}\n\n\treturn results;\n}\n\nfunction buildStyle(chalk, styles) {\n\tconst enabled = {};\n\n\tfor (const layer of styles) {\n\t\tfor (const style of layer.styles) {\n\t\t\tenabled[style[0]] = layer.inverse ? null : style.slice(1);\n\t\t}\n\t}\n\n\tlet current = chalk;\n\tfor (const [styleName, styles] of Object.entries(enabled)) {\n\t\tif (!Array.isArray(styles)) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!(styleName in current)) {\n\t\t\tthrow new Error(`Unknown Chalk style: ${styleName}`);\n\t\t}\n\n\t\tcurrent = styles.length > 0 ? current[styleName](...styles) : current[styleName];\n\t}\n\n\treturn current;\n}\n\nmodule.exports = (chalk, temporary) => {\n\tconst styles = [];\n\tconst chunks = [];\n\tlet chunk = [];\n\n\t// eslint-disable-next-line max-params\n\ttemporary.replace(TEMPLATE_REGEX, (m, escapeCharacter, inverse, style, close, character) => {\n\t\tif (escapeCharacter) {\n\t\t\tchunk.push(unescape(escapeCharacter));\n\t\t} else if (style) {\n\t\t\tconst string = chunk.join('');\n\t\t\tchunk = [];\n\t\t\tchunks.push(styles.length === 0 ? string : buildStyle(chalk, styles)(string));\n\t\t\tstyles.push({inverse, styles: parseStyle(style)});\n\t\t} else if (close) {\n\t\t\tif (styles.length === 0) {\n\t\t\t\tthrow new Error('Found extraneous } in Chalk template literal');\n\t\t\t}\n\n\t\t\tchunks.push(buildStyle(chalk, styles)(chunk.join('')));\n\t\t\tchunk = [];\n\t\t\tstyles.pop();\n\t\t} else {\n\t\t\tchunk.push(character);\n\t\t}\n\t});\n\n\tchunks.push(chunk.join(''));\n\n\tif (styles.length > 0) {\n\t\tconst errMessage = `Chalk template literal is missing ${styles.length} closing bracket${styles.length === 1 ? '' : 's'} (\\`}\\`)`;\n\t\tthrow new Error(errMessage);\n\t}\n\n\treturn chunks.join('');\n};\n","'use strict'\r\n\r\nmodule.exports = {\r\n\t\"aliceblue\": [240, 248, 255],\r\n\t\"antiquewhite\": [250, 235, 215],\r\n\t\"aqua\": [0, 255, 255],\r\n\t\"aquamarine\": [127, 255, 212],\r\n\t\"azure\": [240, 255, 255],\r\n\t\"beige\": [245, 245, 220],\r\n\t\"bisque\": [255, 228, 196],\r\n\t\"black\": [0, 0, 0],\r\n\t\"blanchedalmond\": [255, 235, 205],\r\n\t\"blue\": [0, 0, 255],\r\n\t\"blueviolet\": [138, 43, 226],\r\n\t\"brown\": [165, 42, 42],\r\n\t\"burlywood\": [222, 184, 135],\r\n\t\"cadetblue\": [95, 158, 160],\r\n\t\"chartreuse\": [127, 255, 0],\r\n\t\"chocolate\": [210, 105, 30],\r\n\t\"coral\": [255, 127, 80],\r\n\t\"cornflowerblue\": [100, 149, 237],\r\n\t\"cornsilk\": [255, 248, 220],\r\n\t\"crimson\": [220, 20, 60],\r\n\t\"cyan\": [0, 255, 255],\r\n\t\"darkblue\": [0, 0, 139],\r\n\t\"darkcyan\": [0, 139, 139],\r\n\t\"darkgoldenrod\": [184, 134, 11],\r\n\t\"darkgray\": [169, 169, 169],\r\n\t\"darkgreen\": [0, 100, 0],\r\n\t\"darkgrey\": [169, 169, 169],\r\n\t\"darkkhaki\": [189, 183, 107],\r\n\t\"darkmagenta\": [139, 0, 139],\r\n\t\"darkolivegreen\": [85, 107, 47],\r\n\t\"darkorange\": [255, 140, 0],\r\n\t\"darkorchid\": [153, 50, 204],\r\n\t\"darkred\": [139, 0, 0],\r\n\t\"darksalmon\": [233, 150, 122],\r\n\t\"darkseagreen\": [143, 188, 143],\r\n\t\"darkslateblue\": [72, 61, 139],\r\n\t\"darkslategray\": [47, 79, 79],\r\n\t\"darkslategrey\": [47, 79, 79],\r\n\t\"darkturquoise\": [0, 206, 209],\r\n\t\"darkviolet\": [148, 0, 211],\r\n\t\"deeppink\": [255, 20, 147],\r\n\t\"deepskyblue\": [0, 191, 255],\r\n\t\"dimgray\": [105, 105, 105],\r\n\t\"dimgrey\": [105, 105, 105],\r\n\t\"dodgerblue\": [30, 144, 255],\r\n\t\"firebrick\": [178, 34, 34],\r\n\t\"floralwhite\": [255, 250, 240],\r\n\t\"forestgreen\": [34, 139, 34],\r\n\t\"fuchsia\": [255, 0, 255],\r\n\t\"gainsboro\": [220, 220, 220],\r\n\t\"ghostwhite\": [248, 248, 255],\r\n\t\"gold\": [255, 215, 0],\r\n\t\"goldenrod\": [218, 165, 32],\r\n\t\"gray\": [128, 128, 128],\r\n\t\"green\": [0, 128, 0],\r\n\t\"greenyellow\": [173, 255, 47],\r\n\t\"grey\": [128, 128, 128],\r\n\t\"honeydew\": [240, 255, 240],\r\n\t\"hotpink\": [255, 105, 180],\r\n\t\"indianred\": [205, 92, 92],\r\n\t\"indigo\": [75, 0, 130],\r\n\t\"ivory\": [255, 255, 240],\r\n\t\"khaki\": [240, 230, 140],\r\n\t\"lavender\": [230, 230, 250],\r\n\t\"lavenderblush\": [255, 240, 245],\r\n\t\"lawngreen\": [124, 252, 0],\r\n\t\"lemonchiffon\": [255, 250, 205],\r\n\t\"lightblue\": [173, 216, 230],\r\n\t\"lightcoral\": [240, 128, 128],\r\n\t\"lightcyan\": [224, 255, 255],\r\n\t\"lightgoldenrodyellow\": [250, 250, 210],\r\n\t\"lightgray\": [211, 211, 211],\r\n\t\"lightgreen\": [144, 238, 144],\r\n\t\"lightgrey\": [211, 211, 211],\r\n\t\"lightpink\": [255, 182, 193],\r\n\t\"lightsalmon\": [255, 160, 122],\r\n\t\"lightseagreen\": [32, 178, 170],\r\n\t\"lightskyblue\": [135, 206, 250],\r\n\t\"lightslategray\": [119, 136, 153],\r\n\t\"lightslategrey\": [119, 136, 153],\r\n\t\"lightsteelblue\": [176, 196, 222],\r\n\t\"lightyellow\": [255, 255, 224],\r\n\t\"lime\": [0, 255, 0],\r\n\t\"limegreen\": [50, 205, 50],\r\n\t\"linen\": [250, 240, 230],\r\n\t\"magenta\": [255, 0, 255],\r\n\t\"maroon\": [128, 0, 0],\r\n\t\"mediumaquamarine\": [102, 205, 170],\r\n\t\"mediumblue\": [0, 0, 205],\r\n\t\"mediumorchid\": [186, 85, 211],\r\n\t\"mediumpurple\": [147, 112, 219],\r\n\t\"mediumseagreen\": [60, 179, 113],\r\n\t\"mediumslateblue\": [123, 104, 238],\r\n\t\"mediumspringgreen\": [0, 250, 154],\r\n\t\"mediumturquoise\": [72, 209, 204],\r\n\t\"mediumvioletred\": [199, 21, 133],\r\n\t\"midnightblue\": [25, 25, 112],\r\n\t\"mintcream\": [245, 255, 250],\r\n\t\"mistyrose\": [255, 228, 225],\r\n\t\"moccasin\": [255, 228, 181],\r\n\t\"navajowhite\": [255, 222, 173],\r\n\t\"navy\": [0, 0, 128],\r\n\t\"oldlace\": [253, 245, 230],\r\n\t\"olive\": [128, 128, 0],\r\n\t\"olivedrab\": [107, 142, 35],\r\n\t\"orange\": [255, 165, 0],\r\n\t\"orangered\": [255, 69, 0],\r\n\t\"orchid\": [218, 112, 214],\r\n\t\"palegoldenrod\": [238, 232, 170],\r\n\t\"palegreen\": [152, 251, 152],\r\n\t\"paleturquoise\": [175, 238, 238],\r\n\t\"palevioletred\": [219, 112, 147],\r\n\t\"papayawhip\": [255, 239, 213],\r\n\t\"peachpuff\": [255, 218, 185],\r\n\t\"peru\": [205, 133, 63],\r\n\t\"pink\": [255, 192, 203],\r\n\t\"plum\": [221, 160, 221],\r\n\t\"powderblue\": [176, 224, 230],\r\n\t\"purple\": [128, 0, 128],\r\n\t\"rebeccapurple\": [102, 51, 153],\r\n\t\"red\": [255, 0, 0],\r\n\t\"rosybrown\": [188, 143, 143],\r\n\t\"royalblue\": [65, 105, 225],\r\n\t\"saddlebrown\": [139, 69, 19],\r\n\t\"salmon\": [250, 128, 114],\r\n\t\"sandybrown\": [244, 164, 96],\r\n\t\"seagreen\": [46, 139, 87],\r\n\t\"seashell\": [255, 245, 238],\r\n\t\"sienna\": [160, 82, 45],\r\n\t\"silver\": [192, 192, 192],\r\n\t\"skyblue\": [135, 206, 235],\r\n\t\"slateblue\": [106, 90, 205],\r\n\t\"slategray\": [112, 128, 144],\r\n\t\"slategrey\": [112, 128, 144],\r\n\t\"snow\": [255, 250, 250],\r\n\t\"springgreen\": [0, 255, 127],\r\n\t\"steelblue\": [70, 130, 180],\r\n\t\"tan\": [210, 180, 140],\r\n\t\"teal\": [0, 128, 128],\r\n\t\"thistle\": [216, 191, 216],\r\n\t\"tomato\": [255, 99, 71],\r\n\t\"turquoise\": [64, 224, 208],\r\n\t\"violet\": [238, 130, 238],\r\n\t\"wheat\": [245, 222, 179],\r\n\t\"white\": [255, 255, 255],\r\n\t\"whitesmoke\": [245, 245, 245],\r\n\t\"yellow\": [255, 255, 0],\r\n\t\"yellowgreen\": [154, 205, 50]\r\n};\r\n","/* MIT license */\n/* eslint-disable no-mixed-operators */\nconst cssKeywords = require('color-name');\n\n// NOTE: conversions should only return primitive values (i.e. arrays, or\n//       values that give correct `typeof` results).\n//       do not use box values types (i.e. Number(), String(), etc.)\n\nconst reverseKeywords = {};\nfor (const key of Object.keys(cssKeywords)) {\n\treverseKeywords[cssKeywords[key]] = key;\n}\n\nconst convert = {\n\trgb: {channels: 3, labels: 'rgb'},\n\thsl: {channels: 3, labels: 'hsl'},\n\thsv: {channels: 3, labels: 'hsv'},\n\thwb: {channels: 3, labels: 'hwb'},\n\tcmyk: {channels: 4, labels: 'cmyk'},\n\txyz: {channels: 3, labels: 'xyz'},\n\tlab: {channels: 3, labels: 'lab'},\n\tlch: {channels: 3, labels: 'lch'},\n\thex: {channels: 1, labels: ['hex']},\n\tkeyword: {channels: 1, labels: ['keyword']},\n\tansi16: {channels: 1, labels: ['ansi16']},\n\tansi256: {channels: 1, labels: ['ansi256']},\n\thcg: {channels: 3, labels: ['h', 'c', 'g']},\n\tapple: {channels: 3, labels: ['r16', 'g16', 'b16']},\n\tgray: {channels: 1, labels: ['gray']}\n};\n\nmodule.exports = convert;\n\n// Hide .channels and .labels properties\nfor (const model of Object.keys(convert)) {\n\tif (!('channels' in convert[model])) {\n\t\tthrow new Error('missing channels property: ' + model);\n\t}\n\n\tif (!('labels' in convert[model])) {\n\t\tthrow new Error('missing channel labels property: ' + model);\n\t}\n\n\tif (convert[model].labels.length !== convert[model].channels) {\n\t\tthrow new Error('channel and label counts mismatch: ' + model);\n\t}\n\n\tconst {channels, labels} = convert[model];\n\tdelete convert[model].channels;\n\tdelete convert[model].labels;\n\tObject.defineProperty(convert[model], 'channels', {value: channels});\n\tObject.defineProperty(convert[model], 'labels', {value: labels});\n}\n\nconvert.rgb.hsl = function (rgb) {\n\tconst r = rgb[0] / 255;\n\tconst g = rgb[1] / 255;\n\tconst b = rgb[2] / 255;\n\tconst min = Math.min(r, g, b);\n\tconst max = Math.max(r, g, b);\n\tconst delta = max - min;\n\tlet h;\n\tlet s;\n\n\tif (max === min) {\n\t\th = 0;\n\t} else if (r === max) {\n\t\th = (g - b) / delta;\n\t} else if (g === max) {\n\t\th = 2 + (b - r) / delta;\n\t} else if (b === max) {\n\t\th = 4 + (r - g) / delta;\n\t}\n\n\th = Math.min(h * 60, 360);\n\n\tif (h < 0) {\n\t\th += 360;\n\t}\n\n\tconst l = (min + max) / 2;\n\n\tif (max === min) {\n\t\ts = 0;\n\t} else if (l <= 0.5) {\n\t\ts = delta / (max + min);\n\t} else {\n\t\ts = delta / (2 - max - min);\n\t}\n\n\treturn [h, s * 100, l * 100];\n};\n\nconvert.rgb.hsv = function (rgb) {\n\tlet rdif;\n\tlet gdif;\n\tlet bdif;\n\tlet h;\n\tlet s;\n\n\tconst r = rgb[0] / 255;\n\tconst g = rgb[1] / 255;\n\tconst b = rgb[2] / 255;\n\tconst v = Math.max(r, g, b);\n\tconst diff = v - Math.min(r, g, b);\n\tconst diffc = function (c) {\n\t\treturn (v - c) / 6 / diff + 1 / 2;\n\t};\n\n\tif (diff === 0) {\n\t\th = 0;\n\t\ts = 0;\n\t} else {\n\t\ts = diff / v;\n\t\trdif = diffc(r);\n\t\tgdif = diffc(g);\n\t\tbdif = diffc(b);\n\n\t\tif (r === v) {\n\t\t\th = bdif - gdif;\n\t\t} else if (g === v) {\n\t\t\th = (1 / 3) + rdif - bdif;\n\t\t} else if (b === v) {\n\t\t\th = (2 / 3) + gdif - rdif;\n\t\t}\n\n\t\tif (h < 0) {\n\t\t\th += 1;\n\t\t} else if (h > 1) {\n\t\t\th -= 1;\n\t\t}\n\t}\n\n\treturn [\n\t\th * 360,\n\t\ts * 100,\n\t\tv * 100\n\t];\n};\n\nconvert.rgb.hwb = function (rgb) {\n\tconst r = rgb[0];\n\tconst g = rgb[1];\n\tlet b = rgb[2];\n\tconst h = convert.rgb.hsl(rgb)[0];\n\tconst w = 1 / 255 * Math.min(r, Math.min(g, b));\n\n\tb = 1 - 1 / 255 * Math.max(r, Math.max(g, b));\n\n\treturn [h, w * 100, b * 100];\n};\n\nconvert.rgb.cmyk = function (rgb) {\n\tconst r = rgb[0] / 255;\n\tconst g = rgb[1] / 255;\n\tconst b = rgb[2] / 255;\n\n\tconst k = Math.min(1 - r, 1 - g, 1 - b);\n\tconst c = (1 - r - k) / (1 - k) || 0;\n\tconst m = (1 - g - k) / (1 - k) || 0;\n\tconst y = (1 - b - k) / (1 - k) || 0;\n\n\treturn [c * 100, m * 100, y * 100, k * 100];\n};\n\nfunction comparativeDistance(x, y) {\n\t/*\n\t\tSee https://en.m.wikipedia.org/wiki/Euclidean_distance#Squared_Euclidean_distance\n\t*/\n\treturn (\n\t\t((x[0] - y[0]) ** 2) +\n\t\t((x[1] - y[1]) ** 2) +\n\t\t((x[2] - y[2]) ** 2)\n\t);\n}\n\nconvert.rgb.keyword = function (rgb) {\n\tconst reversed = reverseKeywords[rgb];\n\tif (reversed) {\n\t\treturn reversed;\n\t}\n\n\tlet currentClosestDistance = Infinity;\n\tlet currentClosestKeyword;\n\n\tfor (const keyword of Object.keys(cssKeywords)) {\n\t\tconst value = cssKeywords[keyword];\n\n\t\t// Compute comparative distance\n\t\tconst distance = comparativeDistance(rgb, value);\n\n\t\t// Check if its less, if so set as closest\n\t\tif (distance < currentClosestDistance) {\n\t\t\tcurrentClosestDistance = distance;\n\t\t\tcurrentClosestKeyword = keyword;\n\t\t}\n\t}\n\n\treturn currentClosestKeyword;\n};\n\nconvert.keyword.rgb = function (keyword) {\n\treturn cssKeywords[keyword];\n};\n\nconvert.rgb.xyz = function (rgb) {\n\tlet r = rgb[0] / 255;\n\tlet g = rgb[1] / 255;\n\tlet b = rgb[2] / 255;\n\n\t// Assume sRGB\n\tr = r > 0.04045 ? (((r + 0.055) / 1.055) ** 2.4) : (r / 12.92);\n\tg = g > 0.04045 ? (((g + 0.055) / 1.055) ** 2.4) : (g / 12.92);\n\tb = b > 0.04045 ? (((b + 0.055) / 1.055) ** 2.4) : (b / 12.92);\n\n\tconst x = (r * 0.4124) + (g * 0.3576) + (b * 0.1805);\n\tconst y = (r * 0.2126) + (g * 0.7152) + (b * 0.0722);\n\tconst z = (r * 0.0193) + (g * 0.1192) + (b * 0.9505);\n\n\treturn [x * 100, y * 100, z * 100];\n};\n\nconvert.rgb.lab = function (rgb) {\n\tconst xyz = convert.rgb.xyz(rgb);\n\tlet x = xyz[0];\n\tlet y = xyz[1];\n\tlet z = xyz[2];\n\n\tx /= 95.047;\n\ty /= 100;\n\tz /= 108.883;\n\n\tx = x > 0.008856 ? (x ** (1 / 3)) : (7.787 * x) + (16 / 116);\n\ty = y > 0.008856 ? (y ** (1 / 3)) : (7.787 * y) + (16 / 116);\n\tz = z > 0.008856 ? (z ** (1 / 3)) : (7.787 * z) + (16 / 116);\n\n\tconst l = (116 * y) - 16;\n\tconst a = 500 * (x - y);\n\tconst b = 200 * (y - z);\n\n\treturn [l, a, b];\n};\n\nconvert.hsl.rgb = function (hsl) {\n\tconst h = hsl[0] / 360;\n\tconst s = hsl[1] / 100;\n\tconst l = hsl[2] / 100;\n\tlet t2;\n\tlet t3;\n\tlet val;\n\n\tif (s === 0) {\n\t\tval = l * 255;\n\t\treturn [val, val, val];\n\t}\n\n\tif (l < 0.5) {\n\t\tt2 = l * (1 + s);\n\t} else {\n\t\tt2 = l + s - l * s;\n\t}\n\n\tconst t1 = 2 * l - t2;\n\n\tconst rgb = [0, 0, 0];\n\tfor (let i = 0; i < 3; i++) {\n\t\tt3 = h + 1 / 3 * -(i - 1);\n\t\tif (t3 < 0) {\n\t\t\tt3++;\n\t\t}\n\n\t\tif (t3 > 1) {\n\t\t\tt3--;\n\t\t}\n\n\t\tif (6 * t3 < 1) {\n\t\t\tval = t1 + (t2 - t1) * 6 * t3;\n\t\t} else if (2 * t3 < 1) {\n\t\t\tval = t2;\n\t\t} else if (3 * t3 < 2) {\n\t\t\tval = t1 + (t2 - t1) * (2 / 3 - t3) * 6;\n\t\t} else {\n\t\t\tval = t1;\n\t\t}\n\n\t\trgb[i] = val * 255;\n\t}\n\n\treturn rgb;\n};\n\nconvert.hsl.hsv = function (hsl) {\n\tconst h = hsl[0];\n\tlet s = hsl[1] / 100;\n\tlet l = hsl[2] / 100;\n\tlet smin = s;\n\tconst lmin = Math.max(l, 0.01);\n\n\tl *= 2;\n\ts *= (l <= 1) ? l : 2 - l;\n\tsmin *= lmin <= 1 ? lmin : 2 - lmin;\n\tconst v = (l + s) / 2;\n\tconst sv = l === 0 ? (2 * smin) / (lmin + smin) : (2 * s) / (l + s);\n\n\treturn [h, sv * 100, v * 100];\n};\n\nconvert.hsv.rgb = function (hsv) {\n\tconst h = hsv[0] / 60;\n\tconst s = hsv[1] / 100;\n\tlet v = hsv[2] / 100;\n\tconst hi = Math.floor(h) % 6;\n\n\tconst f = h - Math.floor(h);\n\tconst p = 255 * v * (1 - s);\n\tconst q = 255 * v * (1 - (s * f));\n\tconst t = 255 * v * (1 - (s * (1 - f)));\n\tv *= 255;\n\n\tswitch (hi) {\n\t\tcase 0:\n\t\t\treturn [v, t, p];\n\t\tcase 1:\n\t\t\treturn [q, v, p];\n\t\tcase 2:\n\t\t\treturn [p, v, t];\n\t\tcase 3:\n\t\t\treturn [p, q, v];\n\t\tcase 4:\n\t\t\treturn [t, p, v];\n\t\tcase 5:\n\t\t\treturn [v, p, q];\n\t}\n};\n\nconvert.hsv.hsl = function (hsv) {\n\tconst h = hsv[0];\n\tconst s = hsv[1] / 100;\n\tconst v = hsv[2] / 100;\n\tconst vmin = Math.max(v, 0.01);\n\tlet sl;\n\tlet l;\n\n\tl = (2 - s) * v;\n\tconst lmin = (2 - s) * vmin;\n\tsl = s * vmin;\n\tsl /= (lmin <= 1) ? lmin : 2 - lmin;\n\tsl = sl || 0;\n\tl /= 2;\n\n\treturn [h, sl * 100, l * 100];\n};\n\n// http://dev.w3.org/csswg/css-color/#hwb-to-rgb\nconvert.hwb.rgb = function (hwb) {\n\tconst h = hwb[0] / 360;\n\tlet wh = hwb[1] / 100;\n\tlet bl = hwb[2] / 100;\n\tconst ratio = wh + bl;\n\tlet f;\n\n\t// Wh + bl cant be > 1\n\tif (ratio > 1) {\n\t\twh /= ratio;\n\t\tbl /= ratio;\n\t}\n\n\tconst i = Math.floor(6 * h);\n\tconst v = 1 - bl;\n\tf = 6 * h - i;\n\n\tif ((i & 0x01) !== 0) {\n\t\tf = 1 - f;\n\t}\n\n\tconst n = wh + f * (v - wh); // Linear interpolation\n\n\tlet r;\n\tlet g;\n\tlet b;\n\t/* eslint-disable max-statements-per-line,no-multi-spaces */\n\tswitch (i) {\n\t\tdefault:\n\t\tcase 6:\n\t\tcase 0: r = v;  g = n;  b = wh; break;\n\t\tcase 1: r = n;  g = v;  b = wh; break;\n\t\tcase 2: r = wh; g = v;  b = n; break;\n\t\tcase 3: r = wh; g = n;  b = v; break;\n\t\tcase 4: r = n;  g = wh; b = v; break;\n\t\tcase 5: r = v;  g = wh; b = n; break;\n\t}\n\t/* eslint-enable max-statements-per-line,no-multi-spaces */\n\n\treturn [r * 255, g * 255, b * 255];\n};\n\nconvert.cmyk.rgb = function (cmyk) {\n\tconst c = cmyk[0] / 100;\n\tconst m = cmyk[1] / 100;\n\tconst y = cmyk[2] / 100;\n\tconst k = cmyk[3] / 100;\n\n\tconst r = 1 - Math.min(1, c * (1 - k) + k);\n\tconst g = 1 - Math.min(1, m * (1 - k) + k);\n\tconst b = 1 - Math.min(1, y * (1 - k) + k);\n\n\treturn [r * 255, g * 255, b * 255];\n};\n\nconvert.xyz.rgb = function (xyz) {\n\tconst x = xyz[0] / 100;\n\tconst y = xyz[1] / 100;\n\tconst z = xyz[2] / 100;\n\tlet r;\n\tlet g;\n\tlet b;\n\n\tr = (x * 3.2406) + (y * -1.5372) + (z * -0.4986);\n\tg = (x * -0.9689) + (y * 1.8758) + (z * 0.0415);\n\tb = (x * 0.0557) + (y * -0.2040) + (z * 1.0570);\n\n\t// Assume sRGB\n\tr = r > 0.0031308\n\t\t? ((1.055 * (r ** (1.0 / 2.4))) - 0.055)\n\t\t: r * 12.92;\n\n\tg = g > 0.0031308\n\t\t? ((1.055 * (g ** (1.0 / 2.4))) - 0.055)\n\t\t: g * 12.92;\n\n\tb = b > 0.0031308\n\t\t? ((1.055 * (b ** (1.0 / 2.4))) - 0.055)\n\t\t: b * 12.92;\n\n\tr = Math.min(Math.max(0, r), 1);\n\tg = Math.min(Math.max(0, g), 1);\n\tb = Math.min(Math.max(0, b), 1);\n\n\treturn [r * 255, g * 255, b * 255];\n};\n\nconvert.xyz.lab = function (xyz) {\n\tlet x = xyz[0];\n\tlet y = xyz[1];\n\tlet z = xyz[2];\n\n\tx /= 95.047;\n\ty /= 100;\n\tz /= 108.883;\n\n\tx = x > 0.008856 ? (x ** (1 / 3)) : (7.787 * x) + (16 / 116);\n\ty = y > 0.008856 ? (y ** (1 / 3)) : (7.787 * y) + (16 / 116);\n\tz = z > 0.008856 ? (z ** (1 / 3)) : (7.787 * z) + (16 / 116);\n\n\tconst l = (116 * y) - 16;\n\tconst a = 500 * (x - y);\n\tconst b = 200 * (y - z);\n\n\treturn [l, a, b];\n};\n\nconvert.lab.xyz = function (lab) {\n\tconst l = lab[0];\n\tconst a = lab[1];\n\tconst b = lab[2];\n\tlet x;\n\tlet y;\n\tlet z;\n\n\ty = (l + 16) / 116;\n\tx = a / 500 + y;\n\tz = y - b / 200;\n\n\tconst y2 = y ** 3;\n\tconst x2 = x ** 3;\n\tconst z2 = z ** 3;\n\ty = y2 > 0.008856 ? y2 : (y - 16 / 116) / 7.787;\n\tx = x2 > 0.008856 ? x2 : (x - 16 / 116) / 7.787;\n\tz = z2 > 0.008856 ? z2 : (z - 16 / 116) / 7.787;\n\n\tx *= 95.047;\n\ty *= 100;\n\tz *= 108.883;\n\n\treturn [x, y, z];\n};\n\nconvert.lab.lch = function (lab) {\n\tconst l = lab[0];\n\tconst a = lab[1];\n\tconst b = lab[2];\n\tlet h;\n\n\tconst hr = Math.atan2(b, a);\n\th = hr * 360 / 2 / Math.PI;\n\n\tif (h < 0) {\n\t\th += 360;\n\t}\n\n\tconst c = Math.sqrt(a * a + b * b);\n\n\treturn [l, c, h];\n};\n\nconvert.lch.lab = function (lch) {\n\tconst l = lch[0];\n\tconst c = lch[1];\n\tconst h = lch[2];\n\n\tconst hr = h / 360 * 2 * Math.PI;\n\tconst a = c * Math.cos(hr);\n\tconst b = c * Math.sin(hr);\n\n\treturn [l, a, b];\n};\n\nconvert.rgb.ansi16 = function (args, saturation = null) {\n\tconst [r, g, b] = args;\n\tlet value = saturation === null ? convert.rgb.hsv(args)[2] : saturation; // Hsv -> ansi16 optimization\n\n\tvalue = Math.round(value / 50);\n\n\tif (value === 0) {\n\t\treturn 30;\n\t}\n\n\tlet ansi = 30\n\t\t+ ((Math.round(b / 255) << 2)\n\t\t| (Math.round(g / 255) << 1)\n\t\t| Math.round(r / 255));\n\n\tif (value === 2) {\n\t\tansi += 60;\n\t}\n\n\treturn ansi;\n};\n\nconvert.hsv.ansi16 = function (args) {\n\t// Optimization here; we already know the value and don't need to get\n\t// it converted for us.\n\treturn convert.rgb.ansi16(convert.hsv.rgb(args), args[2]);\n};\n\nconvert.rgb.ansi256 = function (args) {\n\tconst r = args[0];\n\tconst g = args[1];\n\tconst b = args[2];\n\n\t// We use the extended greyscale palette here, with the exception of\n\t// black and white. normal palette only has 4 greyscale shades.\n\tif (r === g && g === b) {\n\t\tif (r < 8) {\n\t\t\treturn 16;\n\t\t}\n\n\t\tif (r > 248) {\n\t\t\treturn 231;\n\t\t}\n\n\t\treturn Math.round(((r - 8) / 247) * 24) + 232;\n\t}\n\n\tconst ansi = 16\n\t\t+ (36 * Math.round(r / 255 * 5))\n\t\t+ (6 * Math.round(g / 255 * 5))\n\t\t+ Math.round(b / 255 * 5);\n\n\treturn ansi;\n};\n\nconvert.ansi16.rgb = function (args) {\n\tlet color = args % 10;\n\n\t// Handle greyscale\n\tif (color === 0 || color === 7) {\n\t\tif (args > 50) {\n\t\t\tcolor += 3.5;\n\t\t}\n\n\t\tcolor = color / 10.5 * 255;\n\n\t\treturn [color, color, color];\n\t}\n\n\tconst mult = (~~(args > 50) + 1) * 0.5;\n\tconst r = ((color & 1) * mult) * 255;\n\tconst g = (((color >> 1) & 1) * mult) * 255;\n\tconst b = (((color >> 2) & 1) * mult) * 255;\n\n\treturn [r, g, b];\n};\n\nconvert.ansi256.rgb = function (args) {\n\t// Handle greyscale\n\tif (args >= 232) {\n\t\tconst c = (args - 232) * 10 + 8;\n\t\treturn [c, c, c];\n\t}\n\n\targs -= 16;\n\n\tlet rem;\n\tconst r = Math.floor(args / 36) / 5 * 255;\n\tconst g = Math.floor((rem = args % 36) / 6) / 5 * 255;\n\tconst b = (rem % 6) / 5 * 255;\n\n\treturn [r, g, b];\n};\n\nconvert.rgb.hex = function (args) {\n\tconst integer = ((Math.round(args[0]) & 0xFF) << 16)\n\t\t+ ((Math.round(args[1]) & 0xFF) << 8)\n\t\t+ (Math.round(args[2]) & 0xFF);\n\n\tconst string = integer.toString(16).toUpperCase();\n\treturn '000000'.substring(string.length) + string;\n};\n\nconvert.hex.rgb = function (args) {\n\tconst match = args.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);\n\tif (!match) {\n\t\treturn [0, 0, 0];\n\t}\n\n\tlet colorString = match[0];\n\n\tif (match[0].length === 3) {\n\t\tcolorString = colorString.split('').map(char => {\n\t\t\treturn char + char;\n\t\t}).join('');\n\t}\n\n\tconst integer = parseInt(colorString, 16);\n\tconst r = (integer >> 16) & 0xFF;\n\tconst g = (integer >> 8) & 0xFF;\n\tconst b = integer & 0xFF;\n\n\treturn [r, g, b];\n};\n\nconvert.rgb.hcg = function (rgb) {\n\tconst r = rgb[0] / 255;\n\tconst g = rgb[1] / 255;\n\tconst b = rgb[2] / 255;\n\tconst max = Math.max(Math.max(r, g), b);\n\tconst min = Math.min(Math.min(r, g), b);\n\tconst chroma = (max - min);\n\tlet grayscale;\n\tlet hue;\n\n\tif (chroma < 1) {\n\t\tgrayscale = min / (1 - chroma);\n\t} else {\n\t\tgrayscale = 0;\n\t}\n\n\tif (chroma <= 0) {\n\t\thue = 0;\n\t} else\n\tif (max === r) {\n\t\thue = ((g - b) / chroma) % 6;\n\t} else\n\tif (max === g) {\n\t\thue = 2 + (b - r) / chroma;\n\t} else {\n\t\thue = 4 + (r - g) / chroma;\n\t}\n\n\thue /= 6;\n\thue %= 1;\n\n\treturn [hue * 360, chroma * 100, grayscale * 100];\n};\n\nconvert.hsl.hcg = function (hsl) {\n\tconst s = hsl[1] / 100;\n\tconst l = hsl[2] / 100;\n\n\tconst c = l < 0.5 ? (2.0 * s * l) : (2.0 * s * (1.0 - l));\n\n\tlet f = 0;\n\tif (c < 1.0) {\n\t\tf = (l - 0.5 * c) / (1.0 - c);\n\t}\n\n\treturn [hsl[0], c * 100, f * 100];\n};\n\nconvert.hsv.hcg = function (hsv) {\n\tconst s = hsv[1] / 100;\n\tconst v = hsv[2] / 100;\n\n\tconst c = s * v;\n\tlet f = 0;\n\n\tif (c < 1.0) {\n\t\tf = (v - c) / (1 - c);\n\t}\n\n\treturn [hsv[0], c * 100, f * 100];\n};\n\nconvert.hcg.rgb = function (hcg) {\n\tconst h = hcg[0] / 360;\n\tconst c = hcg[1] / 100;\n\tconst g = hcg[2] / 100;\n\n\tif (c === 0.0) {\n\t\treturn [g * 255, g * 255, g * 255];\n\t}\n\n\tconst pure = [0, 0, 0];\n\tconst hi = (h % 1) * 6;\n\tconst v = hi % 1;\n\tconst w = 1 - v;\n\tlet mg = 0;\n\n\t/* eslint-disable max-statements-per-line */\n\tswitch (Math.floor(hi)) {\n\t\tcase 0:\n\t\t\tpure[0] = 1; pure[1] = v; pure[2] = 0; break;\n\t\tcase 1:\n\t\t\tpure[0] = w; pure[1] = 1; pure[2] = 0; break;\n\t\tcase 2:\n\t\t\tpure[0] = 0; pure[1] = 1; pure[2] = v; break;\n\t\tcase 3:\n\t\t\tpure[0] = 0; pure[1] = w; pure[2] = 1; break;\n\t\tcase 4:\n\t\t\tpure[0] = v; pure[1] = 0; pure[2] = 1; break;\n\t\tdefault:\n\t\t\tpure[0] = 1; pure[1] = 0; pure[2] = w;\n\t}\n\t/* eslint-enable max-statements-per-line */\n\n\tmg = (1.0 - c) * g;\n\n\treturn [\n\t\t(c * pure[0] + mg) * 255,\n\t\t(c * pure[1] + mg) * 255,\n\t\t(c * pure[2] + mg) * 255\n\t];\n};\n\nconvert.hcg.hsv = function (hcg) {\n\tconst c = hcg[1] / 100;\n\tconst g = hcg[2] / 100;\n\n\tconst v = c + g * (1.0 - c);\n\tlet f = 0;\n\n\tif (v > 0.0) {\n\t\tf = c / v;\n\t}\n\n\treturn [hcg[0], f * 100, v * 100];\n};\n\nconvert.hcg.hsl = function (hcg) {\n\tconst c = hcg[1] / 100;\n\tconst g = hcg[2] / 100;\n\n\tconst l = g * (1.0 - c) + 0.5 * c;\n\tlet s = 0;\n\n\tif (l > 0.0 && l < 0.5) {\n\t\ts = c / (2 * l);\n\t} else\n\tif (l >= 0.5 && l < 1.0) {\n\t\ts = c / (2 * (1 - l));\n\t}\n\n\treturn [hcg[0], s * 100, l * 100];\n};\n\nconvert.hcg.hwb = function (hcg) {\n\tconst c = hcg[1] / 100;\n\tconst g = hcg[2] / 100;\n\tconst v = c + g * (1.0 - c);\n\treturn [hcg[0], (v - c) * 100, (1 - v) * 100];\n};\n\nconvert.hwb.hcg = function (hwb) {\n\tconst w = hwb[1] / 100;\n\tconst b = hwb[2] / 100;\n\tconst v = 1 - b;\n\tconst c = v - w;\n\tlet g = 0;\n\n\tif (c < 1) {\n\t\tg = (v - c) / (1 - c);\n\t}\n\n\treturn [hwb[0], c * 100, g * 100];\n};\n\nconvert.apple.rgb = function (apple) {\n\treturn [(apple[0] / 65535) * 255, (apple[1] / 65535) * 255, (apple[2] / 65535) * 255];\n};\n\nconvert.rgb.apple = function (rgb) {\n\treturn [(rgb[0] / 255) * 65535, (rgb[1] / 255) * 65535, (rgb[2] / 255) * 65535];\n};\n\nconvert.gray.rgb = function (args) {\n\treturn [args[0] / 100 * 255, args[0] / 100 * 255, args[0] / 100 * 255];\n};\n\nconvert.gray.hsl = function (args) {\n\treturn [0, 0, args[0]];\n};\n\nconvert.gray.hsv = convert.gray.hsl;\n\nconvert.gray.hwb = function (gray) {\n\treturn [0, 100, gray[0]];\n};\n\nconvert.gray.cmyk = function (gray) {\n\treturn [0, 0, 0, gray[0]];\n};\n\nconvert.gray.lab = function (gray) {\n\treturn [gray[0], 0, 0];\n};\n\nconvert.gray.hex = function (gray) {\n\tconst val = Math.round(gray[0] / 100 * 255) & 0xFF;\n\tconst integer = (val << 16) + (val << 8) + val;\n\n\tconst string = integer.toString(16).toUpperCase();\n\treturn '000000'.substring(string.length) + string;\n};\n\nconvert.rgb.gray = function (rgb) {\n\tconst val = (rgb[0] + rgb[1] + rgb[2]) / 3;\n\treturn [val / 255 * 100];\n};\n","const conversions = require('./conversions');\n\n/*\n\tThis function routes a model to all other models.\n\n\tall functions that are routed have a property `.conversion` attached\n\tto the returned synthetic function. This property is an array\n\tof strings, each with the steps in between the 'from' and 'to'\n\tcolor models (inclusive).\n\n\tconversions that are not possible simply are not included.\n*/\n\nfunction buildGraph() {\n\tconst graph = {};\n\t// https://jsperf.com/object-keys-vs-for-in-with-closure/3\n\tconst models = Object.keys(conversions);\n\n\tfor (let len = models.length, i = 0; i < len; i++) {\n\t\tgraph[models[i]] = {\n\t\t\t// http://jsperf.com/1-vs-infinity\n\t\t\t// micro-opt, but this is simple.\n\t\t\tdistance: -1,\n\t\t\tparent: null\n\t\t};\n\t}\n\n\treturn graph;\n}\n\n// https://en.wikipedia.org/wiki/Breadth-first_search\nfunction deriveBFS(fromModel) {\n\tconst graph = buildGraph();\n\tconst queue = [fromModel]; // Unshift -> queue -> pop\n\n\tgraph[fromModel].distance = 0;\n\n\twhile (queue.length) {\n\t\tconst current = queue.pop();\n\t\tconst adjacents = Object.keys(conversions[current]);\n\n\t\tfor (let len = adjacents.length, i = 0; i < len; i++) {\n\t\t\tconst adjacent = adjacents[i];\n\t\t\tconst node = graph[adjacent];\n\n\t\t\tif (node.distance === -1) {\n\t\t\t\tnode.distance = graph[current].distance + 1;\n\t\t\t\tnode.parent = current;\n\t\t\t\tqueue.unshift(adjacent);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn graph;\n}\n\nfunction link(from, to) {\n\treturn function (args) {\n\t\treturn to(from(args));\n\t};\n}\n\nfunction wrapConversion(toModel, graph) {\n\tconst path = [graph[toModel].parent, toModel];\n\tlet fn = conversions[graph[toModel].parent][toModel];\n\n\tlet cur = graph[toModel].parent;\n\twhile (graph[cur].parent) {\n\t\tpath.unshift(graph[cur].parent);\n\t\tfn = link(conversions[graph[cur].parent][cur], fn);\n\t\tcur = graph[cur].parent;\n\t}\n\n\tfn.conversion = path;\n\treturn fn;\n}\n\nmodule.exports = function (fromModel) {\n\tconst graph = deriveBFS(fromModel);\n\tconst conversion = {};\n\n\tconst models = Object.keys(graph);\n\tfor (let len = models.length, i = 0; i < len; i++) {\n\t\tconst toModel = models[i];\n\t\tconst node = graph[toModel];\n\n\t\tif (node.parent === null) {\n\t\t\t// No possible conversion, or this node is the source model.\n\t\t\tcontinue;\n\t\t}\n\n\t\tconversion[toModel] = wrapConversion(toModel, graph);\n\t}\n\n\treturn conversion;\n};\n\n","const conversions = require('./conversions');\nconst route = require('./route');\n\nconst convert = {};\n\nconst models = Object.keys(conversions);\n\nfunction wrapRaw(fn) {\n\tconst wrappedFn = function (...args) {\n\t\tconst arg0 = args[0];\n\t\tif (arg0 === undefined || arg0 === null) {\n\t\t\treturn arg0;\n\t\t}\n\n\t\tif (arg0.length > 1) {\n\t\t\targs = arg0;\n\t\t}\n\n\t\treturn fn(args);\n\t};\n\n\t// Preserve .conversion property if there is one\n\tif ('conversion' in fn) {\n\t\twrappedFn.conversion = fn.conversion;\n\t}\n\n\treturn wrappedFn;\n}\n\nfunction wrapRounded(fn) {\n\tconst wrappedFn = function (...args) {\n\t\tconst arg0 = args[0];\n\n\t\tif (arg0 === undefined || arg0 === null) {\n\t\t\treturn arg0;\n\t\t}\n\n\t\tif (arg0.length > 1) {\n\t\t\targs = arg0;\n\t\t}\n\n\t\tconst result = fn(args);\n\n\t\t// We're assuming the result is an array here.\n\t\t// see notice in conversions.js; don't use box types\n\t\t// in conversion functions.\n\t\tif (typeof result === 'object') {\n\t\t\tfor (let len = result.length, i = 0; i < len; i++) {\n\t\t\t\tresult[i] = Math.round(result[i]);\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t};\n\n\t// Preserve .conversion property if there is one\n\tif ('conversion' in fn) {\n\t\twrappedFn.conversion = fn.conversion;\n\t}\n\n\treturn wrappedFn;\n}\n\nmodels.forEach(fromModel => {\n\tconvert[fromModel] = {};\n\n\tObject.defineProperty(convert[fromModel], 'channels', {value: conversions[fromModel].channels});\n\tObject.defineProperty(convert[fromModel], 'labels', {value: conversions[fromModel].labels});\n\n\tconst routes = route(fromModel);\n\tconst routeModels = Object.keys(routes);\n\n\trouteModels.forEach(toModel => {\n\t\tconst fn = routes[toModel];\n\n\t\tconvert[fromModel][toModel] = wrapRounded(fn);\n\t\tconvert[fromModel][toModel].raw = wrapRaw(fn);\n\t});\n});\n\nmodule.exports = convert;\n","'use strict';\n\nconst wrapAnsi16 = (fn, offset) => (...args) => {\n\tconst code = fn(...args);\n\treturn `\\u001B[${code + offset}m`;\n};\n\nconst wrapAnsi256 = (fn, offset) => (...args) => {\n\tconst code = fn(...args);\n\treturn `\\u001B[${38 + offset};5;${code}m`;\n};\n\nconst wrapAnsi16m = (fn, offset) => (...args) => {\n\tconst rgb = fn(...args);\n\treturn `\\u001B[${38 + offset};2;${rgb[0]};${rgb[1]};${rgb[2]}m`;\n};\n\nconst ansi2ansi = n => n;\nconst rgb2rgb = (r, g, b) => [r, g, b];\n\nconst setLazyProperty = (object, property, get) => {\n\tObject.defineProperty(object, property, {\n\t\tget: () => {\n\t\t\tconst value = get();\n\n\t\t\tObject.defineProperty(object, property, {\n\t\t\t\tvalue,\n\t\t\t\tenumerable: true,\n\t\t\t\tconfigurable: true\n\t\t\t});\n\n\t\t\treturn value;\n\t\t},\n\t\tenumerable: true,\n\t\tconfigurable: true\n\t});\n};\n\n/** @type {typeof import('color-convert')} */\nlet colorConvert;\nconst makeDynamicStyles = (wrap, targetSpace, identity, isBackground) => {\n\tif (colorConvert === undefined) {\n\t\tcolorConvert = require('color-convert');\n\t}\n\n\tconst offset = isBackground ? 10 : 0;\n\tconst styles = {};\n\n\tfor (const [sourceSpace, suite] of Object.entries(colorConvert)) {\n\t\tconst name = sourceSpace === 'ansi16' ? 'ansi' : sourceSpace;\n\t\tif (sourceSpace === targetSpace) {\n\t\t\tstyles[name] = wrap(identity, offset);\n\t\t} else if (typeof suite === 'object') {\n\t\t\tstyles[name] = wrap(suite[targetSpace], offset);\n\t\t}\n\t}\n\n\treturn styles;\n};\n\nfunction assembleStyles() {\n\tconst codes = new Map();\n\tconst styles = {\n\t\tmodifier: {\n\t\t\treset: [0, 0],\n\t\t\t// 21 isn't widely supported and 22 does the same thing\n\t\t\tbold: [1, 22],\n\t\t\tdim: [2, 22],\n\t\t\titalic: [3, 23],\n\t\t\tunderline: [4, 24],\n\t\t\tinverse: [7, 27],\n\t\t\thidden: [8, 28],\n\t\t\tstrikethrough: [9, 29]\n\t\t},\n\t\tcolor: {\n\t\t\tblack: [30, 39],\n\t\t\tred: [31, 39],\n\t\t\tgreen: [32, 39],\n\t\t\tyellow: [33, 39],\n\t\t\tblue: [34, 39],\n\t\t\tmagenta: [35, 39],\n\t\t\tcyan: [36, 39],\n\t\t\twhite: [37, 39],\n\n\t\t\t// Bright color\n\t\t\tblackBright: [90, 39],\n\t\t\tredBright: [91, 39],\n\t\t\tgreenBright: [92, 39],\n\t\t\tyellowBright: [93, 39],\n\t\t\tblueBright: [94, 39],\n\t\t\tmagentaBright: [95, 39],\n\t\t\tcyanBright: [96, 39],\n\t\t\twhiteBright: [97, 39]\n\t\t},\n\t\tbgColor: {\n\t\t\tbgBlack: [40, 49],\n\t\t\tbgRed: [41, 49],\n\t\t\tbgGreen: [42, 49],\n\t\t\tbgYellow: [43, 49],\n\t\t\tbgBlue: [44, 49],\n\t\t\tbgMagenta: [45, 49],\n\t\t\tbgCyan: [46, 49],\n\t\t\tbgWhite: [47, 49],\n\n\t\t\t// Bright color\n\t\t\tbgBlackBright: [100, 49],\n\t\t\tbgRedBright: [101, 49],\n\t\t\tbgGreenBright: [102, 49],\n\t\t\tbgYellowBright: [103, 49],\n\t\t\tbgBlueBright: [104, 49],\n\t\t\tbgMagentaBright: [105, 49],\n\t\t\tbgCyanBright: [106, 49],\n\t\t\tbgWhiteBright: [107, 49]\n\t\t}\n\t};\n\n\t// Alias bright black as gray (and grey)\n\tstyles.color.gray = styles.color.blackBright;\n\tstyles.bgColor.bgGray = styles.bgColor.bgBlackBright;\n\tstyles.color.grey = styles.color.blackBright;\n\tstyles.bgColor.bgGrey = styles.bgColor.bgBlackBright;\n\n\tfor (const [groupName, group] of Object.entries(styles)) {\n\t\tfor (const [styleName, style] of Object.entries(group)) {\n\t\t\tstyles[styleName] = {\n\t\t\t\topen: `\\u001B[${style[0]}m`,\n\t\t\t\tclose: `\\u001B[${style[1]}m`\n\t\t\t};\n\n\t\t\tgroup[styleName] = styles[styleName];\n\n\t\t\tcodes.set(style[0], style[1]);\n\t\t}\n\n\t\tObject.defineProperty(styles, groupName, {\n\t\t\tvalue: group,\n\t\t\tenumerable: false\n\t\t});\n\t}\n\n\tObject.defineProperty(styles, 'codes', {\n\t\tvalue: codes,\n\t\tenumerable: false\n\t});\n\n\tstyles.color.close = '\\u001B[39m';\n\tstyles.bgColor.close = '\\u001B[49m';\n\n\tsetLazyProperty(styles.color, 'ansi', () => makeDynamicStyles(wrapAnsi16, 'ansi16', ansi2ansi, false));\n\tsetLazyProperty(styles.color, 'ansi256', () => makeDynamicStyles(wrapAnsi256, 'ansi256', ansi2ansi, false));\n\tsetLazyProperty(styles.color, 'ansi16m', () => makeDynamicStyles(wrapAnsi16m, 'rgb', rgb2rgb, false));\n\tsetLazyProperty(styles.bgColor, 'ansi', () => makeDynamicStyles(wrapAnsi16, 'ansi16', ansi2ansi, true));\n\tsetLazyProperty(styles.bgColor, 'ansi256', () => makeDynamicStyles(wrapAnsi256, 'ansi256', ansi2ansi, true));\n\tsetLazyProperty(styles.bgColor, 'ansi16m', () => makeDynamicStyles(wrapAnsi16m, 'rgb', rgb2rgb, true));\n\n\treturn styles;\n}\n\n// Make the export immutable\nObject.defineProperty(module, 'exports', {\n\tenumerable: true,\n\tget: assembleStyles\n});\n","'use strict';\n\nconst stringReplaceAll = (string, substring, replacer) => {\n\tlet index = string.indexOf(substring);\n\tif (index === -1) {\n\t\treturn string;\n\t}\n\n\tconst substringLength = substring.length;\n\tlet endIndex = 0;\n\tlet returnValue = '';\n\tdo {\n\t\treturnValue += string.substr(endIndex, index - endIndex) + substring + replacer;\n\t\tendIndex = index + substringLength;\n\t\tindex = string.indexOf(substring, endIndex);\n\t} while (index !== -1);\n\n\treturnValue += string.substr(endIndex);\n\treturn returnValue;\n};\n\nconst stringEncaseCRLFWithFirstIndex = (string, prefix, postfix, index) => {\n\tlet endIndex = 0;\n\tlet returnValue = '';\n\tdo {\n\t\tconst gotCR = string[index - 1] === '\\r';\n\t\treturnValue += string.substr(endIndex, (gotCR ? index - 1 : index) - endIndex) + prefix + (gotCR ? '\\r\\n' : '\\n') + postfix;\n\t\tendIndex = index + 1;\n\t\tindex = string.indexOf('\\n', endIndex);\n\t} while (index !== -1);\n\n\treturnValue += string.substr(endIndex);\n\treturn returnValue;\n};\n\nmodule.exports = {\n\tstringReplaceAll,\n\tstringEncaseCRLFWithFirstIndex\n};\n","'use strict';\nconst ansiStyles = require('ansi-styles');\nconst {stdout: stdoutColor, stderr: stderrColor} = require('supports-color');\nconst {\n\tstringReplaceAll,\n\tstringEncaseCRLFWithFirstIndex\n} = require('./util');\n\nconst {isArray} = Array;\n\n// `supportsColor.level` â†’ `ansiStyles.color[name]` mapping\nconst levelMapping = [\n\t'ansi',\n\t'ansi',\n\t'ansi256',\n\t'ansi16m'\n];\n\nconst styles = Object.create(null);\n\nconst applyOptions = (object, options = {}) => {\n\tif (options.level && !(Number.isInteger(options.level) && options.level >= 0 && options.level <= 3)) {\n\t\tthrow new Error('The `level` option should be an integer from 0 to 3');\n\t}\n\n\t// Detect level if not set manually\n\tconst colorLevel = stdoutColor ? stdoutColor.level : 0;\n\tobject.level = options.level === undefined ? colorLevel : options.level;\n};\n\nclass ChalkClass {\n\tconstructor(options) {\n\t\t// eslint-disable-next-line no-constructor-return\n\t\treturn chalkFactory(options);\n\t}\n}\n\nconst chalkFactory = options => {\n\tconst chalk = {};\n\tapplyOptions(chalk, options);\n\n\tchalk.template = (...arguments_) => chalkTag(chalk.template, ...arguments_);\n\n\tObject.setPrototypeOf(chalk, Chalk.prototype);\n\tObject.setPrototypeOf(chalk.template, chalk);\n\n\tchalk.template.constructor = () => {\n\t\tthrow new Error('`chalk.constructor()` is deprecated. Use `new chalk.Instance()` instead.');\n\t};\n\n\tchalk.template.Instance = ChalkClass;\n\n\treturn chalk.template;\n};\n\nfunction Chalk(options) {\n\treturn chalkFactory(options);\n}\n\nfor (const [styleName, style] of Object.entries(ansiStyles)) {\n\tstyles[styleName] = {\n\t\tget() {\n\t\t\tconst builder = createBuilder(this, createStyler(style.open, style.close, this._styler), this._isEmpty);\n\t\t\tObject.defineProperty(this, styleName, {value: builder});\n\t\t\treturn builder;\n\t\t}\n\t};\n}\n\nstyles.visible = {\n\tget() {\n\t\tconst builder = createBuilder(this, this._styler, true);\n\t\tObject.defineProperty(this, 'visible', {value: builder});\n\t\treturn builder;\n\t}\n};\n\nconst usedModels = ['rgb', 'hex', 'keyword', 'hsl', 'hsv', 'hwb', 'ansi', 'ansi256'];\n\nfor (const model of usedModels) {\n\tstyles[model] = {\n\t\tget() {\n\t\t\tconst {level} = this;\n\t\t\treturn function (...arguments_) {\n\t\t\t\tconst styler = createStyler(ansiStyles.color[levelMapping[level]][model](...arguments_), ansiStyles.color.close, this._styler);\n\t\t\t\treturn createBuilder(this, styler, this._isEmpty);\n\t\t\t};\n\t\t}\n\t};\n}\n\nfor (const model of usedModels) {\n\tconst bgModel = 'bg' + model[0].toUpperCase() + model.slice(1);\n\tstyles[bgModel] = {\n\t\tget() {\n\t\t\tconst {level} = this;\n\t\t\treturn function (...arguments_) {\n\t\t\t\tconst styler = createStyler(ansiStyles.bgColor[levelMapping[level]][model](...arguments_), ansiStyles.bgColor.close, this._styler);\n\t\t\t\treturn createBuilder(this, styler, this._isEmpty);\n\t\t\t};\n\t\t}\n\t};\n}\n\nconst proto = Object.defineProperties(() => {}, {\n\t...styles,\n\tlevel: {\n\t\tenumerable: true,\n\t\tget() {\n\t\t\treturn this._generator.level;\n\t\t},\n\t\tset(level) {\n\t\t\tthis._generator.level = level;\n\t\t}\n\t}\n});\n\nconst createStyler = (open, close, parent) => {\n\tlet openAll;\n\tlet closeAll;\n\tif (parent === undefined) {\n\t\topenAll = open;\n\t\tcloseAll = close;\n\t} else {\n\t\topenAll = parent.openAll + open;\n\t\tcloseAll = close + parent.closeAll;\n\t}\n\n\treturn {\n\t\topen,\n\t\tclose,\n\t\topenAll,\n\t\tcloseAll,\n\t\tparent\n\t};\n};\n\nconst createBuilder = (self, _styler, _isEmpty) => {\n\tconst builder = (...arguments_) => {\n\t\tif (isArray(arguments_[0]) && isArray(arguments_[0].raw)) {\n\t\t\t// Called as a template literal, for example: chalk.red`2 + 3 = {bold ${2+3}}`\n\t\t\treturn applyStyle(builder, chalkTag(builder, ...arguments_));\n\t\t}\n\n\t\t// Single argument is hot path, implicit coercion is faster than anything\n\t\t// eslint-disable-next-line no-implicit-coercion\n\t\treturn applyStyle(builder, (arguments_.length === 1) ? ('' + arguments_[0]) : arguments_.join(' '));\n\t};\n\n\t// We alter the prototype because we must return a function, but there is\n\t// no way to create a function with a different prototype\n\tObject.setPrototypeOf(builder, proto);\n\n\tbuilder._generator = self;\n\tbuilder._styler = _styler;\n\tbuilder._isEmpty = _isEmpty;\n\n\treturn builder;\n};\n\nconst applyStyle = (self, string) => {\n\tif (self.level <= 0 || !string) {\n\t\treturn self._isEmpty ? '' : string;\n\t}\n\n\tlet styler = self._styler;\n\n\tif (styler === undefined) {\n\t\treturn string;\n\t}\n\n\tconst {openAll, closeAll} = styler;\n\tif (string.indexOf('\\u001B') !== -1) {\n\t\twhile (styler !== undefined) {\n\t\t\t// Replace any instances already present with a re-opening code\n\t\t\t// otherwise only the part of the string until said closing code\n\t\t\t// will be colored, and the rest will simply be 'plain'.\n\t\t\tstring = stringReplaceAll(string, styler.close, styler.open);\n\n\t\t\tstyler = styler.parent;\n\t\t}\n\t}\n\n\t// We can move both next actions out of loop, because remaining actions in loop won't have\n\t// any/visible effect on parts we add here. Close the styling before a linebreak and reopen\n\t// after next line to fix a bleed issue on macOS: https://github.com/chalk/chalk/pull/92\n\tconst lfIndex = string.indexOf('\\n');\n\tif (lfIndex !== -1) {\n\t\tstring = stringEncaseCRLFWithFirstIndex(string, closeAll, openAll, lfIndex);\n\t}\n\n\treturn openAll + string + closeAll;\n};\n\nlet template;\nconst chalkTag = (chalk, ...strings) => {\n\tconst [firstString] = strings;\n\n\tif (!isArray(firstString) || !isArray(firstString.raw)) {\n\t\t// If chalk() was called by itself or with a string,\n\t\t// return the string itself as a string.\n\t\treturn strings.join(' ');\n\t}\n\n\tconst arguments_ = strings.slice(1);\n\tconst parts = [firstString.raw[0]];\n\n\tfor (let i = 1; i < firstString.length; i++) {\n\t\tparts.push(\n\t\t\tString(arguments_[i - 1]).replace(/[{}\\\\]/g, '\\\\$&'),\n\t\t\tString(firstString.raw[i])\n\t\t);\n\t}\n\n\tif (template === undefined) {\n\t\ttemplate = require('./templates');\n\t}\n\n\treturn template(chalk, parts.join(''));\n};\n\nObject.defineProperties(Chalk.prototype, styles);\n\nconst chalk = Chalk(); // eslint-disable-line new-cap\nchalk.supportsColor = stdoutColor;\nchalk.stderr = Chalk({level: stderrColor ? stderrColor.level : 0}); // eslint-disable-line new-cap\nchalk.stderr.supportsColor = stderrColor;\n\nmodule.exports = chalk;\n","module.exports = assert;\n\nfunction assert(val, msg) {\n  if (!val)\n    throw new Error(msg || 'Assertion failed');\n}\n\nassert.equal = function assertEqual(l, r, msg) {\n  if (l != r)\n    throw new Error(msg || ('Assertion failed: ' + l + ' != ' + r));\n};\n","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    if (superCtor) {\n      ctor.super_ = superCtor\n      ctor.prototype = Object.create(superCtor.prototype, {\n        constructor: {\n          value: ctor,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      })\n    }\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    if (superCtor) {\n      ctor.super_ = superCtor\n      var TempCtor = function () {}\n      TempCtor.prototype = superCtor.prototype\n      ctor.prototype = new TempCtor()\n      ctor.prototype.constructor = ctor\n    }\n  }\n}\n","try {\n  var util = require('util');\n  /* istanbul ignore next */\n  if (typeof util.inherits !== 'function') throw '';\n  module.exports = util.inherits;\n} catch (e) {\n  /* istanbul ignore next */\n  module.exports = require('./inherits_browser.js');\n}\n","'use strict';\n\nvar assert = require('minimalistic-assert');\nvar inherits = require('inherits');\n\nexports.inherits = inherits;\n\nfunction isSurrogatePair(msg, i) {\n  if ((msg.charCodeAt(i) & 0xFC00) !== 0xD800) {\n    return false;\n  }\n  if (i < 0 || i + 1 >= msg.length) {\n    return false;\n  }\n  return (msg.charCodeAt(i + 1) & 0xFC00) === 0xDC00;\n}\n\nfunction toArray(msg, enc) {\n  if (Array.isArray(msg))\n    return msg.slice();\n  if (!msg)\n    return [];\n  var res = [];\n  if (typeof msg === 'string') {\n    if (!enc) {\n      // Inspired by stringToUtf8ByteArray() in closure-library by Google\n      // https://github.com/google/closure-library/blob/8598d87242af59aac233270742c8984e2b2bdbe0/closure/goog/crypt/crypt.js#L117-L143\n      // Apache License 2.0\n      // https://github.com/google/closure-library/blob/master/LICENSE\n      var p = 0;\n      for (var i = 0; i < msg.length; i++) {\n        var c = msg.charCodeAt(i);\n        if (c < 128) {\n          res[p++] = c;\n        } else if (c < 2048) {\n          res[p++] = (c >> 6) | 192;\n          res[p++] = (c & 63) | 128;\n        } else if (isSurrogatePair(msg, i)) {\n          c = 0x10000 + ((c & 0x03FF) << 10) + (msg.charCodeAt(++i) & 0x03FF);\n          res[p++] = (c >> 18) | 240;\n          res[p++] = ((c >> 12) & 63) | 128;\n          res[p++] = ((c >> 6) & 63) | 128;\n          res[p++] = (c & 63) | 128;\n        } else {\n          res[p++] = (c >> 12) | 224;\n          res[p++] = ((c >> 6) & 63) | 128;\n          res[p++] = (c & 63) | 128;\n        }\n      }\n    } else if (enc === 'hex') {\n      msg = msg.replace(/[^a-z0-9]+/ig, '');\n      if (msg.length % 2 !== 0)\n        msg = '0' + msg;\n      for (i = 0; i < msg.length; i += 2)\n        res.push(parseInt(msg[i] + msg[i + 1], 16));\n    }\n  } else {\n    for (i = 0; i < msg.length; i++)\n      res[i] = msg[i] | 0;\n  }\n  return res;\n}\nexports.toArray = toArray;\n\nfunction toHex(msg) {\n  var res = '';\n  for (var i = 0; i < msg.length; i++)\n    res += zero2(msg[i].toString(16));\n  return res;\n}\nexports.toHex = toHex;\n\nfunction htonl(w) {\n  var res = (w >>> 24) |\n            ((w >>> 8) & 0xff00) |\n            ((w << 8) & 0xff0000) |\n            ((w & 0xff) << 24);\n  return res >>> 0;\n}\nexports.htonl = htonl;\n\nfunction toHex32(msg, endian) {\n  var res = '';\n  for (var i = 0; i < msg.length; i++) {\n    var w = msg[i];\n    if (endian === 'little')\n      w = htonl(w);\n    res += zero8(w.toString(16));\n  }\n  return res;\n}\nexports.toHex32 = toHex32;\n\nfunction zero2(word) {\n  if (word.length === 1)\n    return '0' + word;\n  else\n    return word;\n}\nexports.zero2 = zero2;\n\nfunction zero8(word) {\n  if (word.length === 7)\n    return '0' + word;\n  else if (word.length === 6)\n    return '00' + word;\n  else if (word.length === 5)\n    return '000' + word;\n  else if (word.length === 4)\n    return '0000' + word;\n  else if (word.length === 3)\n    return '00000' + word;\n  else if (word.length === 2)\n    return '000000' + word;\n  else if (word.length === 1)\n    return '0000000' + word;\n  else\n    return word;\n}\nexports.zero8 = zero8;\n\nfunction join32(msg, start, end, endian) {\n  var len = end - start;\n  assert(len % 4 === 0);\n  var res = new Array(len / 4);\n  for (var i = 0, k = start; i < res.length; i++, k += 4) {\n    var w;\n    if (endian === 'big')\n      w = (msg[k] << 24) | (msg[k + 1] << 16) | (msg[k + 2] << 8) | msg[k + 3];\n    else\n      w = (msg[k + 3] << 24) | (msg[k + 2] << 16) | (msg[k + 1] << 8) | msg[k];\n    res[i] = w >>> 0;\n  }\n  return res;\n}\nexports.join32 = join32;\n\nfunction split32(msg, endian) {\n  var res = new Array(msg.length * 4);\n  for (var i = 0, k = 0; i < msg.length; i++, k += 4) {\n    var m = msg[i];\n    if (endian === 'big') {\n      res[k] = m >>> 24;\n      res[k + 1] = (m >>> 16) & 0xff;\n      res[k + 2] = (m >>> 8) & 0xff;\n      res[k + 3] = m & 0xff;\n    } else {\n      res[k + 3] = m >>> 24;\n      res[k + 2] = (m >>> 16) & 0xff;\n      res[k + 1] = (m >>> 8) & 0xff;\n      res[k] = m & 0xff;\n    }\n  }\n  return res;\n}\nexports.split32 = split32;\n\nfunction rotr32(w, b) {\n  return (w >>> b) | (w << (32 - b));\n}\nexports.rotr32 = rotr32;\n\nfunction rotl32(w, b) {\n  return (w << b) | (w >>> (32 - b));\n}\nexports.rotl32 = rotl32;\n\nfunction sum32(a, b) {\n  return (a + b) >>> 0;\n}\nexports.sum32 = sum32;\n\nfunction sum32_3(a, b, c) {\n  return (a + b + c) >>> 0;\n}\nexports.sum32_3 = sum32_3;\n\nfunction sum32_4(a, b, c, d) {\n  return (a + b + c + d) >>> 0;\n}\nexports.sum32_4 = sum32_4;\n\nfunction sum32_5(a, b, c, d, e) {\n  return (a + b + c + d + e) >>> 0;\n}\nexports.sum32_5 = sum32_5;\n\nfunction sum64(buf, pos, ah, al) {\n  var bh = buf[pos];\n  var bl = buf[pos + 1];\n\n  var lo = (al + bl) >>> 0;\n  var hi = (lo < al ? 1 : 0) + ah + bh;\n  buf[pos] = hi >>> 0;\n  buf[pos + 1] = lo;\n}\nexports.sum64 = sum64;\n\nfunction sum64_hi(ah, al, bh, bl) {\n  var lo = (al + bl) >>> 0;\n  var hi = (lo < al ? 1 : 0) + ah + bh;\n  return hi >>> 0;\n}\nexports.sum64_hi = sum64_hi;\n\nfunction sum64_lo(ah, al, bh, bl) {\n  var lo = al + bl;\n  return lo >>> 0;\n}\nexports.sum64_lo = sum64_lo;\n\nfunction sum64_4_hi(ah, al, bh, bl, ch, cl, dh, dl) {\n  var carry = 0;\n  var lo = al;\n  lo = (lo + bl) >>> 0;\n  carry += lo < al ? 1 : 0;\n  lo = (lo + cl) >>> 0;\n  carry += lo < cl ? 1 : 0;\n  lo = (lo + dl) >>> 0;\n  carry += lo < dl ? 1 : 0;\n\n  var hi = ah + bh + ch + dh + carry;\n  return hi >>> 0;\n}\nexports.sum64_4_hi = sum64_4_hi;\n\nfunction sum64_4_lo(ah, al, bh, bl, ch, cl, dh, dl) {\n  var lo = al + bl + cl + dl;\n  return lo >>> 0;\n}\nexports.sum64_4_lo = sum64_4_lo;\n\nfunction sum64_5_hi(ah, al, bh, bl, ch, cl, dh, dl, eh, el) {\n  var carry = 0;\n  var lo = al;\n  lo = (lo + bl) >>> 0;\n  carry += lo < al ? 1 : 0;\n  lo = (lo + cl) >>> 0;\n  carry += lo < cl ? 1 : 0;\n  lo = (lo + dl) >>> 0;\n  carry += lo < dl ? 1 : 0;\n  lo = (lo + el) >>> 0;\n  carry += lo < el ? 1 : 0;\n\n  var hi = ah + bh + ch + dh + eh + carry;\n  return hi >>> 0;\n}\nexports.sum64_5_hi = sum64_5_hi;\n\nfunction sum64_5_lo(ah, al, bh, bl, ch, cl, dh, dl, eh, el) {\n  var lo = al + bl + cl + dl + el;\n\n  return lo >>> 0;\n}\nexports.sum64_5_lo = sum64_5_lo;\n\nfunction rotr64_hi(ah, al, num) {\n  var r = (al << (32 - num)) | (ah >>> num);\n  return r >>> 0;\n}\nexports.rotr64_hi = rotr64_hi;\n\nfunction rotr64_lo(ah, al, num) {\n  var r = (ah << (32 - num)) | (al >>> num);\n  return r >>> 0;\n}\nexports.rotr64_lo = rotr64_lo;\n\nfunction shr64_hi(ah, al, num) {\n  return ah >>> num;\n}\nexports.shr64_hi = shr64_hi;\n\nfunction shr64_lo(ah, al, num) {\n  var r = (ah << (32 - num)) | (al >>> num);\n  return r >>> 0;\n}\nexports.shr64_lo = shr64_lo;\n","'use strict';\n\nvar utils = require('./utils');\nvar assert = require('minimalistic-assert');\n\nfunction BlockHash() {\n  this.pending = null;\n  this.pendingTotal = 0;\n  this.blockSize = this.constructor.blockSize;\n  this.outSize = this.constructor.outSize;\n  this.hmacStrength = this.constructor.hmacStrength;\n  this.padLength = this.constructor.padLength / 8;\n  this.endian = 'big';\n\n  this._delta8 = this.blockSize / 8;\n  this._delta32 = this.blockSize / 32;\n}\nexports.BlockHash = BlockHash;\n\nBlockHash.prototype.update = function update(msg, enc) {\n  // Convert message to array, pad it, and join into 32bit blocks\n  msg = utils.toArray(msg, enc);\n  if (!this.pending)\n    this.pending = msg;\n  else\n    this.pending = this.pending.concat(msg);\n  this.pendingTotal += msg.length;\n\n  // Enough data, try updating\n  if (this.pending.length >= this._delta8) {\n    msg = this.pending;\n\n    // Process pending data in blocks\n    var r = msg.length % this._delta8;\n    this.pending = msg.slice(msg.length - r, msg.length);\n    if (this.pending.length === 0)\n      this.pending = null;\n\n    msg = utils.join32(msg, 0, msg.length - r, this.endian);\n    for (var i = 0; i < msg.length; i += this._delta32)\n      this._update(msg, i, i + this._delta32);\n  }\n\n  return this;\n};\n\nBlockHash.prototype.digest = function digest(enc) {\n  this.update(this._pad());\n  assert(this.pending === null);\n\n  return this._digest(enc);\n};\n\nBlockHash.prototype._pad = function pad() {\n  var len = this.pendingTotal;\n  var bytes = this._delta8;\n  var k = bytes - ((len + this.padLength) % bytes);\n  var res = new Array(k + this.padLength);\n  res[0] = 0x80;\n  for (var i = 1; i < k; i++)\n    res[i] = 0;\n\n  // Append length\n  len <<= 3;\n  if (this.endian === 'big') {\n    for (var t = 8; t < this.padLength; t++)\n      res[i++] = 0;\n\n    res[i++] = 0;\n    res[i++] = 0;\n    res[i++] = 0;\n    res[i++] = 0;\n    res[i++] = (len >>> 24) & 0xff;\n    res[i++] = (len >>> 16) & 0xff;\n    res[i++] = (len >>> 8) & 0xff;\n    res[i++] = len & 0xff;\n  } else {\n    res[i++] = len & 0xff;\n    res[i++] = (len >>> 8) & 0xff;\n    res[i++] = (len >>> 16) & 0xff;\n    res[i++] = (len >>> 24) & 0xff;\n    res[i++] = 0;\n    res[i++] = 0;\n    res[i++] = 0;\n    res[i++] = 0;\n\n    for (t = 8; t < this.padLength; t++)\n      res[i++] = 0;\n  }\n\n  return res;\n};\n","'use strict';\n\nvar utils = require('../utils');\nvar rotr32 = utils.rotr32;\n\nfunction ft_1(s, x, y, z) {\n  if (s === 0)\n    return ch32(x, y, z);\n  if (s === 1 || s === 3)\n    return p32(x, y, z);\n  if (s === 2)\n    return maj32(x, y, z);\n}\nexports.ft_1 = ft_1;\n\nfunction ch32(x, y, z) {\n  return (x & y) ^ ((~x) & z);\n}\nexports.ch32 = ch32;\n\nfunction maj32(x, y, z) {\n  return (x & y) ^ (x & z) ^ (y & z);\n}\nexports.maj32 = maj32;\n\nfunction p32(x, y, z) {\n  return x ^ y ^ z;\n}\nexports.p32 = p32;\n\nfunction s0_256(x) {\n  return rotr32(x, 2) ^ rotr32(x, 13) ^ rotr32(x, 22);\n}\nexports.s0_256 = s0_256;\n\nfunction s1_256(x) {\n  return rotr32(x, 6) ^ rotr32(x, 11) ^ rotr32(x, 25);\n}\nexports.s1_256 = s1_256;\n\nfunction g0_256(x) {\n  return rotr32(x, 7) ^ rotr32(x, 18) ^ (x >>> 3);\n}\nexports.g0_256 = g0_256;\n\nfunction g1_256(x) {\n  return rotr32(x, 17) ^ rotr32(x, 19) ^ (x >>> 10);\n}\nexports.g1_256 = g1_256;\n","'use strict';\n\nvar utils = require('../utils');\nvar common = require('../common');\nvar shaCommon = require('./common');\n\nvar rotl32 = utils.rotl32;\nvar sum32 = utils.sum32;\nvar sum32_5 = utils.sum32_5;\nvar ft_1 = shaCommon.ft_1;\nvar BlockHash = common.BlockHash;\n\nvar sha1_K = [\n  0x5A827999, 0x6ED9EBA1,\n  0x8F1BBCDC, 0xCA62C1D6\n];\n\nfunction SHA1() {\n  if (!(this instanceof SHA1))\n    return new SHA1();\n\n  BlockHash.call(this);\n  this.h = [\n    0x67452301, 0xefcdab89, 0x98badcfe,\n    0x10325476, 0xc3d2e1f0 ];\n  this.W = new Array(80);\n}\n\nutils.inherits(SHA1, BlockHash);\nmodule.exports = SHA1;\n\nSHA1.blockSize = 512;\nSHA1.outSize = 160;\nSHA1.hmacStrength = 80;\nSHA1.padLength = 64;\n\nSHA1.prototype._update = function _update(msg, start) {\n  var W = this.W;\n\n  for (var i = 0; i < 16; i++)\n    W[i] = msg[start + i];\n\n  for(; i < W.length; i++)\n    W[i] = rotl32(W[i - 3] ^ W[i - 8] ^ W[i - 14] ^ W[i - 16], 1);\n\n  var a = this.h[0];\n  var b = this.h[1];\n  var c = this.h[2];\n  var d = this.h[3];\n  var e = this.h[4];\n\n  for (i = 0; i < W.length; i++) {\n    var s = ~~(i / 20);\n    var t = sum32_5(rotl32(a, 5), ft_1(s, b, c, d), e, W[i], sha1_K[s]);\n    e = d;\n    d = c;\n    c = rotl32(b, 30);\n    b = a;\n    a = t;\n  }\n\n  this.h[0] = sum32(this.h[0], a);\n  this.h[1] = sum32(this.h[1], b);\n  this.h[2] = sum32(this.h[2], c);\n  this.h[3] = sum32(this.h[3], d);\n  this.h[4] = sum32(this.h[4], e);\n};\n\nSHA1.prototype._digest = function digest(enc) {\n  if (enc === 'hex')\n    return utils.toHex32(this.h, 'big');\n  else\n    return utils.split32(this.h, 'big');\n};\n","'use strict';\n\nvar utils = require('../utils');\nvar common = require('../common');\nvar shaCommon = require('./common');\nvar assert = require('minimalistic-assert');\n\nvar sum32 = utils.sum32;\nvar sum32_4 = utils.sum32_4;\nvar sum32_5 = utils.sum32_5;\nvar ch32 = shaCommon.ch32;\nvar maj32 = shaCommon.maj32;\nvar s0_256 = shaCommon.s0_256;\nvar s1_256 = shaCommon.s1_256;\nvar g0_256 = shaCommon.g0_256;\nvar g1_256 = shaCommon.g1_256;\n\nvar BlockHash = common.BlockHash;\n\nvar sha256_K = [\n  0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5,\n  0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n  0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3,\n  0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n  0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc,\n  0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n  0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7,\n  0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n  0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13,\n  0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n  0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3,\n  0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n  0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5,\n  0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n  0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208,\n  0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2\n];\n\nfunction SHA256() {\n  if (!(this instanceof SHA256))\n    return new SHA256();\n\n  BlockHash.call(this);\n  this.h = [\n    0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a,\n    0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19\n  ];\n  this.k = sha256_K;\n  this.W = new Array(64);\n}\nutils.inherits(SHA256, BlockHash);\nmodule.exports = SHA256;\n\nSHA256.blockSize = 512;\nSHA256.outSize = 256;\nSHA256.hmacStrength = 192;\nSHA256.padLength = 64;\n\nSHA256.prototype._update = function _update(msg, start) {\n  var W = this.W;\n\n  for (var i = 0; i < 16; i++)\n    W[i] = msg[start + i];\n  for (; i < W.length; i++)\n    W[i] = sum32_4(g1_256(W[i - 2]), W[i - 7], g0_256(W[i - 15]), W[i - 16]);\n\n  var a = this.h[0];\n  var b = this.h[1];\n  var c = this.h[2];\n  var d = this.h[3];\n  var e = this.h[4];\n  var f = this.h[5];\n  var g = this.h[6];\n  var h = this.h[7];\n\n  assert(this.k.length === W.length);\n  for (i = 0; i < W.length; i++) {\n    var T1 = sum32_5(h, s1_256(e), ch32(e, f, g), this.k[i], W[i]);\n    var T2 = sum32(s0_256(a), maj32(a, b, c));\n    h = g;\n    g = f;\n    f = e;\n    e = sum32(d, T1);\n    d = c;\n    c = b;\n    b = a;\n    a = sum32(T1, T2);\n  }\n\n  this.h[0] = sum32(this.h[0], a);\n  this.h[1] = sum32(this.h[1], b);\n  this.h[2] = sum32(this.h[2], c);\n  this.h[3] = sum32(this.h[3], d);\n  this.h[4] = sum32(this.h[4], e);\n  this.h[5] = sum32(this.h[5], f);\n  this.h[6] = sum32(this.h[6], g);\n  this.h[7] = sum32(this.h[7], h);\n};\n\nSHA256.prototype._digest = function digest(enc) {\n  if (enc === 'hex')\n    return utils.toHex32(this.h, 'big');\n  else\n    return utils.split32(this.h, 'big');\n};\n","'use strict';\n\nvar utils = require('../utils');\nvar SHA256 = require('./256');\n\nfunction SHA224() {\n  if (!(this instanceof SHA224))\n    return new SHA224();\n\n  SHA256.call(this);\n  this.h = [\n    0xc1059ed8, 0x367cd507, 0x3070dd17, 0xf70e5939,\n    0xffc00b31, 0x68581511, 0x64f98fa7, 0xbefa4fa4 ];\n}\nutils.inherits(SHA224, SHA256);\nmodule.exports = SHA224;\n\nSHA224.blockSize = 512;\nSHA224.outSize = 224;\nSHA224.hmacStrength = 192;\nSHA224.padLength = 64;\n\nSHA224.prototype._digest = function digest(enc) {\n  // Just truncate output\n  if (enc === 'hex')\n    return utils.toHex32(this.h.slice(0, 7), 'big');\n  else\n    return utils.split32(this.h.slice(0, 7), 'big');\n};\n\n","'use strict';\n\nvar utils = require('../utils');\nvar common = require('../common');\nvar assert = require('minimalistic-assert');\n\nvar rotr64_hi = utils.rotr64_hi;\nvar rotr64_lo = utils.rotr64_lo;\nvar shr64_hi = utils.shr64_hi;\nvar shr64_lo = utils.shr64_lo;\nvar sum64 = utils.sum64;\nvar sum64_hi = utils.sum64_hi;\nvar sum64_lo = utils.sum64_lo;\nvar sum64_4_hi = utils.sum64_4_hi;\nvar sum64_4_lo = utils.sum64_4_lo;\nvar sum64_5_hi = utils.sum64_5_hi;\nvar sum64_5_lo = utils.sum64_5_lo;\n\nvar BlockHash = common.BlockHash;\n\nvar sha512_K = [\n  0x428a2f98, 0xd728ae22, 0x71374491, 0x23ef65cd,\n  0xb5c0fbcf, 0xec4d3b2f, 0xe9b5dba5, 0x8189dbbc,\n  0x3956c25b, 0xf348b538, 0x59f111f1, 0xb605d019,\n  0x923f82a4, 0xaf194f9b, 0xab1c5ed5, 0xda6d8118,\n  0xd807aa98, 0xa3030242, 0x12835b01, 0x45706fbe,\n  0x243185be, 0x4ee4b28c, 0x550c7dc3, 0xd5ffb4e2,\n  0x72be5d74, 0xf27b896f, 0x80deb1fe, 0x3b1696b1,\n  0x9bdc06a7, 0x25c71235, 0xc19bf174, 0xcf692694,\n  0xe49b69c1, 0x9ef14ad2, 0xefbe4786, 0x384f25e3,\n  0x0fc19dc6, 0x8b8cd5b5, 0x240ca1cc, 0x77ac9c65,\n  0x2de92c6f, 0x592b0275, 0x4a7484aa, 0x6ea6e483,\n  0x5cb0a9dc, 0xbd41fbd4, 0x76f988da, 0x831153b5,\n  0x983e5152, 0xee66dfab, 0xa831c66d, 0x2db43210,\n  0xb00327c8, 0x98fb213f, 0xbf597fc7, 0xbeef0ee4,\n  0xc6e00bf3, 0x3da88fc2, 0xd5a79147, 0x930aa725,\n  0x06ca6351, 0xe003826f, 0x14292967, 0x0a0e6e70,\n  0x27b70a85, 0x46d22ffc, 0x2e1b2138, 0x5c26c926,\n  0x4d2c6dfc, 0x5ac42aed, 0x53380d13, 0x9d95b3df,\n  0x650a7354, 0x8baf63de, 0x766a0abb, 0x3c77b2a8,\n  0x81c2c92e, 0x47edaee6, 0x92722c85, 0x1482353b,\n  0xa2bfe8a1, 0x4cf10364, 0xa81a664b, 0xbc423001,\n  0xc24b8b70, 0xd0f89791, 0xc76c51a3, 0x0654be30,\n  0xd192e819, 0xd6ef5218, 0xd6990624, 0x5565a910,\n  0xf40e3585, 0x5771202a, 0x106aa070, 0x32bbd1b8,\n  0x19a4c116, 0xb8d2d0c8, 0x1e376c08, 0x5141ab53,\n  0x2748774c, 0xdf8eeb99, 0x34b0bcb5, 0xe19b48a8,\n  0x391c0cb3, 0xc5c95a63, 0x4ed8aa4a, 0xe3418acb,\n  0x5b9cca4f, 0x7763e373, 0x682e6ff3, 0xd6b2b8a3,\n  0x748f82ee, 0x5defb2fc, 0x78a5636f, 0x43172f60,\n  0x84c87814, 0xa1f0ab72, 0x8cc70208, 0x1a6439ec,\n  0x90befffa, 0x23631e28, 0xa4506ceb, 0xde82bde9,\n  0xbef9a3f7, 0xb2c67915, 0xc67178f2, 0xe372532b,\n  0xca273ece, 0xea26619c, 0xd186b8c7, 0x21c0c207,\n  0xeada7dd6, 0xcde0eb1e, 0xf57d4f7f, 0xee6ed178,\n  0x06f067aa, 0x72176fba, 0x0a637dc5, 0xa2c898a6,\n  0x113f9804, 0xbef90dae, 0x1b710b35, 0x131c471b,\n  0x28db77f5, 0x23047d84, 0x32caab7b, 0x40c72493,\n  0x3c9ebe0a, 0x15c9bebc, 0x431d67c4, 0x9c100d4c,\n  0x4cc5d4be, 0xcb3e42b6, 0x597f299c, 0xfc657e2a,\n  0x5fcb6fab, 0x3ad6faec, 0x6c44198c, 0x4a475817\n];\n\nfunction SHA512() {\n  if (!(this instanceof SHA512))\n    return new SHA512();\n\n  BlockHash.call(this);\n  this.h = [\n    0x6a09e667, 0xf3bcc908,\n    0xbb67ae85, 0x84caa73b,\n    0x3c6ef372, 0xfe94f82b,\n    0xa54ff53a, 0x5f1d36f1,\n    0x510e527f, 0xade682d1,\n    0x9b05688c, 0x2b3e6c1f,\n    0x1f83d9ab, 0xfb41bd6b,\n    0x5be0cd19, 0x137e2179 ];\n  this.k = sha512_K;\n  this.W = new Array(160);\n}\nutils.inherits(SHA512, BlockHash);\nmodule.exports = SHA512;\n\nSHA512.blockSize = 1024;\nSHA512.outSize = 512;\nSHA512.hmacStrength = 192;\nSHA512.padLength = 128;\n\nSHA512.prototype._prepareBlock = function _prepareBlock(msg, start) {\n  var W = this.W;\n\n  // 32 x 32bit words\n  for (var i = 0; i < 32; i++)\n    W[i] = msg[start + i];\n  for (; i < W.length; i += 2) {\n    var c0_hi = g1_512_hi(W[i - 4], W[i - 3]);  // i - 2\n    var c0_lo = g1_512_lo(W[i - 4], W[i - 3]);\n    var c1_hi = W[i - 14];  // i - 7\n    var c1_lo = W[i - 13];\n    var c2_hi = g0_512_hi(W[i - 30], W[i - 29]);  // i - 15\n    var c2_lo = g0_512_lo(W[i - 30], W[i - 29]);\n    var c3_hi = W[i - 32];  // i - 16\n    var c3_lo = W[i - 31];\n\n    W[i] = sum64_4_hi(\n      c0_hi, c0_lo,\n      c1_hi, c1_lo,\n      c2_hi, c2_lo,\n      c3_hi, c3_lo);\n    W[i + 1] = sum64_4_lo(\n      c0_hi, c0_lo,\n      c1_hi, c1_lo,\n      c2_hi, c2_lo,\n      c3_hi, c3_lo);\n  }\n};\n\nSHA512.prototype._update = function _update(msg, start) {\n  this._prepareBlock(msg, start);\n\n  var W = this.W;\n\n  var ah = this.h[0];\n  var al = this.h[1];\n  var bh = this.h[2];\n  var bl = this.h[3];\n  var ch = this.h[4];\n  var cl = this.h[5];\n  var dh = this.h[6];\n  var dl = this.h[7];\n  var eh = this.h[8];\n  var el = this.h[9];\n  var fh = this.h[10];\n  var fl = this.h[11];\n  var gh = this.h[12];\n  var gl = this.h[13];\n  var hh = this.h[14];\n  var hl = this.h[15];\n\n  assert(this.k.length === W.length);\n  for (var i = 0; i < W.length; i += 2) {\n    var c0_hi = hh;\n    var c0_lo = hl;\n    var c1_hi = s1_512_hi(eh, el);\n    var c1_lo = s1_512_lo(eh, el);\n    var c2_hi = ch64_hi(eh, el, fh, fl, gh, gl);\n    var c2_lo = ch64_lo(eh, el, fh, fl, gh, gl);\n    var c3_hi = this.k[i];\n    var c3_lo = this.k[i + 1];\n    var c4_hi = W[i];\n    var c4_lo = W[i + 1];\n\n    var T1_hi = sum64_5_hi(\n      c0_hi, c0_lo,\n      c1_hi, c1_lo,\n      c2_hi, c2_lo,\n      c3_hi, c3_lo,\n      c4_hi, c4_lo);\n    var T1_lo = sum64_5_lo(\n      c0_hi, c0_lo,\n      c1_hi, c1_lo,\n      c2_hi, c2_lo,\n      c3_hi, c3_lo,\n      c4_hi, c4_lo);\n\n    c0_hi = s0_512_hi(ah, al);\n    c0_lo = s0_512_lo(ah, al);\n    c1_hi = maj64_hi(ah, al, bh, bl, ch, cl);\n    c1_lo = maj64_lo(ah, al, bh, bl, ch, cl);\n\n    var T2_hi = sum64_hi(c0_hi, c0_lo, c1_hi, c1_lo);\n    var T2_lo = sum64_lo(c0_hi, c0_lo, c1_hi, c1_lo);\n\n    hh = gh;\n    hl = gl;\n\n    gh = fh;\n    gl = fl;\n\n    fh = eh;\n    fl = el;\n\n    eh = sum64_hi(dh, dl, T1_hi, T1_lo);\n    el = sum64_lo(dl, dl, T1_hi, T1_lo);\n\n    dh = ch;\n    dl = cl;\n\n    ch = bh;\n    cl = bl;\n\n    bh = ah;\n    bl = al;\n\n    ah = sum64_hi(T1_hi, T1_lo, T2_hi, T2_lo);\n    al = sum64_lo(T1_hi, T1_lo, T2_hi, T2_lo);\n  }\n\n  sum64(this.h, 0, ah, al);\n  sum64(this.h, 2, bh, bl);\n  sum64(this.h, 4, ch, cl);\n  sum64(this.h, 6, dh, dl);\n  sum64(this.h, 8, eh, el);\n  sum64(this.h, 10, fh, fl);\n  sum64(this.h, 12, gh, gl);\n  sum64(this.h, 14, hh, hl);\n};\n\nSHA512.prototype._digest = function digest(enc) {\n  if (enc === 'hex')\n    return utils.toHex32(this.h, 'big');\n  else\n    return utils.split32(this.h, 'big');\n};\n\nfunction ch64_hi(xh, xl, yh, yl, zh) {\n  var r = (xh & yh) ^ ((~xh) & zh);\n  if (r < 0)\n    r += 0x100000000;\n  return r;\n}\n\nfunction ch64_lo(xh, xl, yh, yl, zh, zl) {\n  var r = (xl & yl) ^ ((~xl) & zl);\n  if (r < 0)\n    r += 0x100000000;\n  return r;\n}\n\nfunction maj64_hi(xh, xl, yh, yl, zh) {\n  var r = (xh & yh) ^ (xh & zh) ^ (yh & zh);\n  if (r < 0)\n    r += 0x100000000;\n  return r;\n}\n\nfunction maj64_lo(xh, xl, yh, yl, zh, zl) {\n  var r = (xl & yl) ^ (xl & zl) ^ (yl & zl);\n  if (r < 0)\n    r += 0x100000000;\n  return r;\n}\n\nfunction s0_512_hi(xh, xl) {\n  var c0_hi = rotr64_hi(xh, xl, 28);\n  var c1_hi = rotr64_hi(xl, xh, 2);  // 34\n  var c2_hi = rotr64_hi(xl, xh, 7);  // 39\n\n  var r = c0_hi ^ c1_hi ^ c2_hi;\n  if (r < 0)\n    r += 0x100000000;\n  return r;\n}\n\nfunction s0_512_lo(xh, xl) {\n  var c0_lo = rotr64_lo(xh, xl, 28);\n  var c1_lo = rotr64_lo(xl, xh, 2);  // 34\n  var c2_lo = rotr64_lo(xl, xh, 7);  // 39\n\n  var r = c0_lo ^ c1_lo ^ c2_lo;\n  if (r < 0)\n    r += 0x100000000;\n  return r;\n}\n\nfunction s1_512_hi(xh, xl) {\n  var c0_hi = rotr64_hi(xh, xl, 14);\n  var c1_hi = rotr64_hi(xh, xl, 18);\n  var c2_hi = rotr64_hi(xl, xh, 9);  // 41\n\n  var r = c0_hi ^ c1_hi ^ c2_hi;\n  if (r < 0)\n    r += 0x100000000;\n  return r;\n}\n\nfunction s1_512_lo(xh, xl) {\n  var c0_lo = rotr64_lo(xh, xl, 14);\n  var c1_lo = rotr64_lo(xh, xl, 18);\n  var c2_lo = rotr64_lo(xl, xh, 9);  // 41\n\n  var r = c0_lo ^ c1_lo ^ c2_lo;\n  if (r < 0)\n    r += 0x100000000;\n  return r;\n}\n\nfunction g0_512_hi(xh, xl) {\n  var c0_hi = rotr64_hi(xh, xl, 1);\n  var c1_hi = rotr64_hi(xh, xl, 8);\n  var c2_hi = shr64_hi(xh, xl, 7);\n\n  var r = c0_hi ^ c1_hi ^ c2_hi;\n  if (r < 0)\n    r += 0x100000000;\n  return r;\n}\n\nfunction g0_512_lo(xh, xl) {\n  var c0_lo = rotr64_lo(xh, xl, 1);\n  var c1_lo = rotr64_lo(xh, xl, 8);\n  var c2_lo = shr64_lo(xh, xl, 7);\n\n  var r = c0_lo ^ c1_lo ^ c2_lo;\n  if (r < 0)\n    r += 0x100000000;\n  return r;\n}\n\nfunction g1_512_hi(xh, xl) {\n  var c0_hi = rotr64_hi(xh, xl, 19);\n  var c1_hi = rotr64_hi(xl, xh, 29);  // 61\n  var c2_hi = shr64_hi(xh, xl, 6);\n\n  var r = c0_hi ^ c1_hi ^ c2_hi;\n  if (r < 0)\n    r += 0x100000000;\n  return r;\n}\n\nfunction g1_512_lo(xh, xl) {\n  var c0_lo = rotr64_lo(xh, xl, 19);\n  var c1_lo = rotr64_lo(xl, xh, 29);  // 61\n  var c2_lo = shr64_lo(xh, xl, 6);\n\n  var r = c0_lo ^ c1_lo ^ c2_lo;\n  if (r < 0)\n    r += 0x100000000;\n  return r;\n}\n","'use strict';\n\nvar utils = require('../utils');\n\nvar SHA512 = require('./512');\n\nfunction SHA384() {\n  if (!(this instanceof SHA384))\n    return new SHA384();\n\n  SHA512.call(this);\n  this.h = [\n    0xcbbb9d5d, 0xc1059ed8,\n    0x629a292a, 0x367cd507,\n    0x9159015a, 0x3070dd17,\n    0x152fecd8, 0xf70e5939,\n    0x67332667, 0xffc00b31,\n    0x8eb44a87, 0x68581511,\n    0xdb0c2e0d, 0x64f98fa7,\n    0x47b5481d, 0xbefa4fa4 ];\n}\nutils.inherits(SHA384, SHA512);\nmodule.exports = SHA384;\n\nSHA384.blockSize = 1024;\nSHA384.outSize = 384;\nSHA384.hmacStrength = 192;\nSHA384.padLength = 128;\n\nSHA384.prototype._digest = function digest(enc) {\n  if (enc === 'hex')\n    return utils.toHex32(this.h.slice(0, 12), 'big');\n  else\n    return utils.split32(this.h.slice(0, 12), 'big');\n};\n","'use strict';\n\nexports.sha1 = require('./sha/1');\nexports.sha224 = require('./sha/224');\nexports.sha256 = require('./sha/256');\nexports.sha384 = require('./sha/384');\nexports.sha512 = require('./sha/512');\n","'use strict';\n\nvar utils = require('./utils');\nvar common = require('./common');\n\nvar rotl32 = utils.rotl32;\nvar sum32 = utils.sum32;\nvar sum32_3 = utils.sum32_3;\nvar sum32_4 = utils.sum32_4;\nvar BlockHash = common.BlockHash;\n\nfunction RIPEMD160() {\n  if (!(this instanceof RIPEMD160))\n    return new RIPEMD160();\n\n  BlockHash.call(this);\n\n  this.h = [ 0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476, 0xc3d2e1f0 ];\n  this.endian = 'little';\n}\nutils.inherits(RIPEMD160, BlockHash);\nexports.ripemd160 = RIPEMD160;\n\nRIPEMD160.blockSize = 512;\nRIPEMD160.outSize = 160;\nRIPEMD160.hmacStrength = 192;\nRIPEMD160.padLength = 64;\n\nRIPEMD160.prototype._update = function update(msg, start) {\n  var A = this.h[0];\n  var B = this.h[1];\n  var C = this.h[2];\n  var D = this.h[3];\n  var E = this.h[4];\n  var Ah = A;\n  var Bh = B;\n  var Ch = C;\n  var Dh = D;\n  var Eh = E;\n  for (var j = 0; j < 80; j++) {\n    var T = sum32(\n      rotl32(\n        sum32_4(A, f(j, B, C, D), msg[r[j] + start], K(j)),\n        s[j]),\n      E);\n    A = E;\n    E = D;\n    D = rotl32(C, 10);\n    C = B;\n    B = T;\n    T = sum32(\n      rotl32(\n        sum32_4(Ah, f(79 - j, Bh, Ch, Dh), msg[rh[j] + start], Kh(j)),\n        sh[j]),\n      Eh);\n    Ah = Eh;\n    Eh = Dh;\n    Dh = rotl32(Ch, 10);\n    Ch = Bh;\n    Bh = T;\n  }\n  T = sum32_3(this.h[1], C, Dh);\n  this.h[1] = sum32_3(this.h[2], D, Eh);\n  this.h[2] = sum32_3(this.h[3], E, Ah);\n  this.h[3] = sum32_3(this.h[4], A, Bh);\n  this.h[4] = sum32_3(this.h[0], B, Ch);\n  this.h[0] = T;\n};\n\nRIPEMD160.prototype._digest = function digest(enc) {\n  if (enc === 'hex')\n    return utils.toHex32(this.h, 'little');\n  else\n    return utils.split32(this.h, 'little');\n};\n\nfunction f(j, x, y, z) {\n  if (j <= 15)\n    return x ^ y ^ z;\n  else if (j <= 31)\n    return (x & y) | ((~x) & z);\n  else if (j <= 47)\n    return (x | (~y)) ^ z;\n  else if (j <= 63)\n    return (x & z) | (y & (~z));\n  else\n    return x ^ (y | (~z));\n}\n\nfunction K(j) {\n  if (j <= 15)\n    return 0x00000000;\n  else if (j <= 31)\n    return 0x5a827999;\n  else if (j <= 47)\n    return 0x6ed9eba1;\n  else if (j <= 63)\n    return 0x8f1bbcdc;\n  else\n    return 0xa953fd4e;\n}\n\nfunction Kh(j) {\n  if (j <= 15)\n    return 0x50a28be6;\n  else if (j <= 31)\n    return 0x5c4dd124;\n  else if (j <= 47)\n    return 0x6d703ef3;\n  else if (j <= 63)\n    return 0x7a6d76e9;\n  else\n    return 0x00000000;\n}\n\nvar r = [\n  0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,\n  7, 4, 13, 1, 10, 6, 15, 3, 12, 0, 9, 5, 2, 14, 11, 8,\n  3, 10, 14, 4, 9, 15, 8, 1, 2, 7, 0, 6, 13, 11, 5, 12,\n  1, 9, 11, 10, 0, 8, 12, 4, 13, 3, 7, 15, 14, 5, 6, 2,\n  4, 0, 5, 9, 7, 12, 2, 10, 14, 1, 3, 8, 11, 6, 15, 13\n];\n\nvar rh = [\n  5, 14, 7, 0, 9, 2, 11, 4, 13, 6, 15, 8, 1, 10, 3, 12,\n  6, 11, 3, 7, 0, 13, 5, 10, 14, 15, 8, 12, 4, 9, 1, 2,\n  15, 5, 1, 3, 7, 14, 6, 9, 11, 8, 12, 2, 10, 0, 4, 13,\n  8, 6, 4, 1, 3, 11, 15, 0, 5, 12, 2, 13, 9, 7, 10, 14,\n  12, 15, 10, 4, 1, 5, 8, 7, 6, 2, 13, 14, 0, 3, 9, 11\n];\n\nvar s = [\n  11, 14, 15, 12, 5, 8, 7, 9, 11, 13, 14, 15, 6, 7, 9, 8,\n  7, 6, 8, 13, 11, 9, 7, 15, 7, 12, 15, 9, 11, 7, 13, 12,\n  11, 13, 6, 7, 14, 9, 13, 15, 14, 8, 13, 6, 5, 12, 7, 5,\n  11, 12, 14, 15, 14, 15, 9, 8, 9, 14, 5, 6, 8, 6, 5, 12,\n  9, 15, 5, 11, 6, 8, 13, 12, 5, 12, 13, 14, 11, 8, 5, 6\n];\n\nvar sh = [\n  8, 9, 9, 11, 13, 15, 15, 5, 7, 7, 8, 11, 14, 14, 12, 6,\n  9, 13, 15, 7, 12, 8, 9, 11, 7, 7, 12, 7, 6, 15, 13, 11,\n  9, 7, 15, 11, 8, 6, 6, 14, 12, 13, 5, 14, 13, 13, 7, 5,\n  15, 5, 8, 11, 14, 14, 6, 14, 6, 9, 12, 9, 12, 5, 15, 8,\n  8, 5, 12, 9, 12, 5, 14, 6, 8, 13, 6, 5, 15, 13, 11, 11\n];\n","'use strict';\n\nvar utils = require('./utils');\nvar assert = require('minimalistic-assert');\n\nfunction Hmac(hash, key, enc) {\n  if (!(this instanceof Hmac))\n    return new Hmac(hash, key, enc);\n  this.Hash = hash;\n  this.blockSize = hash.blockSize / 8;\n  this.outSize = hash.outSize / 8;\n  this.inner = null;\n  this.outer = null;\n\n  this._init(utils.toArray(key, enc));\n}\nmodule.exports = Hmac;\n\nHmac.prototype._init = function init(key) {\n  // Shorten key, if needed\n  if (key.length > this.blockSize)\n    key = new this.Hash().update(key).digest();\n  assert(key.length <= this.blockSize);\n\n  // Add padding to key\n  for (var i = key.length; i < this.blockSize; i++)\n    key.push(0);\n\n  for (i = 0; i < key.length; i++)\n    key[i] ^= 0x36;\n  this.inner = new this.Hash().update(key);\n\n  // 0x36 ^ 0x5c = 0x6a\n  for (i = 0; i < key.length; i++)\n    key[i] ^= 0x6a;\n  this.outer = new this.Hash().update(key);\n};\n\nHmac.prototype.update = function update(msg, enc) {\n  this.inner.update(msg, enc);\n  return this;\n};\n\nHmac.prototype.digest = function digest(enc) {\n  this.outer.update(this.inner.digest());\n  return this.outer.digest(enc);\n};\n","var hash = exports;\n\nhash.utils = require('./hash/utils');\nhash.common = require('./hash/common');\nhash.sha = require('./hash/sha');\nhash.ripemd = require('./hash/ripemd');\nhash.hmac = require('./hash/hmac');\n\n// Proxy hash functions to the main object\nhash.sha1 = hash.sha.sha1;\nhash.sha256 = hash.sha.sha256;\nhash.sha224 = hash.sha.sha224;\nhash.sha384 = hash.sha.sha384;\nhash.sha512 = hash.sha.sha512;\nhash.ripemd160 = hash.ripemd.ripemd160;\n","exports = module.exports = stringify\nexports.getSerialize = serializer\n\nfunction stringify(obj, replacer, spaces, cycleReplacer) {\n  return JSON.stringify(obj, serializer(replacer, cycleReplacer), spaces)\n}\n\nfunction serializer(replacer, cycleReplacer) {\n  var stack = [], keys = []\n\n  if (cycleReplacer == null) cycleReplacer = function(key, value) {\n    if (stack[0] === value) return \"[Circular ~]\"\n    return \"[Circular ~.\" + keys.slice(0, stack.indexOf(value)).join(\".\") + \"]\"\n  }\n\n  return function(key, value) {\n    if (stack.length > 0) {\n      var thisPos = stack.indexOf(this)\n      ~thisPos ? stack.splice(thisPos + 1) : stack.push(this)\n      ~thisPos ? keys.splice(thisPos, Infinity, key) : keys.push(key)\n      if (~stack.indexOf(value)) value = cycleReplacer.call(this, key, value)\n    }\n    else stack.push(value)\n\n    return replacer == null ? value : replacer.call(this, key, value)\n  }\n}\n","const list: [string, ErrorConstructor][] = [\n  Error,\n  EvalError,\n  RangeError,\n  ReferenceError,\n  SyntaxError,\n  TypeError,\n  URIError,\n  globalThis.DOMException,\n  globalThis.AssertionError,\n  globalThis.SystemError,\n]\n  .filter(Boolean)\n  .map(\n    constructor => [constructor.name, constructor],\n  );\n\nexport const errorConstructors = new Map(list);\n","import { errorConstructors } from './constructors';\nexport { errorConstructors };\n\nconst getErrorConstructor = (name: string) => errorConstructors.get(name) ?? Error;\n\nconst commonProperties: { property: string, enumerable: boolean }[] = [\n  {\n    property: 'message',\n    enumerable: false,\n  },\n  {\n    property: 'stack',\n    enumerable: false,\n  },\n  {\n    property: 'code',\n    enumerable: true,\n  },\n  {\n    property: 'cause',\n    enumerable: false,\n  },\n];\n\nexport type SerializedError = {\n  name: string;\n  message: string;\n  stack: string;\n  code?: string|number;\n  cause?: string;\n};\n\nexport function serializeError(subject: Error): SerializedError {\n  const data: SerializedError = {\n    name   : 'Error',\n    message: '',\n    stack  : '',\n  };\n  for(const { property } of commonProperties) {\n    if (!(property in subject)) continue;\n    data[property] = subject[property];\n  }\n  if (globalThis.DOMException && (subject instanceof globalThis.DOMException)) {\n    data.name = 'DOMException';\n  } else {\n    data.name = Object.getPrototypeOf(subject).name;\n  }\n  return data;\n}\n\nexport function deserializeError(subject: SerializedError): Error {\n  const fn = getErrorConstructor(subject.name);\n  const output = new fn();\n\n  for(const { property, enumerable } of commonProperties) {\n    if (!(property in subject)) continue;\n    Object.defineProperty(output, property, {\n      value: subject[property],\n      enumerable,\n      configurable: true,\n      writable: true,\n    });\n  }\n\n  return output;\n}\n\n","'use strict';\n\nmodule.exports = options => {\n\toptions = Object.assign({\n\t\tonlyFirst: false\n\t}, options);\n\n\tconst pattern = [\n\t\t'[\\\\u001B\\\\u009B][[\\\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]+)*|[a-zA-Z\\\\d]+(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]*)*)?\\\\u0007)',\n\t\t'(?:(?:\\\\d{1,4}(?:;\\\\d{0,4})*)?[\\\\dA-PR-TZcf-ntqry=><~]))'\n\t].join('|');\n\n\treturn new RegExp(pattern, options.onlyFirst ? undefined : 'g');\n};\n","'use strict';\nconst ansiRegex = require('ansi-regex');\n\nconst stripAnsi = string => typeof string === 'string' ? string.replace(ansiRegex(), '') : string;\n\nmodule.exports = stripAnsi;\nmodule.exports.default = stripAnsi;\n","unable to read source [project]/node_modules/.pnpm/@inngest+ai@0.1.6/node_modules/@inngest/ai/src/adapters/anthropic.ts","unable to read source [project]/node_modules/.pnpm/@inngest+ai@0.1.6/node_modules/@inngest/ai/src/adapters/gemini.ts","unable to read source [project]/node_modules/.pnpm/@inngest+ai@0.1.6/node_modules/@inngest/ai/src/adapters/openai.ts","unable to read source [project]/node_modules/.pnpm/@inngest+ai@0.1.6/node_modules/@inngest/ai/src/adapters/azure-openai.ts","unable to read source [project]/node_modules/.pnpm/@inngest+ai@0.1.6/node_modules/@inngest/ai/src/adapters/grok.ts","unable to read source [project]/node_modules/.pnpm/@inngest+ai@0.1.6/node_modules/@inngest/ai/src/adapters/index.ts","unable to read source [project]/node_modules/.pnpm/@inngest+ai@0.1.6/node_modules/@inngest/ai/src/env.ts","unable to read source [project]/node_modules/.pnpm/@inngest+ai@0.1.6/node_modules/@inngest/ai/src/models/anthropic.ts","unable to read source [project]/node_modules/.pnpm/@inngest+ai@0.1.6/node_modules/@inngest/ai/src/models/gemini.ts","unable to read source [project]/node_modules/.pnpm/@inngest+ai@0.1.6/node_modules/@inngest/ai/src/models/openai.ts","unable to read source [project]/node_modules/.pnpm/@inngest+ai@0.1.6/node_modules/@inngest/ai/src/models/azure-openai.ts","unable to read source [project]/node_modules/.pnpm/@inngest+ai@0.1.6/node_modules/@inngest/ai/src/models/deepseek.ts","unable to read source [project]/node_modules/.pnpm/@inngest+ai@0.1.6/node_modules/@inngest/ai/src/models/grok.ts","unable to read source [project]/node_modules/.pnpm/@inngest+ai@0.1.6/node_modules/@inngest/ai/src/models/index.ts","unable to read source [project]/node_modules/.pnpm/@inngest+ai@0.1.6/node_modules/@inngest/ai/src/index.ts","/* jshint esversion: 6 */\n/* jslint node: true */\n'use strict';\n\nmodule.exports = function serialize (object) {\n  if (object === null || typeof object !== 'object' || object.toJSON != null) {\n    return JSON.stringify(object);\n  }\n\n  if (Array.isArray(object)) {\n    return '[' + object.reduce((t, cv, ci) => {\n      const comma = ci === 0 ? '' : ',';\n      const value = cv === undefined || typeof cv === 'symbol' ? null : cv;\n      return t + comma + serialize(value);\n    }, '') + ']';\n  }\n\n  return '{' + Object.keys(object).sort().reduce((t, cv, ci) => {\n    if (object[cv] === undefined ||\n        typeof object[cv] === 'symbol') {\n      return t;\n    }\n    const comma = t.length === 0 ? '' : ',';\n    return t + comma + serialize(cv) + ':' + serialize(object[cv]);\n  }, '') + '}';\n};\n","//#region rolldown:runtime\nvar __defProp = Object.defineProperty;\nvar __export = (all) => {\n\tlet target = {};\n\tfor (var name in all) __defProp(target, name, {\n\t\tget: all[name],\n\t\tenumerable: true\n\t});\n\treturn target;\n};\nvar __require = /* @__PURE__ */ ((x) => typeof require !== \"undefined\" ? require : typeof Proxy !== \"undefined\" ? new Proxy(x, { get: (a, b) => (typeof require !== \"undefined\" ? require : a)[b] }) : x)(function(x) {\n\tif (typeof require !== \"undefined\") return require.apply(this, arguments);\n\tthrow Error(\"Calling `require` for \\\"\" + x + \"\\\" in an environment that doesn't expose the `require` function.\");\n});\n\n//#endregion\nexport { __export, __require };","/**\n * All kinds of arguments can come through\n *\n * Examples seen are\n * - string\n * - object / hash\n * - values used for string interpolation, basically anything\n *\n * See https://linear.app/inngest/issue/INN-1342/flush-logs-on-function-exitreturns for more details\n *\n * @public\n */\nexport type LogArg = unknown;\n\n/**\n * Based on https://datatracker.ietf.org/doc/html/rfc5424#autoid-11\n * it's pretty reasonable to expect a logger to have the following interfaces\n * available.\n */\nexport interface Logger {\n  info(...args: LogArg[]): void;\n  warn(...args: LogArg[]): void;\n  error(...args: LogArg[]): void;\n  debug(...args: LogArg[]): void;\n}\n\nexport class DefaultLogger implements Logger {\n  info(...args: LogArg[]) {\n    console.info(...args);\n  }\n\n  warn(...args: LogArg[]) {\n    console.warn(...args);\n  }\n\n  error(...args: LogArg[]) {\n    console.error(...args);\n  }\n\n  debug(...args: LogArg[]) {\n    console.debug(...args);\n  }\n}\n\n/**\n * ProxyLogger aims to provide a thin wrapper on user's provided logger.\n * It's expected to be turned on and off based on the function execution\n * context, so it doesn't result in duplicated logging.\n *\n * And also attempt to allow enough time for the logger to flush all logs.\n *\n * @public\n */\nexport class ProxyLogger implements Logger {\n  private readonly logger: Logger;\n  private enabled = false;\n\n  constructor(logger: Logger) {\n    this.logger = logger;\n\n    // Return a Proxy to forward arbitrary property access to the underlying\n    // logger. For example, if the user provides a logger that has a `foo`\n    // method, they can call `foo` on the ProxyLogger and it will call the\n    // underlying logger's `foo` method.\n    return new Proxy(this, {\n      get(target, prop, receiver): unknown {\n        // Handle ProxyLogger's own methods/properties.\n        if (prop in target) {\n          return Reflect.get(target, prop, receiver);\n        }\n\n        // Forward property access to the underlying logger.\n        return Reflect.get(target.logger, prop, receiver);\n      },\n    }) as ProxyLogger;\n  }\n\n  info(...args: LogArg[]) {\n    if (!this.enabled) return;\n    this.logger.info(...args);\n  }\n\n  warn(...args: LogArg[]) {\n    if (!this.enabled) return;\n    this.logger.warn(...args);\n  }\n\n  error(...args: LogArg[]) {\n    if (!this.enabled) return;\n    this.logger.error(...args);\n  }\n\n  debug(...args: LogArg[]) {\n    // there are loggers that don't implement \"debug\" by default\n    if (!this.enabled || !(typeof this.logger.debug === \"function\")) return;\n    this.logger.debug(...args);\n  }\n\n  enable() {\n    this.enabled = true;\n  }\n\n  disable() {\n    this.enabled = false;\n  }\n\n  async flush() {\n    // Allow 1s for the provided logger to handle flushing since the ones that do\n    // flushing usually has some kind of timeout of up to 1s.\n    //\n    // TODO:\n    // This should only happen when using a serverless environment because it's very\n    // costly from the compute perspective.\n    // server runtimes should just let the logger do their thing since most of them\n    // should have already figured what to do in those environments, be it threading or\n    // something else.\n    if (this.logger.constructor.name !== DefaultLogger.name) {\n      await new Promise((resolve) => {\n        setTimeout(() => resolve(null), 1000);\n      });\n    }\n  }\n}\n","// Generated by genversion.\nexport const version = \"3.44.2\";\n","import canonicalize from \"canonicalize\";\nimport hashjs from \"hash.js\";\n\nconst { hmac, sha256 } = hashjs;\n\n/**\n * Send an HTTP request with the given signing key. If the response is a 401 or\n * 403, then try again with the fallback signing key\n */\nexport async function fetchWithAuthFallback<TFetch extends typeof fetch>({\n  authToken,\n  authTokenFallback,\n  fetch,\n  options,\n  url,\n}: {\n  authToken?: string;\n  authTokenFallback?: string;\n  fetch: TFetch;\n  options?: Parameters<TFetch>[1];\n  url: URL | string;\n}): Promise<Response> {\n  let res = await fetch(url, {\n    ...options,\n    headers: {\n      ...options?.headers,\n      Authorization: `Bearer ${authToken}`,\n    },\n  });\n\n  if ([401, 403].includes(res.status) && authTokenFallback) {\n    res = await fetch(url, {\n      ...options,\n      headers: {\n        ...options?.headers,\n        Authorization: `Bearer ${authTokenFallback}`,\n      },\n    });\n  }\n\n  return res;\n}\n\nexport function signDataWithKey(\n  data: unknown,\n  signingKey: string,\n  ts: string,\n): string {\n  // Calculate the HMAC of the request body ourselves.\n  // We make the assumption here that a stringified body is the same as the\n  // raw bytes; it may be pertinent in the future to always parse, then\n  // canonicalize the body to ensure it's consistent.\n  const encoded = typeof data === \"string\" ? data : canonicalize(data);\n  // Remove the `/signkey-[test|prod]-/` prefix from our signing key to calculate the HMAC.\n  const key = signingKey.replace(/signkey-\\w+-/, \"\");\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n  const mac = hmac(sha256 as any, key)\n    .update(encoded)\n    .update(ts)\n    .digest(\"hex\");\n\n  return mac;\n}\n","import type { Temporal } from \"temporal-polyfill\";\n\n/**\n * A type that represents a `Temporal.Instant` object.\n *\n * `*Like` types are available for many temporal objects, but not all of them.\n * Also, the `*Like` types can sometimes be linked to particular\n * implementations, and are not stable between them.\n *\n * Therefore, we try to detect only the hopefully-stable branding.\n */\nexport type InstantLike = {\n  readonly [Symbol.toStringTag]: \"Temporal.Instant\";\n};\n\n/**\n * A type that represents a `Temporal.Duration` object.\n *\n * `*Like` types are available for many temporal objects, but not all of them.\n * Also, the `*Like` types can sometimes be linked to particular\n * implementations, and are not stable between them.\n *\n * Therefore, we try to detect only the hopefully-stable branding.\n */\nexport type DurationLike = {\n  readonly [Symbol.toStringTag]: \"Temporal.Duration\";\n};\n\n/**\n * A type that represents a `Temporal.ZonedDateTime` object.\n *\n * `*Like` types are available for many temporal objects, but not all of them.\n * Also, the `*Like` types can sometimes be linked to particular\n * implementations, and are not stable between them.\n *\n * Therefore, we try to detect only the hopefully-stable branding.\n */\nexport type ZonedDateTimeLike = {\n  readonly [Symbol.toStringTag]: \"Temporal.ZonedDateTime\";\n};\n\n/**\n * Asserts that the given `input` is a `Temporal.Duration` object.\n */\nexport const isTemporalDuration = (\n  /**\n   * The input to check.\n   */\n  input: unknown,\n): input is Temporal.Duration => {\n  try {\n    // biome-ignore lint/suspicious/noExplicitAny: Safe access as we're catching\n    return (input as any)[Symbol.toStringTag] === \"Temporal.Duration\";\n  } catch {\n    return false;\n  }\n};\n\n/**\n * Asserts that the given `input` is a `Temporal.TimeZone` object.\n */\nexport const isTemporalInstant = (\n  /**\n   * The input to check.\n   */\n  input: unknown,\n): input is Temporal.Instant => {\n  try {\n    // biome-ignore lint/suspicious/noExplicitAny: Safe access as we're catching\n    return (input as any)[Symbol.toStringTag] === \"Temporal.Instant\";\n  } catch {\n    return false;\n  }\n};\n\n/**\n * Asserts that the given `input` is a `Temporal.ZonedDateTime` object.\n */\nexport const isTemporalZonedDateTime = (\n  /**\n   * The input to check.\n   */\n  input: unknown,\n): input is Temporal.ZonedDateTime => {\n  try {\n    // biome-ignore lint/suspicious/noExplicitAny: Safe access as we're catching\n    return (input as any)[Symbol.toStringTag] === \"Temporal.ZonedDateTime\";\n  } catch {\n    return false;\n  }\n};\n\n/**\n * Converts a given `Date`, `string`, `Temporal.Instant`, or\n * `Temporal.ZonedDateTime` to an ISO 8601 string.\n */\nexport const getISOString = (\n  time: Date | string | InstantLike | ZonedDateTimeLike,\n): string => {\n  if (typeof time === \"string\") {\n    return new Date(time).toISOString();\n  }\n\n  if (time instanceof Date) {\n    return time.toISOString();\n  }\n\n  if (isTemporalZonedDateTime(time)) {\n    return time.toInstant().toString();\n  }\n\n  if (isTemporalInstant(time)) {\n    return time.toString();\n  }\n\n  throw new TypeError(\"Invalid date input\");\n};\n","import Debug from \"debug\";\nimport type { Simplify } from \"../helpers/types.ts\";\nimport { getAsyncCtx } from \"./execution/als.ts\";\nimport { gatewaySymbol, type InternalStepTools } from \"./InngestStepTools.ts\";\n\nconst globalFetch = globalThis.fetch;\ntype Fetch = typeof globalFetch;\n\nexport type StepFetch = Fetch &\n  Simplify<\n    {\n      config: (options: StepFetch.Options) => StepFetch;\n    } & Readonly<StepFetch.Options>\n  >;\n\nexport namespace StepFetch {\n  export interface Options {\n    fallback?: Fetch | undefined;\n  }\n\n  export interface Extras extends Options {\n    config: (options: Options) => StepFetch;\n  }\n}\n\nconst debug = Debug(\"inngest:fetch\");\n\nconst createFetchShim = (): StepFetch => {\n  // biome-ignore lint/style/useConst: need this to allow fns to be defined\n  let stepFetch: StepFetch;\n\n  const fetch: Fetch = async (input, init) => {\n    const ctx = await getAsyncCtx();\n    if (!ctx) {\n      // Not in a function run\n      if (!stepFetch.fallback) {\n        // TODO Tell the user how to solve\n        throw new Error(\n          \"step.fetch() called outside of a function and had no fallback set\",\n        );\n      }\n\n      debug(\n        \"step.fetch() called outside of a function; falling back to global fetch\",\n      );\n\n      return stepFetch.fallback(input, init);\n    }\n\n    // In a function run\n    if (ctx.executingStep) {\n      // Inside a step\n      if (!stepFetch.fallback) {\n        // TODO Tell the user how to solve\n        throw new Error(\n          `step.fetch() called inside step \"${ctx.executingStep.id}\" and had no fallback set`,\n        );\n      }\n\n      debug(\n        `step.fetch() called inside step \"${ctx.executingStep.id}\"; falling back to global fetch`,\n      );\n\n      return stepFetch.fallback(input, init);\n    }\n\n    const targetUrl = new URL(\n      input instanceof Request ? input.url : input.toString(),\n    );\n\n    debug(\"step.fetch() shimming request to\", targetUrl.hostname);\n\n    // Purposefully do not try/cacth this; if it throws then we treat that as a\n    // regular `fetch()` throw, which also would not return a `Response`.\n    const jsonRes = await (ctx.ctx.step as InternalStepTools)[gatewaySymbol](\n      `step.fetch: ${targetUrl.hostname}`,\n      input,\n      init,\n    );\n\n    return new Response(jsonRes.body, {\n      headers: jsonRes.headers,\n      status: jsonRes.status,\n    });\n  };\n\n  const optionsRef: StepFetch.Options = {\n    fallback: globalFetch,\n  };\n\n  const extras: StepFetch.Extras = {\n    config: (options) => {\n      Object.assign(optionsRef, options);\n      Object.assign(stepFetch, optionsRef);\n\n      return stepFetch;\n    },\n    ...optionsRef,\n  };\n\n  stepFetch = Object.assign(fetch, extras);\n\n  return stepFetch;\n};\n\n/**\n * `fetch` is a Fetch API-compatible function that can be used to make any HTTP\n * code durable if it's called within an Inngest function.\n *\n * It will gracefully fall back to the global `fetch` if called outside of this\n * context, and a custom fallback can be set using the `config` method.\n *\n * @example Basic usage\n * ```ts\n * import { fetch } from \"inngest\";\n *\n * const api = new MyProductApi({ fetch });\n * ```\n *\n * @example Setting a custom fallback\n * ```ts\n * import { fetch } from \"inngest\";\n *\n * const api = new MyProductApi({\n *            fetch: fetch.config({ fallback: myCustomFetch }),\n * });\n * ```\n *\n * @example Do not allow fallback\n * ```ts\n * import { fetch } from \"inngest\";\n *\n * const api = new MyProductApi({\n *            fetch: fetch.config({ fallback: undefined }),\n * });\n * ```\n */\nexport const fetch = createFetchShim();\n","import hashjs from \"hash.js\";\nimport { default as safeStringify } from \"json-stringify-safe\";\nimport ms from \"ms\";\nimport type { TimeStr } from \"../types.ts\";\n\nconst { sha256 } = hashjs;\n\n/**\n * Safely `JSON.stringify()` an `input`, handling circular refernences and\n * removing `BigInt` values.\n */\n// biome-ignore lint/suspicious/noExplicitAny: <explanation>\nexport const stringify = (input: any): string => {\n  return safeStringify(input, (_key, value) => {\n    if (typeof value !== \"bigint\") {\n      return value;\n    }\n  });\n};\n\n/**\n * Returns a slugified string used to generate consistent IDs.\n *\n * This can be used to generate a consistent ID for a function when migrating\n * from v2 to v3 of the SDK.\n *\n * @public\n */\nexport const slugify = (str: string): string => {\n  const join = \"-\";\n  return str\n    .toLowerCase()\n    .replace(/[^a-z0-9-]+/g, join)\n    .replace(/-+/g, join)\n    .split(join)\n    .filter(Boolean)\n    .join(join);\n};\n\nconst millisecond = 1;\nconst second = millisecond * 1000;\nconst minute = second * 60;\nconst hour = minute * 60;\nconst day = hour * 24;\nconst week = day * 7;\n\n/**\n * A collection of periods in milliseconds and their suffixes used when creating\n * time strings.\n */\nconst periods = [\n  [\"w\", week],\n  [\"d\", day],\n  [\"h\", hour],\n  [\"m\", minute],\n  [\"s\", second],\n] as const;\n\n/**\n * Convert a given `Date`, `number`, or `ms`-compatible `string` to a\n * Inngest sleep-compatible time string (e.g. `\"1d\"` or `\"2h3010s\"`).\n *\n * Can optionally provide a `now` date to use as the base for the calculation,\n * otherwise a new date will be created on invocation.\n */\nexport const timeStr = (\n  /**\n   * The future date to use to convert to a time string.\n   */\n  input: string | number | Date,\n): string => {\n  if (input instanceof Date) {\n    return input.toISOString();\n  }\n\n  const milliseconds: number =\n    typeof input === \"string\" ? ms(input as `${number}`) : input;\n\n  const [, timeStr] = periods.reduce<[number, string]>(\n    ([num, str], [suffix, period]) => {\n      const numPeriods = Math.floor(num / period);\n\n      if (numPeriods > 0) {\n        return [num % period, `${str}${numPeriods}${suffix}`];\n      }\n\n      return [num, str];\n    },\n    [milliseconds, \"\"],\n  );\n\n  return timeStr as TimeStr;\n};\n\n/**\n * Given an unknown input, stringify it if it's a boolean, a number, or a\n * string, else return `undefined`.\n */\nexport const stringifyUnknown = (input: unknown): string | undefined => {\n  if (\n    typeof input === \"boolean\" ||\n    typeof input === \"number\" ||\n    typeof input === \"string\"\n  ) {\n    return input.toString();\n  }\n\n  return;\n};\n\nexport const hashEventKey = (eventKey: string): string => {\n  return sha256().update(eventKey).digest(\"hex\");\n};\n\nexport const hashSigningKey = (signingKey: string | undefined): string => {\n  if (!signingKey) {\n    return \"\";\n  }\n\n  const prefix = signingKey.match(/^signkey-[\\w]+-/)?.shift() || \"\";\n  const key = signingKey.replace(/^signkey-[\\w]+-/, \"\");\n\n  // Decode the key from its hex representation into a bytestream\n  return `${prefix}${sha256().update(key, \"hex\").digest(\"hex\")}`;\n};\n","import type { Context, StepOptions } from \"../../types.ts\";\nimport type { Inngest } from \"../Inngest.ts\";\n\nexport interface AsyncContext {\n  /**\n   * The Inngest App that is currently being used to execute the function.\n   */\n  app: Inngest.Like;\n\n  /**\n   * The `ctx` object that has been passed in to this function execution,\n   * including values such as `step` and `event`.\n   */\n  ctx: Context.Any;\n\n  /**\n   * If present, this indicates we are currently executing a `step.run()` step's\n   * callback. Useful to understand whether we are in the context of a step\n   * execution or within the main function body.\n   */\n  executingStep?: StepOptions;\n}\n\n/**\n * A local-only symbol used as a key in global state to store the async local\n * storage instance.\n */\nconst alsSymbol = Symbol.for(\"inngest:als\");\n\n/**\n * A type that represents a partial, runtime-agnostic interface of\n * `AsyncLocalStorage`.\n */\ntype AsyncLocalStorageIsh = {\n  getStore: () => AsyncContext | undefined;\n  run: <R>(store: AsyncContext, fn: () => R) => R;\n};\n\n/**\n * Retrieve the async context for the current execution.\n */\nexport const getAsyncCtx = async (): Promise<AsyncContext | undefined> => {\n  return getAsyncLocalStorage().then((als) => als.getStore());\n};\n\n/**\n * Get a singleton instance of `AsyncLocalStorage` used to store and retrieve\n * async context for the current execution.\n */\nexport const getAsyncLocalStorage = async (): Promise<AsyncLocalStorageIsh> => {\n  (globalThis as Record<string | symbol | number, unknown>)[alsSymbol] ??=\n    new Promise<AsyncLocalStorageIsh>(async (resolve) => {\n      try {\n        const { AsyncLocalStorage } = await import(\"node:async_hooks\");\n\n        resolve(new AsyncLocalStorage<AsyncContext>());\n      } catch (_err) {\n        console.warn(\n          \"node:async_hooks is not supported in this runtime. Experimental async context is disabled.\",\n        );\n\n        resolve({\n          getStore: () => undefined,\n          run: (_, fn) => fn(),\n        });\n      }\n    });\n\n  return (globalThis as Record<string | symbol | number, unknown>)[\n    alsSymbol\n  ] as Promise<AsyncLocalStorageIsh>;\n};\n","import { z } from \"zod/v3\";\nimport { ExecutionVersion } from \"../helpers/consts.ts\";\nimport { type EventPayload, jsonErrorSchema } from \"../types.ts\";\n\nexport const errorSchema = z.object({\n  error: z.string(),\n  status: z.number(),\n});\nexport type ErrorResponse = z.infer<typeof errorSchema>;\n\nconst v0StepSchema = z\n  .record(\n    z.any().refine((v) => typeof v !== \"undefined\", {\n      message: \"Values in steps must be defined\",\n    }),\n  )\n  .optional()\n  .nullable();\n\nconst v1StepSchema = z\n  .record(\n    z\n      .object({\n        type: z.literal(\"data\").optional().default(\"data\"),\n        data: z.any().refine((v) => typeof v !== \"undefined\", {\n          message: \"Data in steps must be defined\",\n        }),\n      })\n      .strict()\n      .or(\n        z\n          .object({\n            type: z.literal(\"error\").optional().default(\"error\"),\n            error: jsonErrorSchema,\n          })\n          .strict(),\n      )\n      .or(\n        z\n          .object({\n            type: z.literal(\"input\").optional().default(\"input\"),\n            input: z.any().refine((v) => typeof v !== \"undefined\", {\n              message: \"If input is present it must not be `undefined`\",\n            }),\n          })\n          .strict(),\n      )\n\n      /**\n       * If the result isn't a distcint `data` or `error` object, then it's\n       * likely that the executor has set this directly to a value, for example\n       * in the case of `sleep` or `waitForEvent`.\n       *\n       * In this case, pull the entire value through as data.\n       */\n\n      .or(z.any().transform((v) => ({ type: \"data\" as const, data: v }))),\n  )\n  .default({});\n\nconst v2StepSchema = v1StepSchema;\n\nexport const stepsSchemas = {\n  [ExecutionVersion.V0]: v0StepSchema,\n  [ExecutionVersion.V1]: v1StepSchema,\n  [ExecutionVersion.V2]: v2StepSchema,\n} satisfies Record<ExecutionVersion, z.ZodSchema>;\n\nexport type StepsResponse = {\n  [V in ExecutionVersion]: z.infer<(typeof stepsSchemas)[V]>;\n}[ExecutionVersion];\n\nexport const batchSchema = z.array(\n  z.record(z.any()).transform((v) => v as EventPayload),\n);\nexport type BatchResponse = z.infer<typeof batchSchema>;\n","/**\n * A file used to access client processors safely without also importing any\n * otel-specific libraries. Useful for ensuring that the otel libraries can be\n * tree-shaken if they're not used directly by the user.\n */\n\nimport type { Inngest } from \"../../Inngest.ts\";\nimport type { InngestSpanProcessor } from \"./processor.ts\";\n\n/**\n * A map of Inngest clients to their OTel span processors. This is used to\n * ensure that we only create one span processor per client, and that we can\n * access the span processor from the client without exposing the OTel\n * libraries to the user.\n */\nexport const clientProcessorMap = new WeakMap<\n  Inngest.Any,\n  InngestSpanProcessor\n>();\n","/**\n * Create a cryptographically secure random value.\n *\n * @throws {Error} If the crypto module is not available.\n */\nexport function createEntropy(byteLength: number): Uint8Array {\n  const bytes = new Uint8Array(byteLength);\n\n  // https://developer.mozilla.org/en-US/docs/Web/API/Crypto#browser_compatibility\n  const { crypto } = globalThis;\n  if (!crypto) {\n    // This should only happen in Node <19.\n    throw new Error(\"missing crypto module\");\n  }\n  if (!crypto.getRandomValues) {\n    throw new Error(\"missing crypto.getRandomValues\");\n  }\n\n  crypto.getRandomValues(bytes);\n  return bytes;\n}\n","/**\n * Inngest Client\n *\n * Centralized Inngest client for serverless function orchestration.\n * Used for async message processing, scheduled tasks, and event-driven workflows.\n */\n\nimport { Inngest } from 'inngest';\n\nexport const inngest = new Inngest({\n  id: 'gymtext',\n  name: 'GymText - AI Fitness Coaching'\n});\n","import { defaultDevServerHost } from \"./consts.ts\";\nimport { devServerHost as envDevServerHost } from \"./env.ts\";\n\n// re-export from devserver.ts\n\n/**\n * A simple type map that we can transparently use `fetch` later without having\n * to fall in to the self-referencing `const fetch: typeof fetch = ...` which\n * fails.\n */\ntype FetchT = typeof fetch;\n\n/**\n * Attempts to contact the dev server, returning a boolean indicating whether or\n * not it was successful.\n *\n * @example devServerUrl(process.env[envKeys.DevServerUrl], \"/your-path\")\n */\nexport const devServerAvailable = async (\n  /**\n   * The host of the dev server. You should pass in an environment variable as\n   * this parameter.\n   */\n  host: string = defaultDevServerHost,\n\n  /**\n   * The fetch implementation to use to communicate with the dev server.\n   */\n  fetch: FetchT,\n): Promise<boolean> => {\n  try {\n    const url = devServerUrl(host, \"/dev\");\n    const result = await fetch(url.toString());\n    await result.json();\n    return true;\n  } catch (_e) {\n    return false;\n  }\n};\n\n/**\n * devServerUrl returns a full URL for the given path name.\n *\n * Because Cloudflare/V8 platforms don't allow process.env, you are expected\n * to pass in the host from the dev server env key:\n *\n * @example devServerUrl(processEnv(envKeys.DevServerUrl), \"/your-path\")\n * @example devServerUrl(\"http://localhost:8288/\", \"/your-path\")\n */\nexport const devServerUrl = (\n  host: string = devServerHost(),\n  pathname = \"\",\n): URL => {\n  return new URL(pathname, host.includes(\"://\") ? host : `http://${host}`);\n};\n\n/**\n * devServerHost exports the development server's domain by inspecting env\n * variables, or returns the default development server URL.\n *\n * This guarantees a specific URL as a string, as opposed to the env export\n * which only returns a value of the env var is set.\n */\nexport const devServerHost = (): string =>\n  envDevServerHost() || defaultDevServerHost;\n","import type { fetch } from \"cross-fetch\";\nimport { z } from \"zod/v3\";\nimport {\n  defaultDevServerHost,\n  defaultInngestApiBaseUrl,\n  type ExecutionVersion,\n} from \"../helpers/consts.ts\";\nimport { devServerAvailable } from \"../helpers/devserver.ts\";\nimport type { Mode } from \"../helpers/env.ts\";\nimport { getErrorMessage } from \"../helpers/errors.ts\";\nimport { fetchWithAuthFallback } from \"../helpers/net.ts\";\nimport { hashSigningKey } from \"../helpers/strings.ts\";\nimport { err, ok, type Result } from \"../types.ts\";\nimport {\n  type BatchResponse,\n  batchSchema,\n  type ErrorResponse,\n  errorSchema,\n  type StepsResponse,\n  stepsSchemas,\n} from \"./schema.ts\";\n\ntype FetchT = typeof fetch;\n\nconst realtimeSubscriptionTokenSchema = z.object({\n  jwt: z.string(),\n});\n\nconst sendSignalSuccessResponseSchema = z.object({\n  data: z.object({\n    run_id: z.string().min(1),\n  }),\n});\n\nexport namespace InngestApi {\n  export interface Options {\n    baseUrl?: string;\n    signingKey: string;\n    signingKeyFallback: string | undefined;\n    fetch: FetchT;\n    mode: Mode;\n  }\n\n  export interface Subscription {\n    topics: string[];\n    channel: string;\n  }\n\n  export interface PublishOptions extends Subscription {\n    runId?: string;\n  }\n\n  export interface SendSignalOptions {\n    signal: string;\n    data?: unknown;\n  }\n\n  export interface SendSignalResponse {\n    /**\n     * The ID of the run that was signaled.\n     *\n     * If this is undefined, the signal could not be matched to a run.\n     */\n    runId: string | undefined;\n  }\n}\n\nexport class InngestApi {\n  public apiBaseUrl?: string;\n  private signingKey: string;\n  private signingKeyFallback: string | undefined;\n  private readonly fetch: FetchT;\n  private mode: Mode;\n\n  constructor({\n    baseUrl,\n    signingKey,\n    signingKeyFallback,\n    fetch,\n    mode,\n  }: InngestApi.Options) {\n    this.apiBaseUrl = baseUrl;\n    this.signingKey = signingKey;\n    this.signingKeyFallback = signingKeyFallback;\n    this.fetch = fetch;\n    this.mode = mode;\n  }\n\n  private get hashedKey(): string {\n    return hashSigningKey(this.signingKey);\n  }\n\n  private get hashedFallbackKey(): string | undefined {\n    if (!this.signingKeyFallback) {\n      return;\n    }\n\n    return hashSigningKey(this.signingKeyFallback);\n  }\n\n  // set the signing key in case it was not instantiated previously\n  setSigningKey(key: string | undefined) {\n    if (typeof key === \"string\" && this.signingKey === \"\") {\n      this.signingKey = key;\n    }\n  }\n\n  setSigningKeyFallback(key: string | undefined) {\n    if (typeof key === \"string\" && !this.signingKeyFallback) {\n      this.signingKeyFallback = key;\n    }\n  }\n\n  private async getTargetUrl(path: string): Promise<URL> {\n    if (this.apiBaseUrl) {\n      return new URL(path, this.apiBaseUrl);\n    }\n\n    let url = new URL(path, defaultInngestApiBaseUrl);\n\n    if (this.mode.isDev && this.mode.isInferred && !this.apiBaseUrl) {\n      const devAvailable = await devServerAvailable(\n        defaultDevServerHost,\n        this.fetch,\n      );\n\n      if (devAvailable) {\n        url = new URL(path, defaultDevServerHost);\n      }\n    }\n\n    return url;\n  }\n\n  async getRunSteps(\n    runId: string,\n    version: ExecutionVersion,\n  ): Promise<Result<StepsResponse, ErrorResponse>> {\n    return fetchWithAuthFallback({\n      authToken: this.hashedKey,\n      authTokenFallback: this.hashedFallbackKey,\n      fetch: this.fetch,\n      url: await this.getTargetUrl(`/v0/runs/${runId}/actions`),\n    })\n      .then(async (resp) => {\n        const data: unknown = await resp.json();\n\n        if (resp.ok) {\n          return ok(stepsSchemas[version].parse(data));\n        } else {\n          return err(errorSchema.parse(data));\n        }\n      })\n      .catch((error) => {\n        return err({\n          error: getErrorMessage(error, \"Unknown error retrieving step data\"),\n          status: 500,\n        });\n      });\n  }\n\n  async getRunBatch(\n    runId: string,\n  ): Promise<Result<BatchResponse, ErrorResponse>> {\n    return fetchWithAuthFallback({\n      authToken: this.hashedKey,\n      authTokenFallback: this.hashedFallbackKey,\n      fetch: this.fetch,\n      url: await this.getTargetUrl(`/v0/runs/${runId}/batch`),\n    })\n      .then(async (resp) => {\n        const data: unknown = await resp.json();\n\n        if (resp.ok) {\n          return ok(batchSchema.parse(data));\n        } else {\n          return err(errorSchema.parse(data));\n        }\n      })\n      .catch((error) => {\n        return err({\n          error: getErrorMessage(error, \"Unknown error retrieving event batch\"),\n          status: 500,\n        });\n      });\n  }\n\n  async publish(\n    publishOptions: InngestApi.PublishOptions,\n    // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n    data: any,\n  ): Promise<Result<void, ErrorResponse>> {\n    // todo it may not be a \"text/stream\"\n    const isStream = data instanceof ReadableStream;\n    const url = await this.getTargetUrl(\"/v1/realtime/publish\");\n\n    url.searchParams.set(\"channel\", publishOptions.channel || \"\");\n\n    if (publishOptions.runId) {\n      url.searchParams.set(\"run_id\", publishOptions.runId);\n    }\n\n    // biome-ignore lint/complexity/noForEach: <explanation>\n    publishOptions.topics.forEach((topic) => {\n      url.searchParams.append(\"topic\", topic);\n    });\n\n    return fetchWithAuthFallback({\n      authToken: this.hashedKey,\n      authTokenFallback: this.hashedFallbackKey,\n      fetch: this.fetch,\n      url,\n      options: {\n        method: \"POST\",\n        body: isStream\n          ? data\n          : typeof data === \"string\"\n            ? data\n            : JSON.stringify(data),\n        headers: {\n          \"Content-Type\": isStream ? \"text/stream\" : \"application/json\",\n        },\n        ...(isStream ? { duplex: \"half\" } : {}),\n      },\n    })\n      .then((res) => {\n        if (!res.ok) {\n          throw new Error(\n            `Failed to publish event: ${res.status} ${res.statusText}`,\n          );\n        }\n\n        return ok<void>(undefined);\n      })\n      .catch((error) => {\n        return err({\n          error: getErrorMessage(error, \"Unknown error publishing event\"),\n          status: 500,\n        });\n      });\n  }\n\n  async sendSignal(\n    signalOptions: InngestApi.SendSignalOptions,\n    options?: {\n      headers?: Record<string, string>;\n    },\n  ): Promise<Result<InngestApi.SendSignalResponse, ErrorResponse>> {\n    const url = await this.getTargetUrl(\"/v1/signals\");\n\n    const body = {\n      signal: signalOptions.signal,\n      data: signalOptions.data,\n    };\n\n    return fetchWithAuthFallback({\n      authToken: this.hashedKey,\n      authTokenFallback: this.hashedFallbackKey,\n      fetch: this.fetch,\n      url,\n      options: {\n        method: \"POST\",\n        body: JSON.stringify(body),\n        headers: {\n          \"Content-Type\": \"application/json\",\n          ...options?.headers,\n        },\n      },\n    })\n      .then(async (res) => {\n        // A 404 is valid if the signal was not found.\n        if (res.status === 404) {\n          return ok<InngestApi.SendSignalResponse>({\n            runId: undefined,\n          });\n        }\n\n        // Save a clone of the response we can use to get the text of if we fail\n        // to parse the JSON.\n        const resClone = res.clone();\n\n        // JSON!\n        let json: unknown;\n        try {\n          json = await res.json();\n        } catch {\n          // res.json() failed so not a valid JSON response\n          return err({\n            error: `Failed to send signal: ${res.status} ${\n              res.statusText\n            } - ${await resClone.text()}`,\n            status: res.status,\n          });\n        }\n\n        // If we're not 2xx, something went wrong.\n        if (!res.ok) {\n          try {\n            return err(errorSchema.parse(json));\n          } catch {\n            // schema parse failed\n            return err({\n              error: `Failed to send signal: ${res.status} ${\n                res.statusText\n              } - ${await res.text()}`,\n              status: res.status,\n            });\n          }\n        }\n\n        // If we are 2xx, we should have a run_id.\n        const parseRes = sendSignalSuccessResponseSchema.safeParse(json);\n        if (!parseRes.success) {\n          return err({\n            error: `Successfully sent signal, but response parsing failed: ${\n              res.status\n            } ${res.statusText} - ${await resClone.text()}`,\n            status: res.status,\n          });\n        }\n\n        return ok({\n          runId: parseRes.data.data.run_id,\n        });\n      })\n      .catch((error) => {\n        // Catch-all if various things go wrong\n        return err({\n          error: getErrorMessage(error, \"Unknown error sending signal\"),\n          status: 500,\n        });\n      });\n  }\n\n  async getSubscriptionToken(\n    channel: string,\n    topics: string[],\n  ): Promise<string> {\n    const url = await this.getTargetUrl(\"/v1/realtime/token\");\n\n    const body = topics.map((topic) => ({\n      channel,\n      name: topic,\n      kind: \"run\",\n    }));\n\n    return fetchWithAuthFallback({\n      authToken: this.hashedKey,\n      authTokenFallback: this.hashedFallbackKey,\n      fetch: this.fetch,\n      url,\n      options: {\n        method: \"POST\",\n        body: JSON.stringify(body),\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n      },\n    })\n      .then(async (res) => {\n        if (!res.ok) {\n          throw new Error(\n            `Failed to get subscription token: ${res.status} ${\n              res.statusText\n            } - ${await res.text()}`,\n          );\n        }\n\n        const data = realtimeSubscriptionTokenSchema.parse(await res.json());\n\n        return data.jwt;\n      })\n      .catch((error) => {\n        throw new Error(\n          getErrorMessage(error, \"Unknown error getting subscription token\"),\n        );\n      });\n  }\n}\n","import { type AiAdapter, models } from \"@inngest/ai\";\nimport { z } from \"zod/v3\";\nimport { logPrefix } from \"../helpers/consts.ts\";\nimport type { Jsonify } from \"../helpers/jsonify.ts\";\nimport { timeStr } from \"../helpers/strings.ts\";\nimport * as Temporal from \"../helpers/temporal.ts\";\nimport type {\n  ExclusiveKeys,\n  ParametersExceptFirst,\n  SendEventPayload,\n  SimplifyDeep,\n  WithoutInternalStr,\n} from \"../helpers/types.ts\";\nimport {\n  type EventPayload,\n  type HashedOp,\n  type InvocationResult,\n  type InvokeTargetFunctionDefinition,\n  type MinimalEventPayload,\n  type SendEventOutput,\n  StepOpCode,\n  type StepOptions,\n  type StepOptionsOrId,\n  type TriggerEventFromFunction,\n  type TriggersFromClient,\n} from \"../types.ts\";\nimport type { InngestExecution } from \"./execution/InngestExecution.ts\";\nimport { fetch as stepFetch } from \"./Fetch.ts\";\nimport type {\n  ClientOptionsFromInngest,\n  GetEvents,\n  GetFunctionOutput,\n  GetStepTools,\n  Inngest,\n} from \"./Inngest.ts\";\nimport { InngestFunction } from \"./InngestFunction.ts\";\nimport { InngestFunctionReference } from \"./InngestFunctionReference.ts\";\n\nexport interface FoundStep extends HashedOp {\n  hashedId: string;\n  fn?: (...args: unknown[]) => unknown;\n  rawArgs: unknown[];\n\n  /**\n   * A boolean representing whether the step has been fulfilled, either\n   * resolving or rejecting the `Promise` returned to userland code.\n   *\n   * Note that this is distinct from {@link hasStepState}, which instead tracks\n   * whether the step has been given some state from the Executor. State from\n   * the Executor could be data other than a resolution or rejection, such as\n   * inputs.\n   */\n  fulfilled: boolean;\n\n  /**\n   * A boolean representing whether the step has been given some state from the\n   * Executor. State from the Executor could be data other than a resolution or\n   * rejection, such as inputs.\n   *\n   * This is distinct from {@link fulfilled}, which instead tracks whether the\n   * step has been fulfilled, either resolving or rejecting the `Promise`\n   * returned to userland code.\n   */\n  hasStepState: boolean;\n\n  handled: boolean;\n\n  /**\n   * The promise that has been returned to userland code for this step.\n   */\n  promise: Promise<unknown>;\n\n  /**\n   * Returns a boolean representing whether or not the step was handled on this\n   * invocation.\n   */\n  handle: () => boolean;\n\n  // TODO This is used to track the input we want for this step. Might be\n  // present in ctx from Executor.\n  input?: unknown;\n}\n\nexport type MatchOpFn<\n  T extends (...args: unknown[]) => Promise<unknown> = (\n    ...args: unknown[]\n  ) => Promise<unknown>,\n> = (\n  stepOptions: StepOptions,\n  /**\n   * Arguments passed by the user.\n   */\n  ...args: ParametersExceptFirst<T>\n) => Omit<HashedOp, \"data\" | \"error\">;\n\nexport type StepHandler = (info: {\n  matchOp: MatchOpFn;\n  opts?: StepToolOptions;\n  args: [StepOptionsOrId, ...unknown[]];\n}) => Promise<unknown>;\n\nexport interface StepToolOptions<\n  T extends (...args: unknown[]) => Promise<unknown> = (\n    ...args: unknown[]\n  ) => Promise<unknown>,\n> {\n  /**\n   * Optionally, we can also provide a function that will be called when\n   * Inngest tells us to run this operation.\n   *\n   * If this function is defined, the first time the tool is used it will\n   * report the desired operation (including options) to the Inngest. Inngest\n   * will then call back to the function to tell it to run the step and then\n   * retrieve data.\n   *\n   * We do this in order to allow functionality such as per-step retries; this\n   * gives the SDK the opportunity to tell Inngest what it wants to do before\n   * it does it.\n   *\n   * This function is passed the arguments passed by the user. It will be run\n   * when we receive an operation matching this one that does not contain a\n   * `data` property.\n   */\n  fn?: (...args: Parameters<T>) => unknown;\n}\n\nexport const getStepOptions = (options: StepOptionsOrId): StepOptions => {\n  if (typeof options === \"string\") {\n    return { id: options };\n  }\n\n  return options;\n};\n\n/**\n * Suffix used to namespace steps that are automatically indexed.\n */\nexport const STEP_INDEXING_SUFFIX = \":\";\n\n/**\n * Create a new set of step function tools ready to be used in a step function.\n * This function should be run and a fresh set of tools provided every time a\n * function is run.\n *\n * An op stack (function state) is passed in as well as some mutable properties\n * that the tools can use to submit a new op.\n */\nexport const createStepTools = <TClient extends Inngest.Any>(\n  client: TClient,\n  execution: InngestExecution,\n  stepHandler: StepHandler,\n) => {\n  /**\n   * A local helper used to create tools that can be used to submit an op.\n   *\n   * When using this function, a generic type should be provided which is the\n   * function signature exposed to the user.\n   */\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n  const createTool = <T extends (...args: any[]) => Promise<unknown>>(\n    /**\n     * A function that returns an ID for this op. This is used to ensure that\n     * the op stack is correctly filled, submitted, and retrieved with the same\n     * ID.\n     *\n     * It is passed the arguments passed by the user.\n     *\n     * Most simple tools will likely only need to define this.\n     */\n    matchOp: MatchOpFn<T>,\n    opts?: StepToolOptions<T>,\n  ): T => {\n    return (async (...args: Parameters<T>): Promise<unknown> => {\n      const parsedArgs = args as unknown as [StepOptionsOrId, ...unknown[]];\n      return stepHandler({ args: parsedArgs, matchOp, opts });\n    }) as T;\n  };\n\n  /**\n   * Create a new step run tool that can be used to run a step function using\n   * `step.run()` as a shim.\n   */\n  const createStepRun = (\n    /**\n     * The sub-type of this step tool, exposed via `opts.type` when the op is\n     * reported.\n     */\n    type?: string,\n  ) => {\n    return createTool<\n      // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n      <TFn extends (...args: any[]) => unknown>(\n        idOrOptions: StepOptionsOrId,\n\n        /**\n         * The function to run when this step is executed. Can be synchronous or\n         * asynchronous.\n         *\n         * The return value of this function will be the return value of this\n         * call to `run`, meaning you can return and reason about return data\n         * for next steps.\n         */\n        fn: TFn,\n\n        /**\n         * Optional input to pass to the function. If this is specified, Inngest\n         * will keep track of the input for this step and be able to display it\n         * in the UI.\n         */\n        ...input: Parameters<TFn>\n      ) => Promise<\n        /**\n         * TODO Middleware can affect this. If run input middleware has returned\n         * new step data, do not Jsonify.\n         */\n        SimplifyDeep<\n          Jsonify<\n            TFn extends (...args: Parameters<TFn>) => Promise<infer U>\n              ? Awaited<U extends void ? null : U>\n              : ReturnType<TFn> extends void\n                ? null\n                : ReturnType<TFn>\n          >\n        >\n      >\n    >(\n      ({ id, name }, _fn, ...input) => {\n        const opts: HashedOp[\"opts\"] = {\n          ...(input.length ? { input } : {}),\n          ...(type ? { type } : {}),\n        };\n\n        return {\n          id,\n          op: StepOpCode.StepPlanned,\n          name: id,\n          displayName: name ?? id,\n          ...(Object.keys(opts).length ? { opts } : {}),\n        };\n      },\n      {\n        fn: (_, fn, ...input) => fn(...input),\n      },\n    );\n  };\n\n  /**\n   * Define the set of tools the user has access to for their step functions.\n   *\n   * Each key is the function name and is expected to run `createTool` and pass\n   * a generic type for that function as it will appear in the user's code.\n   */\n  const tools = {\n    /**\n     * Send one or many events to Inngest. Should always be used in place of\n     * `inngest.send()` to ensure that the event send is successfully retried\n     * and not sent multiple times due to memoisation.\n     *\n     * @example\n     * ```ts\n     * await step.sendEvent(\"emit-user-creation\", {\n     *   name: \"app/user.created\",\n     *   data: { id: 123 },\n     * });\n     *\n     * await step.sendEvent(\"emit-user-updates\", [\n     *   {\n     *     name: \"app/user.created\",\n     *     data: { id: 123 },\n     *   },\n     *   {\n     *     name: \"app/user.feed.created\",\n     *     data: { id: 123 },\n     *   },\n     * ]);\n     * ```\n     *\n     * Returns a promise that will resolve once the event has been sent.\n     */\n    sendEvent: createTool<\n      <Payload extends SendEventPayload<GetEvents<TClient>>>(\n        idOrOptions: StepOptionsOrId,\n        payload: Payload,\n      ) => Promise<SendEventOutput<ClientOptionsFromInngest<TClient>>>\n    >(\n      ({ id, name }) => {\n        return {\n          id,\n          op: StepOpCode.StepPlanned,\n          name: \"sendEvent\",\n          displayName: name ?? id,\n          opts: {\n            type: \"step.sendEvent\",\n          },\n        };\n      },\n      {\n        fn: (_idOrOptions, payload) => {\n          return client[\"_send\"]({\n            payload,\n            headers: execution[\"options\"][\"headers\"],\n          });\n        },\n      },\n    ),\n\n    /**\n     * EXPERIMENTAL: This API is not yet stable and may change in the future\n     * without a major version bump.\n     *\n     * Wait for a particular signal to be received before continuing. When the\n     * signal is received, its data will be returned.\n     */\n    waitForSignal: createTool<\n      <TData>(\n        idOrOptions: StepOptionsOrId,\n        opts: WaitForSignalOpts,\n      ) => Promise<{ signal: string; data: Jsonify<TData> } | null>\n    >(({ id, name }, opts) => {\n      // TODO Should support Temporal.DurationLike, Temporal.InstantLike,\n      // Temporal.ZonedDateTimeLike\n      return {\n        id,\n        op: StepOpCode.WaitForSignal,\n        name: opts.signal,\n        displayName: name ?? id,\n        opts: {\n          signal: opts.signal,\n          timeout: timeStr(opts.timeout),\n          conflict: opts.onConflict,\n        },\n      };\n    }),\n\n    /**\n     * Send a Signal to Inngest.\n     */\n    sendSignal: createTool<\n      (idOrOptions: StepOptionsOrId, opts: SendSignalOpts) => Promise<null>\n    >(\n      ({ id, name }, opts) => {\n        return {\n          id,\n          op: StepOpCode.StepPlanned,\n          name: \"sendSignal\",\n          displayName: name ?? id,\n          opts: {\n            type: \"step.sendSignal\",\n            signal: opts.signal,\n          },\n        };\n      },\n      {\n        fn: (_idOrOptions, opts) => {\n          return client[\"_sendSignal\"]({\n            signal: opts.signal,\n            data: opts.data,\n            headers: execution[\"options\"][\"headers\"],\n          });\n        },\n      },\n    ),\n\n    /**\n     * Wait for a particular event to be received before continuing. When the\n     * event is received, it will be returned.\n     *\n     * You can also provide options to control the particular event that is\n     * received, for example to ensure that a user ID matches between two\n     * events, or to only wait a maximum amount of time before giving up and\n     * returning `null` instead of any event data.\n     */\n    waitForEvent: createTool<\n      <IncomingEvent extends WithoutInternalStr<TriggersFromClient<TClient>>>(\n        idOrOptions: StepOptionsOrId,\n        opts: WaitForEventOpts<GetEvents<TClient, true>, IncomingEvent>,\n      ) => Promise<\n        IncomingEvent extends WithoutInternalStr<TriggersFromClient<TClient>>\n          ? GetEvents<TClient, false>[IncomingEvent] | null\n          : IncomingEvent | null\n      >\n    >(\n      (\n        { id, name },\n\n        /**\n         * Options to control the event we're waiting for.\n         */\n        opts,\n      ) => {\n        const matchOpts: { timeout: string; if?: string } = {\n          timeout: timeStr(typeof opts === \"string\" ? opts : opts.timeout),\n        };\n\n        if (typeof opts !== \"string\") {\n          if (opts?.match) {\n            matchOpts.if = `event.${opts.match} == async.${opts.match}`;\n          } else if (opts?.if) {\n            matchOpts.if = opts.if;\n          }\n        }\n\n        return {\n          id,\n          op: StepOpCode.WaitForEvent,\n          name: opts.event,\n          opts: matchOpts,\n          displayName: name ?? id,\n        };\n      },\n    ),\n\n    /**\n     * Use this tool to run business logic. Each call to `run` will be retried\n     * individually, meaning you can compose complex workflows that safely\n     * retry dependent asynchronous actions.\n     *\n     * The function you pass to `run` will be called only when this \"step\" is to\n     * be executed and can be synchronous or asynchronous.\n     *\n     * In either case, the return value of the function will be the return value\n     * of the `run` tool, meaning you can return and reason about return data\n     * for next steps.\n     */\n    run: createStepRun(),\n\n    /**\n     * AI tooling for running AI models and other AI-related tasks.\n     */\n    ai: {\n      /**\n       * Use this tool to have Inngest make your AI calls. Useful for agentic workflows.\n       *\n       * Input is also tracked for this tool, meaning you can pass input to the\n       * function and it will be displayed and editable in the UI.\n       */\n      infer: createTool<\n        <TAdapter extends AiAdapter>(\n          idOrOptions: StepOptionsOrId,\n          options: AiInferOpts<TAdapter>,\n        ) => Promise<AiAdapter.Output<TAdapter>>\n      >(({ id, name }, options) => {\n        // eslint-disable-next-line\n        const { model, body, ...rest } = options;\n\n        const modelCopy = { ...model };\n\n        // Allow the model to mutate options and body for this call\n        options.model.onCall?.(modelCopy, options.body);\n\n        return {\n          id,\n          op: StepOpCode.AiGateway,\n          displayName: name ?? id,\n          opts: {\n            type: \"step.ai.infer\",\n            url: modelCopy.url,\n            headers: modelCopy.headers,\n            auth_key: modelCopy.authKey,\n            format: modelCopy.format,\n            // eslint-disable-next-line\n            body,\n            // eslint-disable-next-line\n            ...rest,\n          },\n        };\n      }),\n\n      /**\n       * Use this tool to wrap AI models and other AI-related tasks. Each call\n       * to `wrap` will be retried individually, meaning you can compose complex\n       * workflows that safely retry dependent asynchronous actions.\n       *\n       * Input is also tracked for this tool, meaning you can pass input to the\n       * function and it will be displayed and editable in the UI.\n       */\n      wrap: createStepRun(\"step.ai.wrap\"),\n\n      /**\n       * Models for AI inference and other AI-related tasks.\n       */\n      models: {\n        ...models,\n      },\n    },\n\n    /**\n     * Wait a specified amount of time before continuing.\n     *\n     * The time to wait can be specified using a `number` of milliseconds or an\n     * `ms`-compatible time string like `\"1 hour\"`, `\"30 mins\"`, or `\"2.5d\"`.\n     *\n     * {@link https://npm.im/ms}\n     *\n     * To wait until a particular date, use `sleepUntil` instead.\n     */\n    sleep: createTool<\n      (\n        idOrOptions: StepOptionsOrId,\n\n        /**\n         * The amount of time to wait before continuing.\n         */\n        time: number | string | Temporal.DurationLike,\n      ) => Promise<void>\n    >(({ id, name }, time) => {\n      /**\n       * The presence of this operation in the returned stack indicates that the\n       * sleep is over and we should continue execution.\n       */\n      const msTimeStr: string = timeStr(\n        Temporal.isTemporalDuration(time)\n          ? time.total({ unit: \"milliseconds\" })\n          : (time as number | string),\n      );\n\n      return {\n        id,\n        op: StepOpCode.Sleep,\n        name: msTimeStr,\n        displayName: name ?? id,\n      };\n    }),\n\n    /**\n     * Wait until a particular date before continuing by passing a `Date`.\n     *\n     * To wait for a particular amount of time from now, always use `sleep`\n     * instead.\n     */\n    sleepUntil: createTool<\n      (\n        idOrOptions: StepOptionsOrId,\n\n        /**\n         * The date to wait until before continuing.\n         */\n        time: Date | string | Temporal.InstantLike | Temporal.ZonedDateTimeLike,\n      ) => Promise<void>\n    >(({ id, name }, time) => {\n      try {\n        const iso = Temporal.getISOString(time);\n\n        /**\n         * The presence of this operation in the returned stack indicates that the\n         * sleep is over and we should continue execution.\n         */\n        return {\n          id,\n          op: StepOpCode.Sleep,\n          name: iso,\n          displayName: name ?? id,\n        };\n      } catch (err) {\n        /**\n         * If we're here, it's because the date is invalid. We'll throw a custom\n         * error here to standardise this response.\n         */\n        // TODO PrettyError\n        console.warn(\n          \"Invalid `Date`, date string, `Temporal.Instant`, or `Temporal.ZonedDateTime` passed to sleepUntil;\",\n          err,\n        );\n\n        // TODO PrettyError\n        throw new Error(\n          `Invalid \\`Date\\`, date string, \\`Temporal.Instant\\`, or \\`Temporal.ZonedDateTime\\` passed to sleepUntil: ${\n            time\n          }`,\n        );\n      }\n    }),\n\n    /**\n     * Invoke a passed Inngest `function` with the given `data`. Returns the\n     * result of the returned value of the function or `null` if the function\n     * does not return a value.\n     *\n     * A string ID can also be passed to reference functions outside of the\n     * current app.\n     */\n    invoke: createTool<\n      <TFunction extends InvokeTargetFunctionDefinition>(\n        idOrOptions: StepOptionsOrId,\n        opts: InvocationOpts<TFunction>,\n      ) => InvocationResult<GetFunctionOutput<TFunction>>\n    >(({ id, name }, invokeOpts) => {\n      // Create a discriminated union to operate on based on the input types\n      // available for this tool.\n      const optsSchema = invokePayloadSchema.extend({\n        timeout: z.union([z.number(), z.string(), z.date()]).optional(),\n      });\n\n      const parsedFnOpts = optsSchema\n        .extend({\n          _type: z.literal(\"fullId\").optional().default(\"fullId\"),\n          function: z.string().min(1),\n        })\n        .or(\n          optsSchema.extend({\n            _type: z.literal(\"fnInstance\").optional().default(\"fnInstance\"),\n            function: z.instanceof(InngestFunction),\n          }),\n        )\n        .or(\n          optsSchema.extend({\n            _type: z.literal(\"refInstance\").optional().default(\"refInstance\"),\n            function: z.instanceof(InngestFunctionReference),\n          }),\n        )\n        .safeParse(invokeOpts);\n\n      if (!parsedFnOpts.success) {\n        throw new Error(\n          `Invalid invocation options passed to invoke; must include either a function or functionId.`,\n        );\n      }\n\n      const { _type, function: fn, data, user, v, timeout } = parsedFnOpts.data;\n      const payload = { data, user, v } satisfies MinimalEventPayload;\n      const opts: {\n        payload: MinimalEventPayload;\n        function_id: string;\n        timeout?: string;\n      } = {\n        payload,\n        function_id: \"\",\n        timeout: typeof timeout === \"undefined\" ? undefined : timeStr(timeout),\n      };\n\n      switch (_type) {\n        case \"fnInstance\":\n          opts.function_id = fn.id(fn[\"client\"].id);\n          break;\n\n        case \"fullId\":\n          console.warn(\n            `${logPrefix} Invoking function with \\`function: string\\` is deprecated and will be removed in v4.0.0; use an imported function or \\`referenceFunction()\\` instead. See https://innge.st/ts-referencing-functions`,\n          );\n          opts.function_id = fn;\n          break;\n\n        case \"refInstance\":\n          opts.function_id = [fn.opts.appId || client.id, fn.opts.functionId]\n            .filter(Boolean)\n            .join(\"-\");\n          break;\n      }\n\n      return {\n        id,\n        op: StepOpCode.InvokeFunction,\n        displayName: name ?? id,\n        opts,\n      };\n    }),\n\n    /**\n     * `step.fetch` is a Fetch-API-compatible function that can be used to make\n     * any HTTP code durable if it's called within an Inngest function.\n     *\n     * It will gracefully fall back to the global `fetch` if called outside of\n     * this context, and a custom fallback can be set using the `config` method.\n     */\n    fetch: stepFetch,\n  };\n\n  // Add an uptyped gateway\n  (tools as unknown as InternalStepTools)[gatewaySymbol] = createTool(\n    ({ id, name }, input, init) => {\n      const url = input instanceof Request ? input.url : input.toString();\n\n      const headers: Record<string, string> = {};\n      if (input instanceof Request) {\n        input.headers.forEach((value, key) => {\n          headers[key] = value;\n        });\n      } else if (init?.headers) {\n        const h = new Headers(init.headers);\n        h.forEach((value, key) => {\n          headers[key] = value;\n        });\n      }\n\n      return {\n        id,\n        op: StepOpCode.Gateway,\n        displayName: name ?? id,\n        opts: {\n          url,\n          method: init?.method ?? \"GET\",\n          headers,\n          body: init?.body,\n        },\n      };\n    },\n  );\n\n  return tools;\n};\n\nexport const gatewaySymbol = Symbol.for(\"inngest.step.gateway\");\n\nexport type InternalStepTools = GetStepTools<Inngest.Any> & {\n  [gatewaySymbol]: (\n    idOrOptions: StepOptionsOrId,\n    ...args: Parameters<typeof fetch>\n  ) => Promise<{\n    status: number;\n    headers: Record<string, string>;\n    body: string;\n  }>;\n};\n\n/**\n * The event payload portion of the options for `step.invoke()`. This does not\n * include non-payload options like `timeout` or the function to invoke.\n */\nexport const invokePayloadSchema = z.object({\n  data: z.record(z.any()).optional(),\n  user: z.record(z.any()).optional(),\n  v: z.string().optional(),\n});\n\ntype InvocationTargetOpts<TFunction extends InvokeTargetFunctionDefinition> = {\n  function: TFunction;\n};\n\ntype InvocationOpts<TFunction extends InvokeTargetFunctionDefinition> =\n  InvocationTargetOpts<TFunction> &\n    Omit<TriggerEventFromFunction<TFunction>, \"id\"> & {\n      /**\n       * The step function will wait for the invocation to finish for a maximum\n       * of this time, at which point the retured promise will be rejected\n       * instead of resolved with the output of the invoked function.\n       *\n       * Note that the invoked function will continue to run even if this step\n       * times out.\n       *\n       * The time to wait can be specified using a `number` of milliseconds, an\n       * `ms`-compatible time string like `\"1 hour\"`, `\"30 mins\"`, or `\"2.5d\"`,\n       * or a `Date` object.\n       *\n       * {@link https://npm.im/ms}\n       */\n      timeout?: number | string | Date;\n    };\n\n/**\n * A set of parameters given to a `sendSignal` call.\n */\ntype SendSignalOpts = {\n  /**\n   * The signal to send.\n   */\n  signal: string;\n\n  /**\n   * The data to send with the signal.\n   */\n  data?: unknown;\n};\n\n/**\n * A set of parameters given to a `waitForSignal` call.\n */\ntype WaitForSignalOpts = {\n  /**\n   * The signal to wait for.\n   */\n  signal: string;\n\n  /**\n   * The step function will wait for the signal for a maximum of this time, at\n   * which point the signal will be returned as `null` instead of any signal\n   * data.\n   *\n   * The time to wait can be specified using a `number` of milliseconds, an\n   * `ms`-compatible time string like `\"1 hour\"`, `\"30 mins\"`, or `\"2.5d\"`, or\n   * a `Date` object.\n   *\n   * {@link https://npm.im/ms}\n   */\n  timeout: number | string | Date;\n\n  /**\n   * When this `step.waitForSignal()` call is made, choose whether an existing\n   * wait for the same signal should be replaced, or whether this run should\n   * fail.\n   *\n   * `\"replace\"` will replace any existing wait with this one, and the existing\n   * wait will remain pending until it reaches its timeout.\n   *\n   * `\"fail\"` will cause this run to fail if there is already a wait for the\n   * same signal.\n   */\n  onConflict: \"replace\" | \"fail\";\n};\n\n/**\n * A set of optional parameters given to a `waitForEvent` call to control how\n * the event is handled.\n */\ntype WaitForEventOpts<\n  Events extends Record<string, EventPayload>,\n  IncomingEvent extends keyof Events,\n> = {\n  event: IncomingEvent;\n\n  /**\n   * The step function will wait for the event for a maximum of this time, at\n   * which point the event will be returned as `null` instead of any event data.\n   *\n   * The time to wait can be specified using a `number` of milliseconds, an\n   * `ms`-compatible time string like `\"1 hour\"`, `\"30 mins\"`, or `\"2.5d\"`, or\n   * a `Date` object.\n   *\n   * {@link https://npm.im/ms}\n   */\n  timeout: number | string | Date;\n} & ExclusiveKeys<\n  {\n    /**\n     * If provided, the step function will wait for the incoming event to match\n     * particular criteria. If the event does not match, it will be ignored and\n     * the step function will wait for another event.\n     *\n     * It must be a string of a dot-notation field name within both events to\n     * compare, e.g. `\"data.id\"` or `\"user.email\"`.\n     *\n     * ```\n     * // Wait for an event where the `user.email` field matches\n     * match: \"user.email\"\n     * ```\n     *\n     * All of these are helpers for the `if` option, which allows you to specify\n     * a custom condition to check. This can be useful if you need to compare\n     * multiple fields or use a more complex condition.\n     *\n     * See the Inngest expressions docs for more information.\n     *\n     * {@link https://www.inngest.com/docs/functions/expressions}\n     *\n     * @deprecated Use `if` instead.\n     */\n    match?: string;\n\n    /**\n     * If provided, the step function will wait for the incoming event to match\n     * the given condition. If the event does not match, it will be ignored and\n     * the step function will wait for another event.\n     *\n     * The condition is a string of Google's Common Expression Language. For most\n     * simple cases, you might prefer to use `match` instead.\n     *\n     * See the Inngest expressions docs for more information.\n     *\n     * {@link https://www.inngest.com/docs/functions/expressions}\n     */\n    if?: string;\n  },\n  \"match\",\n  \"if\"\n>;\n\n/**\n * Options for `step.ai.infer()`.\n */\ntype AiInferOpts<TModel extends AiAdapter> = {\n  /**\n   * The model to use for the inference. Create a model by importing from\n   * `\"inngest\"` or by using `step.ai.models.*`.\n   *\n   * @example Import `openai()`\n   * ```ts\n   * import { openai } from \"inngest\";\n   *\n   * const model = openai({ model: \"gpt-4\" });\n   * ```\n   *\n   * @example Use a model from `step.ai.models`\n   * ```ts\n   * async ({ step }) => {\n   *            const model = step.ai.models.openai({ model: \"gpt-4\" });\n   * }\n   * ```\n   */\n  model: TModel;\n\n  /**\n   * The input to pass to the model.\n   */\n  body: AiAdapter.Input<TModel>;\n};\n","import { ZodError, z } from \"zod/v3\";\nimport type { InngestApi } from \"../api/api.ts\";\nimport { stepsSchemas } from \"../api/schema.ts\";\nimport { PREFERRED_EXECUTION_VERSION } from \"../components/execution/InngestExecution.ts\";\nimport { err, ok, type Result } from \"../types.ts\";\nimport { ExecutionVersion } from \"./consts.ts\";\nimport { prettyError } from \"./errors.ts\";\nimport type { Await } from \"./types.ts\";\n\n/**\n * Wraps a function with a cache. When the returned function is run, it will\n * cache the result and return it on subsequent calls.\n */\n// biome-ignore lint/suspicious/noExplicitAny: <explanation>\nexport const cacheFn = <T extends (...args: any[]) => any>(fn: T): T => {\n  const key = \"value\";\n  const cache = new Map<typeof key, unknown>();\n\n  return ((...args) => {\n    if (!cache.has(key)) {\n      cache.set(key, fn(...args));\n    }\n\n    return cache.get(key);\n  }) as T;\n};\n\n/**\n * Given an array of functions, return a new function that will run each\n * function in series and return the result of the final function. Regardless of\n * if the functions are synchronous or asynchronous, they'll be made into an\n * async promise chain.\n *\n * If an error is thrown, the waterfall will stop and return the error.\n *\n * Because this needs to support both sync and async functions, it only allows\n * functions that accept a single argument.\n */\n// biome-ignore lint/suspicious/noExplicitAny: <explanation>\nexport const waterfall = <TFns extends ((arg?: any) => any)[]>(\n  fns: TFns,\n\n  /**\n   * A function that transforms the result of each function in the waterfall,\n   * ready for the next function.\n   *\n   * Will not be called on the final function.\n   */\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n  transform?: (prev: any, output: any) => any,\n): ((...args: Parameters<TFns[number]>) => Promise<Await<TFns[number]>>) => {\n  return (...args) => {\n    const chain = fns.reduce(async (acc, fn) => {\n      const prev = await acc;\n      const output = (await fn(prev)) as Promise<Await<TFns[number]>>;\n\n      if (transform) {\n        return await transform(prev, output);\n      }\n\n      if (typeof output === \"undefined\") {\n        return prev;\n      }\n\n      return output;\n    }, Promise.resolve(args[0]));\n\n    return chain;\n  };\n};\n\n/**\n * Given a value `v`, return `v` if it's not undefined, otherwise return `null`.\n */\nexport const undefinedToNull = (v: unknown) => {\n  const isUndefined = typeof v === \"undefined\";\n  return isUndefined ? null : v;\n};\n\nconst fnDataVersionSchema = z.object({\n  version: z\n    .literal(-1)\n    .or(z.literal(0))\n    .or(z.literal(1))\n    .or(z.literal(2))\n    .optional()\n    .transform<ExecutionVersion>((v) => {\n      if (typeof v === \"undefined\") {\n        console.debug(\n          `No request version specified by executor; defaulting to v${PREFERRED_EXECUTION_VERSION}`,\n        );\n\n        return PREFERRED_EXECUTION_VERSION;\n      }\n\n      return v === -1 ? PREFERRED_EXECUTION_VERSION : v;\n    }),\n});\n\nexport const parseFnData = (data: unknown) => {\n  let version: ExecutionVersion;\n\n  try {\n    ({ version } = fnDataVersionSchema.parse(data));\n\n    const versionHandlers = {\n      [ExecutionVersion.V0]: () =>\n        ({\n          version: ExecutionVersion.V0,\n          ...z\n            .object({\n              event: z.record(z.any()),\n              events: z.array(z.record(z.any())).default([]),\n              steps: stepsSchemas[ExecutionVersion.V0],\n              ctx: z\n                .object({\n                  run_id: z.string(),\n                  attempt: z.number().default(0),\n                  stack: z\n                    .object({\n                      stack: z\n                        .array(z.string())\n                        .nullable()\n                        .transform((v) => (Array.isArray(v) ? v : [])),\n                      current: z.number(),\n                    })\n                    .passthrough()\n                    .optional()\n                    .nullable(),\n                })\n                .optional()\n                .nullable(),\n              use_api: z.boolean().default(false),\n            })\n            .parse(data),\n        }) as const,\n\n      [ExecutionVersion.V1]: () =>\n        ({\n          version: ExecutionVersion.V1,\n          ...z\n            .object({\n              event: z.record(z.any()),\n              events: z.array(z.record(z.any())).default([]),\n              steps: stepsSchemas[ExecutionVersion.V1],\n              ctx: z\n                .object({\n                  run_id: z.string(),\n                  attempt: z.number().default(0),\n                  max_attempts: z.number().optional(),\n                  disable_immediate_execution: z.boolean().default(false),\n                  use_api: z.boolean().default(false),\n                  stack: z\n                    .object({\n                      stack: z\n                        .array(z.string())\n                        .nullable()\n                        .transform((v) => (Array.isArray(v) ? v : [])),\n                      current: z.number(),\n                    })\n                    .passthrough()\n                    .optional()\n                    .nullable(),\n                })\n                .optional()\n                .nullable(),\n            })\n            .parse(data),\n        }) as const,\n\n      [ExecutionVersion.V2]: () =>\n        ({\n          version: ExecutionVersion.V2,\n          ...z\n            .object({\n              event: z.record(z.any()),\n              events: z.array(z.record(z.any())).default([]),\n              steps: stepsSchemas[ExecutionVersion.V2],\n              ctx: z\n                .object({\n                  run_id: z.string(),\n                  attempt: z.number().default(0),\n                  max_attempts: z.number().optional(),\n                  disable_immediate_execution: z.boolean().default(false),\n                  use_api: z.boolean().default(false),\n                  stack: z\n                    .object({\n                      stack: z\n                        .array(z.string())\n                        .nullable()\n                        .transform((v) => (Array.isArray(v) ? v : [])),\n                      current: z.number(),\n                    })\n                    .passthrough()\n                    .optional()\n                    .nullable(),\n                })\n                .optional()\n                .nullable(),\n            })\n            .parse(data),\n        }) as const,\n    } satisfies Record<ExecutionVersion, () => unknown>;\n\n    return versionHandlers[version]();\n  } catch (err) {\n    throw new Error(parseFailureErr(err));\n  }\n};\nexport type FnData = ReturnType<typeof parseFnData>;\n\ntype ParseErr = string;\nexport const fetchAllFnData = async ({\n  data,\n  api,\n  version,\n}: {\n  data: FnData;\n  api: InngestApi;\n  version: ExecutionVersion;\n}): Promise<Result<FnData, ParseErr>> => {\n  const result = { ...data };\n\n  try {\n    if (\n      (result.version === ExecutionVersion.V0 && result.use_api) ||\n      (result.version === ExecutionVersion.V1 && result.ctx?.use_api)\n    ) {\n      if (!result.ctx?.run_id) {\n        return err(\n          prettyError({\n            whatHappened: \"failed to attempt retrieving data from API\",\n            consequences: \"function execution can't continue\",\n            why: \"run_id is missing from context\",\n            stack: true,\n          }),\n        );\n      }\n\n      const [evtResp, stepResp] = await Promise.all([\n        api.getRunBatch(result.ctx.run_id),\n        api.getRunSteps(result.ctx.run_id, version),\n      ]);\n\n      if (evtResp.ok) {\n        result.events = evtResp.value;\n      } else {\n        return err(\n          prettyError({\n            whatHappened: \"failed to retrieve list of events\",\n            consequences: \"function execution can't continue\",\n            why: evtResp.error?.error,\n            stack: true,\n          }),\n        );\n      }\n\n      if (stepResp.ok) {\n        result.steps = stepResp.value;\n      } else {\n        return err(\n          prettyError({\n            whatHappened: \"failed to retrieve steps for function run\",\n            consequences: \"function execution can't continue\",\n            why: stepResp.error?.error,\n            stack: true,\n          }),\n        );\n      }\n    }\n\n    return ok(result);\n  } catch (error) {\n    // print it out for now.\n    // move to something like protobuf so we don't have to deal with this\n    console.error(error);\n\n    return err(parseFailureErr(error));\n  }\n};\n\nconst parseFailureErr = (err: unknown) => {\n  let why: string | undefined;\n  if (err instanceof ZodError) {\n    why = err.toString();\n  }\n\n  return prettyError({\n    whatHappened: \"Failed to parse data from executor.\",\n    consequences: \"Function execution can't continue.\",\n    toFixNow:\n      \"Make sure that your API is set up to parse incoming request bodies as JSON, like body-parser for Express (https://expressjs.com/en/resources/middleware/body-parser.html).\",\n    stack: true,\n    why,\n  });\n};\n","import { deserializeError } from \"../helpers/errors.ts\";\nimport { jsonErrorSchema } from \"../types.ts\";\n\n/**\n * An error that represents a step exhausting all retries and failing. This is\n * thrown by an Inngest step if it fails.\n *\n * It's synonymous with an `Error`, with the addition of the `stepId` that\n * failed.\n *\n * @public\n */\nexport class StepError extends Error {\n  public override cause?: unknown;\n\n  constructor(\n    /**\n     * The ID of the step that failed.\n     */\n    public readonly stepId: string,\n    err: unknown,\n  ) {\n    const parsedErr = jsonErrorSchema.parse(err);\n\n    super(parsedErr.message);\n    this.name = parsedErr.name;\n    this.stepId = stepId;\n\n    // Don't show the internal stack trace if we don't have one.\n    this.stack = parsedErr.stack ?? undefined;\n\n    // Try setting the cause if we have one\n    this.cause = parsedErr.cause\n      ? deserializeError(parsedErr.cause, true)\n      : undefined;\n  }\n}\n","import type { IsAny, Simplify } from \"../helpers/types.ts\";\nimport type {\n  ResolveSchema,\n  ValidSchemaInput,\n  ValidSchemaOutput,\n} from \"../helpers/validators/index.ts\";\nimport type {\n  MinimalEventPayload,\n  PayloadForAnyInngestFunction,\n} from \"../types.ts\";\nimport type { GetFunctionOutput } from \"./Inngest.ts\";\nimport type { InngestFunction } from \"./InngestFunction.ts\";\n\n/**\n * A reference to an `InngestFunction` that can be used to represent both local\n * and remote functions without pulling in the full function definition (i.e.\n * dependencies).\n *\n * These references can be invoked in the same manner as a regular\n * `InngestFunction`.\n *\n * To create a reference function, use the {@link referenceFunction} helper.\n *\n * @public\n */\nexport class InngestFunctionReference<\n  /**\n   * The payload expected by the referenced function.\n   *\n   * Must be in the shape of an event payload.\n   */\n  _TInput extends MinimalEventPayload,\n  /**\n   * The output of the referenced function.\n   */\n  _TOutput,\n> {\n  get [Symbol.toStringTag](): typeof InngestFunctionReference.Tag {\n    return InngestFunctionReference.Tag;\n  }\n\n  constructor(public readonly opts: { functionId: string; appId?: string }) {}\n}\n\n/**\n * Create a reference to an `InngestFunction` that can be used to represent both\n * local and remote functions without pulling in the full function definition\n * (i.e. dependencies).\n *\n * These references can be invoked in the same manner as a regular\n * `InngestFunction`.\n *\n * @public\n */\nexport const referenceFunction = <\n  TArgs extends InngestFunctionReference.HelperGenericArgs<TFnInput, TFnOutput>,\n  TFnInput extends ValidSchemaInput = ValidSchemaInput,\n  TFnOutput extends ValidSchemaOutput = ValidSchemaOutput,\n>({\n  functionId,\n  appId,\n}: TArgs extends InngestFunction.Any\n  ? // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n    Omit<InngestFunctionReference.HelperArgs<any, any>, \"schemas\">\n  : TArgs): InngestFunctionReference.HelperReturn<TArgs> => {\n  return new InngestFunctionReference({\n    functionId,\n    appId,\n  }) as InngestFunctionReference.HelperReturn<TArgs>;\n};\n\n/**\n * A reference to an `InngestFunction` that can be used to represent both local\n * and remote functions without pulling in the full function definition (i.e.\n * dependencies).\n *\n * These references can be invoked in the same manner as a regular\n * `InngestFunction`.\n *\n * To create a reference function, use the {@link referenceFunction} helper.\n *\n * @public\n */\nexport namespace InngestFunctionReference {\n  export const Tag = \"Inngest.FunctionReference\" as const;\n\n  /**\n   * Represents any `InngestFunctionReference`.\n   *\n   * @public\n   */\n  export type Any = InngestFunctionReference<\n    MinimalEventPayload,\n    // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n    any\n  >;\n\n  export interface Like {\n    readonly [Symbol.toStringTag]: typeof InngestFunctionReference.Tag;\n  }\n\n  /**\n   * Arguments used by {@link referenceFunction} to create a reference to an\n   * `InngestFunction`.\n   *\n   * @public\n   */\n  export type HelperArgs<TFnInput, TFnOutput> = {\n    /**\n     * The ID of the function to reference. This can be either a local function\n     * ID or the ID of a function that exists in another app.\n     *\n     * If the latter, `appId` must also be provided. If `appId` is not provided,\n     * the function ID will be assumed to be a local function ID (the app ID of\n     * the calling app will be used).\n     */\n    functionId: string;\n\n    /**\n     * The ID of the app that the function belongs to. This is only required if\n     * the function being referenced exists in another app.\n     */\n    appId?: string;\n\n    /**\n     * The schemas of the referenced function, providing typing to the input\n     * `data` and `return` of invoking the referenced function.\n     *\n     * If not provided and a local function type is not being passed as a\n     * generic into {@link referenceFunction}, the schemas will be inferred as\n     * `unknown`.\n     */\n    schemas?: {\n      data?: TFnInput;\n      return?: TFnOutput;\n    };\n  };\n\n  /**\n   * A helper type that allows the passing of either `HelperArgs` or\n   * `InngestFunction.Any` to the {@link referenceFunction} generic in place of\n   * inferring options.\n   *\n   * This is used along with defaults to allow a generic to be passed by the\n   * user and still infer the correct types for other arguments being passed in.\n   *\n   * @public\n   */\n  export type HelperGenericArgs<TFnInput, TFnOutput> =\n    | HelperArgs<TFnInput, TFnOutput>\n    | InngestFunction.Any;\n\n  /**\n   * Given a set of `InngestFunctionReference.ConstructorArgs`, return an\n   * `InngestFunctionReference`. Also handles the manual passing of\n   * `InngestFunction.Any` to the {@link referenceFunction} generic in place\n   * of inferring options.\n   *\n   * @public\n   */\n  export type HelperReturn<TArgs> = TArgs extends InngestFunction.Any\n    ? InngestFunctionReference<\n        PayloadForAnyInngestFunction<TArgs>,\n        GetFunctionOutput<TArgs>\n      >\n    : TArgs extends HelperArgs<infer TFnInput, infer TFnOutput>\n      ? InngestFunctionReference<\n          // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n          IsAny<ResolveSchema<TFnInput, TFnInput, any>> extends true\n            ? MinimalEventPayload\n            : Simplify<\n                // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n                MinimalEventPayload<ResolveSchema<TFnInput, TFnInput, any>> &\n                  Required<\n                    Pick<\n                      MinimalEventPayload<\n                        // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n                        ResolveSchema<TFnInput, TFnInput, any>\n                      >,\n                      \"data\"\n                    >\n                  >\n              >,\n          ResolveSchema<TFnOutput, TFnOutput, unknown>\n        >\n      : never;\n}\n","import ms from \"ms\";\n\n/**\n * An error that, when thrown, indicates to Inngest that the function should be\n * retried after a given amount of time.\n *\n * A `message` must be provided, as well as a `retryAfter` parameter, which can\n * be a `number` of milliseconds, an `ms`-compatible time string, or a `Date`.\n *\n * An optional `cause` can be provided to provide more context to the error.\n *\n * @public\n */\nexport class RetryAfterError extends Error {\n  /**\n   * The underlying cause of the error, if any.\n   *\n   * This will be serialized and sent to Inngest.\n   */\n  public override readonly cause?: unknown;\n\n  /**\n   * The time after which the function should be retried. Represents either a\n   * number of milliseconds or a RFC3339 date.\n   */\n  public readonly retryAfter: string;\n\n  constructor(\n    message: string,\n\n    /**\n     * The time after which the function should be retried. Represents either a\n     * number of milliseconds or a RFC3339 date.\n     */\n    retryAfter: number | string | Date,\n\n    options?: {\n      /**\n       * The underlying cause of the error, if any.\n       *\n       * This will be serialized and sent to Inngest.\n       */\n      cause?: unknown;\n    },\n  ) {\n    super(message);\n\n    if (retryAfter instanceof Date) {\n      this.retryAfter = retryAfter.toISOString();\n    } else {\n      const seconds = `${Math.ceil(\n        (typeof retryAfter === \"string\"\n          ? ms(retryAfter as `${number}`)\n          : retryAfter) / 1000,\n      )}`;\n\n      if (!isFinite(Number(seconds))) {\n        throw new Error(\n          \"retryAfter must be a number of milliseconds, a ms-compatible string, or a Date\",\n        );\n      }\n\n      this.retryAfter = seconds;\n    }\n\n    this.cause = options?.cause;\n  }\n}\n","// This file exists to help normalize process.env amongst the backend\n// and frontend.  Many frontends (eg. Next, CRA) utilize webpack's DefinePlugin\n// along with prefixes, meaning we have to explicitly use the full `process.env.FOO`\n// string in order to read variables.\n\nimport type { Inngest } from \"../components/Inngest.ts\";\nimport type { SupportedFrameworkName } from \"../types.ts\";\nimport { version } from \"../version.ts\";\nimport { defaultDevServerHost, envKeys, headerKeys } from \"./consts.ts\";\nimport { stringifyUnknown } from \"./strings.ts\";\n\n/**\n * @public\n */\nexport type Env = Record<string, EnvValue>;\n\n/**\n * @public\n */\nexport type EnvValue = string | undefined;\n\n/**\n * devServerHost returns the dev server host by searching for the INNGEST_DEVSERVER_URL\n * environment variable (plus project prefixces for eg. react, such as REACT_APP_INNGEST_DEVSERVER_URL).\n *\n * If not found this returns undefined, indicating that the env var has not been set.\n *\n * @example devServerHost()\n */\nexport const devServerHost = (env: Env = allProcessEnv()): EnvValue => {\n  // devServerKeys are the env keys we search for to discover the dev server\n  // URL.  This includes the standard key first, then includes prefixed keys\n  // for use within common frameworks (eg. CRA, next).\n  //\n  // We have to fully write these using process.env as they're typically\n  // processed using webpack's DefinePlugin, which is dumb and does a straight\n  // text replacement instead of actually understanding the AST, despite webpack\n  // being fully capable of understanding the AST.\n  const prefixes = [\"REACT_APP_\", \"NEXT_PUBLIC_\"];\n  const keys = [envKeys.InngestBaseUrl, envKeys.InngestDevMode];\n\n  const values = keys.flatMap((key) => {\n    return prefixes.map((prefix) => {\n      return env[prefix + key];\n    });\n  });\n\n  return values.find((v) => {\n    if (!v) {\n      return;\n    }\n\n    try {\n      return Boolean(new URL(v));\n    } catch {\n      // no-op\n    }\n\n    return;\n  });\n};\n\nconst checkFns = (<\n  T extends Record<string, (actual: EnvValue, expected: EnvValue) => boolean>,\n>(\n  checks: T,\n): T => checks)({\n  equals: (actual, expected) => actual === expected,\n  \"starts with\": (actual, expected) =>\n    expected ? (actual?.startsWith(expected) ?? false) : false,\n  \"is truthy\": (actual) => Boolean(actual),\n  \"is truthy but not\": (actual, expected) =>\n    Boolean(actual) && actual !== expected,\n});\n\nconst prodChecks: [\n  key: string,\n  customCheck: keyof typeof checkFns,\n  value?: string,\n][] = [\n  [\"CF_PAGES\", \"equals\", \"1\"],\n  [\"CONTEXT\", \"starts with\", \"prod\"],\n  [\"ENVIRONMENT\", \"starts with\", \"prod\"],\n  [\"NODE_ENV\", \"starts with\", \"prod\"],\n  [\"VERCEL_ENV\", \"starts with\", \"prod\"],\n  [\"DENO_DEPLOYMENT_ID\", \"is truthy\"],\n  [envKeys.VercelEnvKey, \"is truthy but not\", \"development\"],\n  [envKeys.IsNetlify, \"is truthy\"],\n  [envKeys.IsRender, \"is truthy\"],\n  [envKeys.RailwayBranch, \"is truthy\"],\n  [envKeys.IsCloudflarePages, \"is truthy\"],\n];\n\ninterface IsProdOptions {\n  /**\n   * The optional environment variables to use instead of `process.env`.\n   */\n  env?: Record<string, EnvValue>;\n\n  /**\n   * The Inngest client that's being used when performing this check. This is\n   * used to check if the client has an explicit mode set, and if so, to use\n   * that mode instead of inferring it from the environment.\n   */\n  client?: Inngest.Any;\n\n  /**\n   * If specified as a `boolean`, this will be returned as the result of the\n   * function. Useful for options that may or may not be set by users.\n   */\n  explicitMode?: Mode[\"type\"];\n}\n\nexport interface ModeOptions {\n  type: \"cloud\" | \"dev\";\n\n  /**\n   * Whether the mode was explicitly set, or inferred from other sources.\n   */\n  isExplicit: boolean;\n\n  /**\n   * If the mode was explicitly set as a dev URL, this is the URL that was set.\n   */\n  explicitDevUrl?: URL;\n\n  /**\n   * Environment variables to use when determining the mode.\n   */\n  env?: Env;\n}\n\nexport class Mode {\n  public readonly type: \"cloud\" | \"dev\";\n\n  /**\n   * Whether the mode was explicitly set, or inferred from other sources.\n   */\n  public readonly isExplicit: boolean;\n\n  public readonly explicitDevUrl?: URL;\n\n  // biome-ignore lint/correctness/noUnusedPrivateClassMembers: used in the SDK\n  private readonly env: Env;\n\n  constructor({\n    type,\n    isExplicit,\n    explicitDevUrl,\n    env = allProcessEnv(),\n  }: ModeOptions) {\n    this.env = env;\n    this.type = type;\n    this.isExplicit = isExplicit || Boolean(explicitDevUrl);\n    this.explicitDevUrl = explicitDevUrl;\n  }\n\n  public get isDev(): boolean {\n    return this.type === \"dev\";\n  }\n\n  public get isCloud(): boolean {\n    return this.type === \"cloud\";\n  }\n\n  public get isInferred(): boolean {\n    return !this.isExplicit;\n  }\n\n  /**\n   * If we are explicitly in a particular mode, retrieve the URL that we are\n   * sure we should be using, not considering any environment variables or other\n   * influences.\n   */\n  public getExplicitUrl(defaultCloudUrl: string): string | undefined {\n    if (!this.isExplicit) {\n      return undefined;\n    }\n\n    if (this.explicitDevUrl) {\n      return this.explicitDevUrl.href;\n    }\n\n    if (this.isCloud) {\n      return defaultCloudUrl;\n    }\n\n    if (this.isDev) {\n      return defaultDevServerHost;\n    }\n\n    return undefined;\n  }\n}\n\n/**\n * Returns the mode of the current environment, based off of either passed\n * environment variables or `process.env`, or explicit settings.\n */\nexport const getMode = ({\n  env = allProcessEnv(),\n  client,\n  explicitMode,\n}: IsProdOptions = {}): Mode => {\n  if (explicitMode) {\n    return new Mode({ type: explicitMode, isExplicit: true, env });\n  }\n\n  if (client?.[\"mode\"].isExplicit) {\n    return client[\"mode\"];\n  }\n\n  if (envKeys.InngestDevMode in env) {\n    if (typeof env[envKeys.InngestDevMode] === \"string\") {\n      try {\n        const explicitDevUrl = new URL(env[envKeys.InngestDevMode]);\n        return new Mode({ type: \"dev\", isExplicit: true, explicitDevUrl, env });\n      } catch {\n        // no-op\n      }\n    }\n\n    const envIsDev = parseAsBoolean(env[envKeys.InngestDevMode]);\n    if (typeof envIsDev === \"boolean\") {\n      return new Mode({\n        type: envIsDev ? \"dev\" : \"cloud\",\n        isExplicit: true,\n        env,\n      });\n    }\n  }\n\n  const isProd = prodChecks.some(([key, checkKey, expected]) => {\n    return checkFns[checkKey](stringifyUnknown(env[key]), expected);\n  });\n\n  return new Mode({ type: isProd ? \"cloud\" : \"dev\", isExplicit: false, env });\n};\n\n/**\n * getEnvironmentName returns the suspected branch name for this environment by\n * searching through a set of common environment variables.\n *\n * This could be used to determine if we're on a branch deploy or not, though it\n * should be noted that we don't know if this is the default branch or not.\n */\nexport const getEnvironmentName = (env: Env = allProcessEnv()): EnvValue => {\n  /**\n   * Order is important; more than one of these env vars may be set, so ensure\n   * that we check the most specific, most reliable env vars first.\n   */\n  return (\n    env[envKeys.InngestEnvironment] ||\n    env[envKeys.BranchName] ||\n    env[envKeys.VercelBranch] ||\n    env[envKeys.NetlifyBranch] ||\n    env[envKeys.CloudflarePagesBranch] ||\n    env[envKeys.RenderBranch] ||\n    env[envKeys.RailwayBranch]\n  );\n};\n\nexport const processEnv = (key: string): EnvValue => {\n  return allProcessEnv()[key];\n};\n\n/**\n * The Deno environment, which is not always available.\n */\ndeclare const Deno: {\n  env: { toObject: () => Env };\n};\n\n/**\n * The Netlify environment, which is not always available.\n */\ndeclare const Netlify: {\n  env: { toObject: () => Env };\n};\n\n/**\n * allProcessEnv returns the current process environment variables, or an empty\n * object if they cannot be read, making sure we support environments other than\n * Node such as Deno, too.\n *\n * Using this ensures we don't dangerously access `process.env` in environments\n * where it may not be defined, such as Deno or the browser.\n */\nexport const allProcessEnv = (): Env => {\n  // Node, or Node-like environments\n  try {\n    if (process.env) {\n      return process.env;\n    }\n  } catch (_err) {\n    // noop\n  }\n\n  // Deno\n  try {\n    const env = Deno.env.toObject();\n\n    if (env) {\n      return env;\n    }\n  } catch (_err) {\n    // noop\n  }\n\n  // Netlify\n  try {\n    const env = Netlify.env.toObject();\n\n    if (env) {\n      return env;\n    }\n  } catch (_err) {\n    // noop\n  }\n\n  return {};\n};\n\n/**\n * Generate a standardised set of headers based on input and environment\n * variables.\n *\n *\n */\nexport const inngestHeaders = (opts?: {\n  /**\n   * The environment variables to use instead of `process.env` or any other\n   * default source. Useful for platforms where environment variables are passed\n   * in alongside requests.\n   */\n  env?: Env;\n\n  /**\n   * The framework name to use in the `X-Inngest-Framework` header. This is not\n   * always available, hence being optional.\n   */\n  framework?: string;\n\n  /**\n   * The environment name to use in the `X-Inngest-Env` header. This is likely\n   * to be representative of the target preview environment.\n   */\n  inngestEnv?: string;\n\n  /**\n   * The Inngest client that's making the request. The client itself will\n   * generate a set of headers; specifying it here will ensure that the client's\n   * headers are included in the returned headers.\n   */\n  client?: Inngest;\n\n  /**\n   * The Inngest server we expect to be communicating with, used to ensure that\n   * various parts of a handshake are all happening with the same type of\n   * participant.\n   */\n  expectedServerKind?: string;\n\n  /**\n   * Any additional headers to include in the returned headers.\n   */\n  extras?: Record<string, string>;\n}): Record<string, string> => {\n  const sdkVersion = `inngest-js:v${version}`;\n  const headers: Record<string, string> = {\n    \"Content-Type\": \"application/json\",\n    \"User-Agent\": sdkVersion,\n    [headerKeys.SdkVersion]: sdkVersion,\n  };\n\n  if (opts?.framework) {\n    headers[headerKeys.Framework] = opts.framework;\n  }\n\n  if (opts?.expectedServerKind) {\n    headers[headerKeys.InngestExpectedServerKind] = opts.expectedServerKind;\n  }\n\n  const env = {\n    ...allProcessEnv(),\n    ...opts?.env,\n  };\n\n  const inngestEnv = opts?.inngestEnv || getEnvironmentName(env);\n  if (inngestEnv) {\n    headers[headerKeys.Environment] = inngestEnv;\n  }\n\n  const platform = getPlatformName(env);\n  if (platform) {\n    headers[headerKeys.Platform] = platform;\n  }\n\n  return {\n    ...headers,\n    ...opts?.client?.[\"headers\"],\n    ...opts?.extras,\n  };\n};\n\n/**\n * A set of checks that, given an environment, will return `true` if the current\n * environment is running on the platform with the given name.\n */\nconst platformChecks = {\n  /**\n   * Vercel Edge Functions don't have access to environment variables unless\n   * they are explicitly referenced in the top level code, but they do have a\n   * global `EdgeRuntime` variable set that we can use to detect this.\n   */\n  vercel: (env) =>\n    env[envKeys.IsVercel] === \"1\" || typeof EdgeRuntime === \"string\",\n  netlify: (env) => env[envKeys.IsNetlify] === \"true\",\n  \"cloudflare-pages\": (env) => env[envKeys.IsCloudflarePages] === \"1\",\n  render: (env) => env[envKeys.IsRender] === \"true\",\n  railway: (env) => Boolean(env[envKeys.RailwayEnvironment]),\n} satisfies Record<string, (env: Env) => boolean>;\n\ndeclare const EdgeRuntime: string | undefined;\n\n/**\n * A set of checks that, given an environment, will return `true` if the current\n * environment and platform supports streaming responses back to Inngest.\n *\n * Streaming capability is both framework and platform-based. Frameworks are\n * supported in serve handlers, and platforms are checked here.\n *\n * As such, this record declares which platforms we explicitly support for\n * streaming and is used by {@link platformSupportsStreaming}.\n */\nconst streamingChecks: Partial<\n  Record<\n    keyof typeof platformChecks,\n    (framework: SupportedFrameworkName, env: Env) => boolean\n  >\n> = {\n  /**\n   * \"Vercel supports streaming for Serverless Functions, Edge Functions, and\n   * React Server Components in Next.js projects.\"\n   *\n   * In practice, however, there are many reports of streaming not working as\n   * expected on Serverless Functions, so we resort to only allowing streaming\n   * for Edge Functions here.\n   *\n   * See {@link https://vercel.com/docs/frameworks/nextjs#streaming}\n   */\n  vercel: (_framework, _env) => typeof EdgeRuntime === \"string\",\n  \"cloudflare-pages\": () => true,\n};\n\nexport const getPlatformName = (env: Env) => {\n  return (Object.keys(platformChecks) as (keyof typeof platformChecks)[]).find(\n    (key) => {\n      return platformChecks[key](env);\n    },\n  );\n};\n\n/**\n * Returns `true` if we believe the current environment supports streaming\n * responses back to Inngest.\n *\n * We run a check directly related to the platform we believe we're running on,\n * usually based on environment variables.\n */\nexport const platformSupportsStreaming = (\n  framework: SupportedFrameworkName,\n  env: Env = allProcessEnv(),\n): boolean => {\n  return (\n    streamingChecks[getPlatformName(env) as keyof typeof streamingChecks]?.(\n      framework,\n      env,\n    ) ?? false\n  );\n};\n\n/**\n * A unique symbol used to mark a custom fetch implementation. We wrap the\n * implementations to provide some extra control when handling errors.\n */\nconst CUSTOM_FETCH_MARKER = Symbol(\"Custom fetch implementation\");\n\n/**\n * Given a potential fetch function, return the fetch function to use based on\n * this and the environment.\n */\nexport const getFetch = (givenFetch?: typeof fetch): typeof fetch => {\n  /**\n   * If we've explicitly been given a fetch function, use that.\n   */\n  if (givenFetch) {\n    if (CUSTOM_FETCH_MARKER in givenFetch) {\n      return givenFetch;\n    }\n\n    /**\n     * We wrap the given fetch function to provide some extra control when\n     * handling errors.\n     */\n    const customFetch: typeof fetch = async (...args) => {\n      try {\n        return await givenFetch(...args);\n      } catch (err) {\n        /**\n         * Capture warnings that are not simple fetch failures and highlight\n         * them for the user.\n         *\n         * We also use this opportunity to log the causing error, as code higher\n         * up the stack will likely abstract this.\n         */\n        if (\n          !(err instanceof Error) ||\n          !err.message?.startsWith(\"fetch failed\")\n        ) {\n          console.warn(\n            \"A request failed when using a custom fetch implementation; this may be a misconfiguration. Make sure that your fetch client is correctly bound to the global scope.\",\n          );\n          console.error(err);\n        }\n\n        throw err;\n      }\n    };\n\n    /**\n     * Mark the custom fetch implementation so that we can identify it later, in\n     * addition to adding some runtime properties to it to make it seem as much\n     * like the original fetch as possible.\n     */\n    Object.defineProperties(customFetch, {\n      [CUSTOM_FETCH_MARKER]: {},\n      name: { value: givenFetch.name },\n      length: { value: givenFetch.length },\n    });\n\n    return customFetch;\n  }\n\n  /**\n   * Browser or Node 18+\n   */\n  try {\n    if (typeof globalThis !== \"undefined\" && \"fetch\" in globalThis) {\n      return fetch.bind(globalThis);\n    }\n  } catch (_err) {\n    // no-op\n  }\n\n  /**\n   * Existing polyfilled fetch\n   */\n  if (typeof fetch !== \"undefined\") {\n    return fetch;\n  }\n\n  /**\n   * Environments where fetch cannot be found and must be polyfilled\n   */\n  return require(\"cross-fetch\") as typeof fetch;\n};\n\n/**\n * If `Response` isn't included in this environment, it's probably an earlier\n * Node env that isn't already polyfilling. This function returns either the\n * native `Response` or a polyfilled one.\n */\nexport const getResponse = (): typeof Response => {\n  if (typeof Response !== \"undefined\") {\n    return Response;\n  }\n\n  return require(\"cross-fetch\").Response;\n};\n\n/**\n * Given an unknown value, try to parse it as a `boolean`. Useful for parsing\n * environment variables that could be a selection of different values such as\n * `\"true\"`, `\"1\"`.\n *\n * If the value could not be confidently parsed as a `boolean` or was seen to be\n * `undefined`, this function returns `undefined`.\n */\nexport const parseAsBoolean = (value: unknown): boolean | undefined => {\n  if (typeof value === \"boolean\") {\n    return value;\n  }\n\n  if (typeof value === \"number\") {\n    return Boolean(value);\n  }\n\n  if (typeof value === \"string\") {\n    const trimmed = value.trim().toLowerCase();\n\n    if (trimmed === \"undefined\") {\n      return undefined;\n    }\n\n    if ([\"true\", \"1\"].includes(trimmed)) {\n      return true;\n    }\n\n    return false;\n  }\n\n  return undefined;\n};\n","/**\n * Internal types and schemas used throughout the Inngest SDK.\n *\n * Note that types intended to be imported and utilized in userland code will be\n * exported from the main entrypoint of the SDK, `inngest`; importing types\n * directly from this file may result in breaking changes in non-major bumps as\n * only those exported from `inngest` are considered stable.\n *\n * @module\n */\n\nimport { z } from \"zod/v3\";\nimport type { EventSchemas } from \"./components/EventSchemas.ts\";\nimport type {\n  builtInMiddleware,\n  GetEvents,\n  Inngest,\n} from \"./components/Inngest.ts\";\nimport type { InngestFunction } from \"./components/InngestFunction.ts\";\nimport type { InngestFunctionReference } from \"./components/InngestFunctionReference.ts\";\nimport type {\n  ExtendSendEventWithMiddleware,\n  InngestMiddleware,\n} from \"./components/InngestMiddleware.ts\";\nimport type { createStepTools } from \"./components/InngestStepTools.ts\";\nimport type { internalEvents } from \"./helpers/consts.ts\";\nimport type {\n  AsTuple,\n  IsEqual,\n  IsNever,\n  Public,\n  Simplify,\n  WithoutInternal,\n} from \"./helpers/types.ts\";\nimport type { Logger } from \"./middleware/logger.ts\";\n\nconst baseJsonErrorSchema = z.object({\n  name: z.string().trim().optional(),\n  error: z.string().trim().optional(),\n  message: z.string().trim().optional(),\n  stack: z.string().trim().optional(),\n});\n\nconst maybeJsonErrorSchema: z.ZodType<{\n  name: string;\n  message: string;\n  stack?: string;\n  cause?: unknown;\n}> = z.lazy(() =>\n  z.object({\n    name: z.string().trim(),\n    message: z.string().trim(),\n    stack: z.string().trim().optional(),\n    cause: z.union([maybeJsonErrorSchema, z.unknown()]).optional(),\n  }),\n);\n\nexport type JsonError = z.infer<typeof baseJsonErrorSchema> & {\n  name: string;\n  message: string;\n  cause?: unknown;\n};\n\nexport const jsonErrorSchema = baseJsonErrorSchema\n  .extend({\n    cause: z.union([maybeJsonErrorSchema, z.unknown()]).optional(),\n  })\n  .passthrough()\n  .catch({})\n  .transform((val) => {\n    return {\n      ...val,\n      name: val.name || \"Error\",\n      message: val.message || val.error || \"Unknown error\",\n      stack: val.stack,\n    };\n  }) as z.ZodType<JsonError>;\n\n/**\n * The payload for an internal Inngest event that is sent when a function fails.\n *\n * @public\n */\nexport type FailureEventPayload<P extends EventPayload = EventPayload> = {\n  name: `${internalEvents.FunctionFailed}`;\n  data: {\n    function_id: string;\n    run_id: string;\n    error: z.output<typeof jsonErrorSchema>;\n    event: P;\n  };\n};\n\n/**\n * Context arguments specific to a failure event.\n *\n * @public\n */\nexport type FailureEventArgs<P extends EventPayload = EventPayload> = {\n  /**\n   * The event data present in the payload.\n   */\n  event: FailureEventPayload<P>;\n\n  /**\n   * The final error that caused this function to exhaust all retries.\n   */\n  error: Error;\n};\n\n/**\n * The payload for an internal Inngest event that is sent when a function\n * finishes, either by completing successfully or failing.\n *\n * @public\n */\nexport type FinishedEventPayload = {\n  name: `${internalEvents.FunctionFinished}`;\n  data: {\n    function_id: string;\n    run_id: string;\n    correlation_id?: string;\n  } & (\n    | {\n        error: z.output<typeof jsonErrorSchema>;\n      }\n    | {\n        result: unknown;\n      }\n  );\n};\n\n/**\n * The payload for an internal Inngest event that is sent when a function is\n * cancelled.\n */\nexport type CancelledEventPayload = {\n  name: `${internalEvents.FunctionCancelled}`;\n  data: {\n    function_id: string;\n    run_id: string;\n    correlation_id?: string;\n  };\n};\n\n/**\n * The payload for any generic function invocation event. In practice, the event\n * data will be more specific to the function being invoked.\n *\n * @public\n */\nexport type InvokedEventPayload = Simplify<\n  Omit<EventPayload, \"name\"> & {\n    name: `${internalEvents.FunctionInvoked}`;\n  }\n>;\n\n/**\n * The payload for the event sent to a function when it is triggered by a cron.\n *\n * @public\n */\nexport type ScheduledTimerEventPayload = Simplify<\n  Omit<EventPayload, \"name\" | \"data\" | \"id\"> & {\n    name: `${internalEvents.ScheduledTimer}`;\n    data: {\n      cron: string;\n    };\n    id: string;\n  }\n>;\n\n/**\n * Unique codes for the different types of operation that can be sent to Inngest\n * from SDK step functions.\n */\nexport enum StepOpCode {\n  WaitForSignal = \"WaitForSignal\",\n\n  WaitForEvent = \"WaitForEvent\",\n\n  /**\n   * Legacy equivalent to `\"StepRun\"`. Has mixed data wrapping (e.g. `data` or\n   * `data.data` depending on SDK version), so this is phased out in favour of\n   * `\"StepRun\"`, which never wraps.\n   *\n   * Note that it is still used for v0 executions for backwards compatibility.\n   *\n   * @deprecated Only used for v0 executions; use `\"StepRun\"` instead.\n   */\n  Step = \"Step\",\n  StepRun = \"StepRun\",\n  StepError = \"StepError\",\n  StepFailed = \"StepFailed\",\n  StepPlanned = \"StepPlanned\",\n  Sleep = \"Sleep\",\n\n  /**\n   * Used to signify that the executor has requested that a step run, but we\n   * could not find that step.\n   *\n   * This is likely indicative that a step was renamed or removed from the\n   * function.\n   */\n  StepNotFound = \"StepNotFound\",\n\n  InvokeFunction = \"InvokeFunction\",\n  AiGateway = \"AIGateway\",\n  Gateway = \"Gateway\",\n}\n\n/**\n * The shape of a single operation in a step function. Used to communicate\n * desired and received operations to Inngest.\n */\nexport type Op = {\n  /**\n   * The unique code for this operation.\n   */\n  op: StepOpCode;\n\n  /**\n   * The unhashed step name for this operation. This is a legacy field that is\n   * sometimes used for critical data, like the sleep duration for\n   * `step.sleep()`.\n   *\n   * @deprecated For display name, use `displayName` instead.\n   */\n  name?: string;\n\n  /**\n   * An optional name for this step that can be used to display in the Inngest\n   * UI.\n   */\n  displayName?: string;\n\n  /**\n   * Any additional data required for this operation to send to Inngest. This\n   * is not compared when confirming that the operation was completed; use `id`\n   * for this.\n   */\n  opts?: Record<string, unknown>;\n\n  /**\n   * Any data present for this operation. If data is present, this operation is\n   * treated as completed.\n   */\n  data?: unknown;\n\n  /**\n   * An error present for this operation. If an error is present, this operation\n   * is treated as completed, but failed. When this is read from the op stack,\n   * the SDK will throw the error via a promise rejection when it is read.\n   *\n   * This allows users to handle step failures using common tools such as\n   * try/catch or `.catch()`.\n   */\n  error?: unknown;\n};\n\nexport const incomingOpSchema = z.object({\n  id: z.string().min(1),\n  data: z.any().optional(),\n  error: z.any().optional(),\n  input: z.any().optional(),\n});\n\nexport type IncomingOp = z.output<typeof incomingOpSchema>;\n\n/**\n * The shape of a step operation that is sent to an Inngest Server from an SDK.\n *\n * @public\n */\nexport type OutgoingOp = Pick<\n  HashedOp,\n  \"id\" | \"op\" | \"name\" | \"opts\" | \"data\" | \"error\" | \"displayName\"\n>;\n\n/**\n * The shape of a hashed operation in a step function. Used to communicate\n * desired and received operations to Inngest.\n */\nexport type HashedOp = Op & {\n  /**\n   * The hashed identifier for this operation, used to confirm that the\n   * operation was completed when it is received from Inngest.\n   */\n  id: string;\n};\n\n/**\n * A helper type to represent a stack of operations that will accumulate\n * throughout a step function's run.  This stack contains an object of\n * op hashes to data.\n */\nexport type OpStack = IncomingOp[];\n\n/**\n * A function that can be used to submit an operation to Inngest internally.\n */\nexport type SubmitOpFn = (op: Op) => void;\n\n/**\n * A sleep-compatible time string such as `\"1h30m15s\"` that can be sent to\n * Inngest to sleep for a given amount of time.\n *\n * This type includes an empty string too, so make sure to exclude that via\n * `Exclude<TimeStr, \"\">` if you don't want to allow empty strings.\n *\n * @public\n */\nexport type TimeStr = `${`${number}w` | \"\"}${`${number}d` | \"\"}${\n  | `${number}h`\n  | \"\"}${`${number}m` | \"\"}${`${number}s` | \"\"}`;\n\nexport type TimeStrBatch = `${`${number}s`}`;\n\n/**\n * Mutates an {@link EventPayload} `T` to include invocation events.\n */\nexport type WithInvocation<T extends EventPayload> = Simplify<\n  { name: T[\"name\"] | `${internalEvents.FunctionInvoked}` } & Omit<T, \"name\">\n>;\n\n/**\n * Makes sure that all event names are stringified and not enums or other\n * values.\n */\ntype StringifyAllEvents<T> = {\n  [K in keyof T as `${K & string}`]: Simplify<\n    Omit<T[K], \"name\"> & { name: `${K & string}` }\n  >;\n};\n\n/**\n * Given a client and a set of triggers, returns a record of all the events that\n * can be used to trigger a function. This will also include invocation events,\n * which currently could represent any of the triggers.\n */\ntype GetSelectedEvents<\n  TClient extends Inngest.Any,\n  TTriggers extends TriggersFromClient<TClient>,\n> = Pick<GetEvents<TClient, true>, TTriggers> &\n  StringifyAllEvents<{\n    // Invocation events could (currently) represent any of the payloads that\n    // could be used to trigger the function. We use a distributive `Pick` over allto\n    // ensure this is represented correctly in typing.\n    [internalEvents.FunctionInvoked]: Simplify<{\n      name: `${internalEvents.FunctionInvoked}`;\n    }> &\n      Pick<\n        Pick<GetEvents<TClient, true>, TTriggers>[keyof Pick<\n          GetEvents<TClient, true>,\n          TTriggers\n        >],\n        AssertKeysAreFrom<EventPayload, \"id\" | \"data\" | \"user\" | \"v\" | \"ts\">\n      >;\n  }>;\n\n/**\n * Returns a union of all the events that can be used to trigger a function\n * based on the given `TClient` and `TTriggers`.\n *\n * Can optionally include or exclude internal events with `TExcludeInternal`.\n */\ntype GetContextEvents<\n  TClient extends Inngest.Any,\n  TTriggers extends TriggersFromClient<TClient>,\n  TExcludeInternal extends boolean = false,\n  // TInvokeSchema extends ValidSchemaInput = never,\n> = Simplify<\n  TExcludeInternal extends true\n    ? WithoutInternal<\n        GetSelectedEvents<TClient, TTriggers>\n      >[keyof WithoutInternal<GetSelectedEvents<TClient, TTriggers>>]\n    : GetSelectedEvents<TClient, TTriggers>[keyof GetSelectedEvents<\n        TClient,\n        TTriggers\n      >]\n>;\n\n/**\n * Base context object, omitting any extras that may be added by middleware or\n * function configuration.\n *\n * @public\n */\nexport type BaseContext<\n  TClient extends Inngest.Any,\n  TTriggers extends TriggersFromClient<TClient> = TriggersFromClient<TClient>,\n> = {\n  /**\n   * The event data present in the payload.\n   */\n  event: GetContextEvents<TClient, TTriggers>;\n  events: AsTuple<GetContextEvents<TClient, TTriggers, true>>;\n\n  /**\n   * The run ID for the current function execution\n   */\n  runId: string;\n\n  step: ReturnType<typeof createStepTools<TClient>>;\n\n  /**\n   * The current zero-indexed attempt number for this function execution. The\n   * first attempt will be `0`, the second `1`, and so on. The attempt number\n   * is incremented every time the function throws an error and is retried.\n   */\n  attempt: number;\n\n  /**\n   * The maximum number of attempts allowed for this function.\n   */\n  maxAttempts?: number;\n};\n\n/**\n * Builds a context object for an Inngest handler, optionally overriding some\n * keys.\n *\n * @internal\n */\nexport type Context<\n  TClient extends Inngest.Any = Inngest.Any,\n  TTriggers extends TriggersFromClient<TClient> = TriggersFromClient<TClient>,\n  TOverrides extends Record<string, unknown> = Record<never, never>,\n> = Omit<BaseContext<TClient, TTriggers>, keyof TOverrides> & TOverrides;\n\n/**\n * Builds a context object for an Inngest handler, optionally overriding some\n * keys.\n *\n * @internal\n */\nexport namespace Context {\n  /**\n   * Represents any `Context` object, regardless of generics and inference.\n   */\n  export type Any = Context;\n}\n\n/**\n * The shape of a Inngest function, taking in event, step, ctx, and step\n * tooling.\n *\n * @public\n */\nexport type Handler<\n  TClient extends Inngest.Any,\n  TTriggers extends TriggersFromClient<TClient> = TriggersFromClient<TClient>,\n  TOverrides extends Record<string, unknown> = Record<never, never>,\n> = (\n  /**\n   * The context argument provides access to all data and tooling available to\n   * the function.\n   */\n  ctx: Context<TClient, TTriggers, TOverrides>,\n) => unknown;\n\nexport type TriggersFromClient<TClient extends Inngest.Any = Inngest.Any> =\n  keyof GetEvents<TClient, true> & string;\n\n/**\n * The shape of a Inngest function, taking in event, step, ctx, and step\n * tooling.\n *\n * @public\n */\nexport namespace Handler {\n  /**\n   * Represents any `Handler`, regardless of generics and inference.\n   */\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n  export type Any = Handler<Inngest.Any, any, any>;\n}\n\n/**\n * Asserts that the given keys `U` are all present in the given object `T`.\n *\n * Used as an internal type guard to ensure that changes to keys are accounted\n * for\n */\ntype AssertKeysAreFrom<T, K extends keyof T> = K;\n\n/**\n * The shape of a single event's payload without any fields used to identify the\n * actual event being sent.\n *\n * This is used to represent an event payload when invoking a function, as the\n * event name is not known or needed.\n */\n// biome-ignore lint/suspicious/noExplicitAny: <explanation>\nexport interface MinimalEventPayload<TData = any> {\n  /**\n   * A unique id used to idempotently process a given event payload.\n   *\n   * Set this when sending events to ensure that the event is only processed\n   * once; if an event with the same ID is sent again, it will not invoke\n   * functions.\n   */\n  id?: string;\n\n  /**\n   * Any data pertinent to the event\n   */\n  data?: TData;\n\n  /**\n   * Any user data associated with the event\n   * All fields ending in \"_id\" will be used to attribute the event to a particular user\n   */\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n  user?: any;\n\n  /**\n   * A specific event schema version\n   * (optional)\n   */\n  v?: string;\n}\n\n/**\n * The shape of a single event's payload. It should be extended to enforce\n * adherence to given events and not used as a method of creating them (i.e. as\n * a generic).\n *\n * @public\n */\n// biome-ignore lint/suspicious/noExplicitAny: <explanation>\nexport interface EventPayload<TData = any> extends MinimalEventPayload<TData> {\n  /**\n   * A unique identifier for the type of event. We recommend using lowercase dot\n   * notation for names, prepending `prefixes/` with a slash for organization.\n   *\n   * e.g. `cloudwatch/alarms/triggered`, `cart/session.created`\n   */\n  name: string;\n\n  /**\n   * An integer representing the milliseconds since the unix epoch at which this\n   * event occurred.\n   *\n   * Defaults to the current time.\n   * (optional)\n   */\n  ts?: number;\n}\n\nexport const sendEventResponseSchema = z.object({\n  /**\n   * Event IDs\n   */\n  ids: z.array(z.string()).default([]),\n\n  /**\n   * HTTP Status Code. Will be undefined if no request was sent.\n   */\n  status: z.number().default(0),\n\n  /**\n   * Error message. Will be undefined if no error occurred.\n   */\n  error: z.string().optional(),\n});\n\n/**\n * The response from the Inngest Event API\n */\nexport type SendEventResponse = z.output<typeof sendEventResponseSchema>;\n\n/**\n * The response in code from sending an event to Inngest.\n *\n * @public\n */\nexport type SendEventBaseOutput = {\n  ids: SendEventResponse[\"ids\"];\n};\n\nexport type SendEventOutput<TOpts extends ClientOptions> = Omit<\n  SendEventBaseOutput,\n  keyof SendEventOutputWithMiddleware<TOpts>\n> &\n  SendEventOutputWithMiddleware<TOpts>;\n\nexport type SendEventOutputWithMiddleware<TOpts extends ClientOptions> =\n  ExtendSendEventWithMiddleware<\n    [typeof builtInMiddleware, NonNullable<TOpts[\"middleware\"]>],\n    SendEventBaseOutput\n  >;\n\n/**\n * An HTTP-like, standardised response format that allows Inngest to help\n * orchestrate steps and retries.\n *\n * @internal\n */\nexport interface Response {\n  /**\n   * A step response must contain an HTTP status code.\n   *\n   * A `2xx` response indicates success; this is not a failure and no retry is\n   * necessary.\n   *\n   * A `4xx` response indicates a bad request; this step will not be retried as\n   * it is deemed irrecoverable. Examples of this might be an event with\n   * insufficient data or concerning a user that no longer exists.\n   *\n   * A `5xx` status indicates a temporary internal error; this will be retried\n   * according to the step and function's retry policy (3 times, by default).\n   *\n   * {@link https://www.inngest.com/docs/functions/function-input-and-output#response-format}\n   * {@link https://www.inngest.com/docs/functions/retries}\n   */\n  status: number;\n\n  /**\n   * The output of the function - the `body` - can be any arbitrary\n   * JSON-compatible data. It is then usable by any future steps.\n   *\n   * {@link https://www.inngest.com/docs/functions/function-input-and-output#response-format}\n   */\n  body?: unknown;\n}\n\n/**\n * A single step within a function.\n *\n * @internal\n */\nexport type Step<TContext = unknown> = (\n  /**\n   * The context for this step, including the triggering event and any previous\n   * step output.\n   */\n  context: TContext,\n) => Promise<Response> | Response;\n\n/**\n * A set of options for configuring the Inngest client.\n *\n * @public\n */\nexport interface ClientOptions {\n  /**\n   * The ID of this instance, most commonly a reference to the application it\n   * resides in.\n   *\n   * The ID of your client should remain the same for its lifetime; if you'd\n   * like to change the name of your client as it appears in the Inngest UI,\n   * change the `name` property instead.\n   */\n  id: string;\n\n  /**\n   * Inngest event key, used to send events to Inngest Cloud. If not provided,\n   * will search for the `INNGEST_EVENT_KEY` environment variable. If neither\n   * can be found, however, a warning will be shown and any attempts to send\n   * events will throw an error.\n   */\n  eventKey?: string;\n\n  /**\n   * The base URL to use when contacting Inngest.\n   *\n   * Defaults to https://inn.gs/ for sending events and https://api.inngest.com\n   * for all other communication with Inngest.\n   */\n  baseUrl?: string;\n\n  /**\n   * If provided, will override the used `fetch` implementation. Useful for\n   * giving the library a particular implementation if accessing it is not done\n   * via globals.\n   *\n   * By default the library will try to use the native Web API fetch, falling\n   * back to a Node implementation if no global fetch can be found.\n   *\n   * If you wish to specify your own fetch, make sure that you preserve its\n   * binding, either by using `.bind` or by wrapping it in an anonymous\n   * function.\n   */\n  fetch?: typeof fetch;\n\n  /**\n   * Provide an `EventSchemas` class to type events, providing type safety when\n   * sending events and running functions via Inngest.\n   *\n   * You can provide generated Inngest types, custom types, types using Zod, or\n   * a combination of the above. See {@link EventSchemas} for more information.\n   *\n   * @example\n   *\n   * ```ts\n   * export const inngest = new Inngest({\n   *   id: \"my-app\",\n   *   schemas: new EventSchemas().fromZod({\n   *     \"app/user.created\": {\n   *       data: z.object({\n   *         id: z.string(),\n   *         name: z.string(),\n   *       }),\n   *     },\n   *   }),\n   * });\n   * ```\n   */\n  schemas?: EventSchemas<Record<string, EventPayload>>;\n\n  /**\n   * The Inngest environment to send events to. Defaults to whichever\n   * environment this client's event key is associated with.\n   *\n   * It's likely you never need to change this unless you're trying to sync\n   * multiple systems together using branch names.\n   */\n  env?: string;\n\n  /**\n   * The logger provided by the user.\n   * The user can passed in their winston, pino, and other loggers for\n   * handling log delivery to external services.\n   *\n   * The provider logger is expected to implement the following API interfaces\n   * - .info()\n   * - .warn()\n   * - .debug()\n   * - .error()\n   * which most loggers already do.\n   *\n   * Defaults to a dummy logger that just log things to the console if nothing is provided.\n   */\n  logger?: Logger;\n  middleware?: InngestMiddleware.Stack;\n\n  /**\n   * Can be used to explicitly set the client to Development Mode, which will\n   * turn off signature verification and default to using a local URL to access\n   * a local Dev Server.\n   *\n   * This is useful for forcing the client to use a local Dev Server while also\n   * running in a production-like environment.\n   */\n  isDev?: boolean;\n\n  /**\n   * The application-specific version identifier. This can be an arbitrary value\n   * such as a version string, a Git commit SHA, or any other unique identifier.\n   */\n  appVersion?: string;\n\n  /**\n   * If `true`, parallel steps within functions are optimized to reduce traffic\n   * during `Promise` resolution, which can hugely reduce the time taken and\n   * number of requests for each run.\n   *\n   * Note that this will be the default behaviour in v4 and in its current form\n   * will cause `Promise.*()` to wait for all promises to settle before\n   * resolving.\n   *\n   * @default false\n   */\n  optimizeParallelism?: boolean;\n}\n\n/**\n * A set of log levels that can be used to control the amount of logging output\n * from various parts of the Inngest library.\n *\n * @public\n */\nexport const logLevels = [\n  \"fatal\",\n  \"error\",\n  \"warn\",\n  \"info\",\n  \"debug\",\n  \"silent\",\n] as const;\n\n/**\n * A set of log levels that can be used to control the amount of logging output\n * from various parts of the Inngest library.\n *\n * @public\n */\nexport type LogLevel = (typeof logLevels)[number];\n\n/**\n * A set of options for configuring the registration of Inngest functions.\n *\n * @public\n */\nexport interface RegisterOptions {\n  /**\n   * A key used to sign requests to and from Inngest in order to prove that the\n   * source is legitimate.\n   *\n   * You must provide a signing key to communicate securely with Inngest. If\n   * your key is not provided here, we'll try to retrieve it from the\n   * `INNGEST_SIGNING_KEY` environment variable.\n   *\n   * You can retrieve your signing key from the Inngest UI inside the \"Secrets\"\n   * section at {@link https://app.inngest.com/secrets}. We highly recommend\n   * that you add this to your platform's available environment variables as\n   * `INNGEST_SIGNING_KEY`.\n   *\n   * If no key can be found, you will not be able to register your functions or\n   * receive events from Inngest.\n   */\n  signingKey?: string;\n\n  /**\n   * The same as signingKey, except used as a fallback when auth fails using the\n   * primary signing key.\n   */\n  signingKeyFallback?: string;\n\n  /**\n   * The URL used to register functions with Inngest.\n   * Defaults to https://api.inngest.com/fn/register\n   */\n  baseUrl?: string;\n\n  /**\n   * If provided, will override the used `fetch` implementation. Useful for\n   * giving the library a particular implementation if accessing it is not done\n   * via globals.\n   *\n   * By default the library will try to use the native Web API fetch, falling\n   * back to a Node implementation if no global fetch can be found.\n   */\n  fetch?: typeof fetch;\n\n  /**\n   * The path to the Inngest serve endpoint. e.g.:\n   *\n   *     \"/some/long/path/to/inngest/endpoint\"\n   *\n   * By default, the library will try to infer this using request details such\n   * as the \"Host\" header and request path, but sometimes this isn't possible\n   * (e.g. when running in a more controlled environments such as AWS Lambda or\n   * when dealing with proxies/rediects).\n   *\n   * Provide the custom path (excluding the hostname) here to ensure that the\n   * path is reported correctly when registering functions with Inngest.\n   *\n   * To also provide a custom hostname, use `serveHost`.\n   */\n  servePath?: string;\n\n  /**\n   * The host used to access the Inngest serve endpoint, e.g.:\n   *\n   *     \"https://myapp.com\"\n   *\n   * By default, the library will try to infer this using request details such\n   * as the \"Host\" header and request path, but sometimes this isn't possible\n   * (e.g. when running in a more controlled environments such as AWS Lambda or\n   * when dealing with proxies/redirects).\n   *\n   * Provide the custom hostname here to ensure that the path is reported\n   * correctly when registering functions with Inngest.\n   *\n   * To also provide a custom path, use `servePath`.\n   */\n  serveHost?: string;\n\n  /**\n   * The minimum level to log from the Inngest serve endpoint.\n   *\n   * Default level: \"info\"\n   */\n  logLevel?: LogLevel;\n\n  /**\n   * Some serverless providers (especially those with edge compute) may support\n   * streaming responses back to Inngest. This can be used to circumvent\n   * restrictive request timeouts and other limitations. It is only available if\n   * the serve handler being used supports streaming.\n   *\n   * If this is `\"allow\"`, the SDK will attempt to stream responses back to\n   * Inngest if it can confidently detect support for it by verifyng that the\n   * platform and the serve handler supports streaming.\n   *\n   * If this is `\"force\"`, the SDK will always attempt to stream responses back\n   * to Inngest regardless of whether we can detect support for it or not. This\n   * will override `allowStreaming`, but will still not attempt to stream if\n   * the serve handler does not support it.\n   *\n   * If this is `false`, streaming will never be used.\n   *\n   * Defaults to `false`.\n   */\n  streaming?: \"allow\" | \"force\" | false;\n\n  /**\n   * The ID of this app. This is used to group functions together in the Inngest\n   * UI. The ID of the passed client is used by default.\n   * @deprecated Will be removed in v4.\n   */\n  id?: string;\n}\n\n/**\n * This schema is used internally to share the shape of a concurrency option\n * when validating config. We cannot add comments to Zod fields, so we just use\n * an extra type check to ensure it matches our exported expectations.\n */\nconst concurrencyOptionSchema = z.strictObject({\n  limit: z.number(),\n  key: z.string().optional(),\n  scope: z.enum([\"fn\", \"env\", \"account\"]).optional(),\n});\n\nconst _checkConcurrencySchemaAligns: IsEqual<\n  ConcurrencyOption,\n  z.output<typeof concurrencyOptionSchema>\n> = true;\n\nexport interface ConcurrencyOption {\n  /**\n   * The concurrency limit for this option, adding a limit on how many concurrent\n   * steps can execute at once.\n   */\n  limit: number;\n\n  /**\n   * An optional concurrency key, as an expression using the common expression language\n   * (CEL).  The result of this expression is used to create new concurrency groups, or\n   * sub-queues, for each function run.\n   *\n   * The event is passed into this expression as \"event\".\n   *\n   * Examples:\n   * - `event.data.user_id`:  this evaluates to the user_id in the event.data object.\n   * - `event.data.user_id + \"-\" + event.data.account_id`: creates a new group per user/account\n   * - `\"ai\"`:  references a custom string\n   */\n  key?: string;\n\n  /**\n   * An optional scope for the concurrency group.  By default, concurrency limits are\n   * scoped to functions - one function's concurrency limits do not impact other functions.\n   *\n   * Changing this \"scope\" allows concurrency limits to work across environments (eg. production\n   * vs branch environments) or across your account (global).\n   */\n  scope?: \"fn\" | \"env\" | \"account\";\n}\n\n/**\n * Configuration for cancelling a function run based on an incoming event.\n *\n * @public\n */\nexport type Cancellation<Events extends Record<string, EventPayload>> = {\n  [K in keyof Events & string]: {\n    /**\n     * The name of the event that should cancel the function run.\n     */\n    event: K;\n\n    /**\n     * The expression that must evaluate to true in order to cancel the function run. There\n     * are two variables available in this expression:\n     * - event, referencing the original function's event trigger\n     * - async, referencing the new cancel event.\n     *\n     * @example\n     *\n     * Ensures the cancel event's data.user_id field matches the triggering event's data.user_id\n     * field:\n     *\n     * ```ts\n     * \"async.data.user_id == event.data.user_id\"\n     * ```\n     */\n    if?: string;\n\n    /**\n     * If provided, the step function will wait for the incoming event to match\n     * particular criteria. If the event does not match, it will be ignored and\n     * the step function will wait for another event.\n     *\n     * It must be a string of a dot-notation field name within both events to\n     * compare, e.g. `\"data.id\"` or `\"user.email\"`.\n     *\n     * ```\n     * // Wait for an event where the `user.email` field matches\n     * match: \"user.email\"\n     * ```\n     *\n     * All of these are helpers for the `if` option, which allows you to specify\n     * a custom condition to check. This can be useful if you need to compare\n     * multiple fields or use a more complex condition.\n     *\n     * See the Inngest expressions docs for more information.\n     *\n     * {@link https://www.inngest.com/docs/functions/expressions}\n     *\n     * @deprecated Use `if` instead.\n     */\n    match?: string;\n\n    /**\n     * An optional timeout that the cancel is valid for.  If this isn't\n     * specified, cancellation triggers are valid for up to a year or until the\n     * function ends.\n     *\n     * The time to wait can be specified using a `number` of milliseconds, an\n     * `ms`-compatible time string like `\"1 hour\"`, `\"30 mins\"`, or `\"2.5d\"`, or\n     * a `Date` object.\n     *\n     * {@link https://npm.im/ms}\n     */\n    timeout?: number | string | Date;\n  };\n}[keyof Events & string];\n\n/**\n * The response to send to Inngest when pushing function config either directly\n * or when pinged by Inngest Cloud.\n *\n * @internal\n */\nexport interface RegisterRequest {\n  /**\n   * The API handler's URL to invoke SDK based functions.\n   */\n  url: string;\n\n  /**\n   * Response version, allowing Inngest to change any top-level field.\n   */\n  v: `${number}.${number}`;\n\n  /**\n   * SDK version from `package.json` for our internal metrics and to warn users\n   * they need to upgrade.\n   */\n  sdk: `js:v${number}.${number}.${number}${\"\" | `-${string}.${number}`}`;\n\n  /**\n   * The method used to deploy these functions.\n   */\n  deployType: \"ping\";\n\n  /**\n   * The name of the framework being used for this instance, e.g. \"nextjs\",\n   * \"vercel\", \"netlify\", \"lambda\", etc. Uses the `framework` specified when\n   * creating a new `InngestCommHandler`.\n   */\n  framework: string;\n\n  /**\n   * The name of this particular app, used for grouping and easier viewing in\n   * the UI.\n   */\n  appName: string;\n\n  /**\n   * AppVersion represents an optional application version identifier. This should change\n   * whenever code within one of your Inngest function or any dependency thereof changes.\n   */\n  appVersion?: string;\n\n  /**\n   * The functions available at this particular handler.\n   */\n  functions: FunctionConfig[];\n\n  /**\n   * The deploy ID used to identify this particular deployment.\n   */\n  deployId?: string;\n\n  /**\n   * Capabilities of the SDK.\n   */\n  capabilities: Capabilities;\n}\n\nexport interface Capabilities {\n  trust_probe: \"v1\";\n  connect: \"v1\";\n}\n\nexport interface InBandRegisterRequest\n  extends Pick<\n      RegisterRequest,\n      \"capabilities\" | \"framework\" | \"functions\" | \"sdk\" | \"url\" | \"appVersion\"\n    >,\n    Pick<AuthenticatedIntrospection, \"sdk_language\" | \"sdk_version\" | \"env\"> {\n  /**\n   * The ID of the app that this handler is associated with.\n   */\n  app_id: string;\n\n  /**\n   * The result of the introspection request.\n   */\n  inspection: AuthenticatedIntrospection | UnauthenticatedIntrospection;\n\n  /**\n   * ?\n   */\n  platform?: string;\n\n  /**\n   * The person or organization that authored this SDK. Ideally this is\n   * synonymous with a GitHub username or organization name.\n   */\n  sdk_author: \"inngest\";\n}\n\n/**\n * The response to send to the local SDK UI when an introspection request is\n * made.\n *\n * @internal\n */\nexport interface UnauthenticatedIntrospection {\n  authentication_succeeded: false | null;\n  extra: {\n    is_mode_explicit: boolean;\n  };\n  function_count: number;\n  has_event_key: boolean;\n  has_signing_key: boolean;\n  mode: \"cloud\" | \"dev\";\n  schema_version: \"2024-05-24\";\n}\n\nexport interface AuthenticatedIntrospection\n  extends Omit<UnauthenticatedIntrospection, \"authentication_succeeded\"> {\n  api_origin: string;\n  app_id: string;\n  authentication_succeeded: true;\n  capabilities: Capabilities;\n  env: string | null;\n  event_api_origin: string;\n  event_key_hash: string | null;\n  extra: UnauthenticatedIntrospection[\"extra\"] & {\n    is_streaming: boolean;\n  };\n  framework: string;\n  sdk_language: string;\n  sdk_version: string;\n  serve_origin: string | null;\n  serve_path: string | null;\n  signing_key_fallback_hash: string | null;\n  signing_key_hash: string | null;\n}\n\n/**\n * The schema used to represent an individual function being synced with\n * Inngest.\n *\n * Note that this should only be used to validate the shape of a config object\n * and not used for feature compatibility, such as feature X being exclusive\n * with feature Y; these should be handled on the Inngest side.\n */\nexport const functionConfigSchema = z.strictObject({\n  name: z.string().optional(),\n  id: z.string(),\n  triggers: z.array(\n    z.union([\n      z.strictObject({\n        event: z.string(),\n        expression: z.string().optional(),\n      }),\n      z.strictObject({\n        cron: z.string(),\n      }),\n    ]),\n  ),\n  steps: z.record(\n    z.strictObject({\n      id: z.string(),\n      name: z.string(),\n      runtime: z.strictObject({\n        type: z.union([z.literal(\"http\"), z.literal(\"ws\")]),\n        url: z.string(),\n      }),\n      retries: z\n        .strictObject({\n          attempts: z.number().optional(),\n        })\n        .optional(),\n    }),\n  ),\n  idempotency: z.string().optional(),\n  batchEvents: z\n    .strictObject({\n      maxSize: z.number(),\n      timeout: z.string(),\n      key: z.string().optional(),\n      if: z.string().optional(),\n    })\n    .optional(),\n  rateLimit: z\n    .strictObject({\n      key: z.string().optional(),\n      limit: z.number(),\n      period: z.string().transform((x) => x as TimeStr),\n    })\n    .optional(),\n  throttle: z\n    .strictObject({\n      key: z.string().optional(),\n      limit: z.number(),\n      period: z.string().transform((x) => x as TimeStr),\n      burst: z.number().optional(),\n    })\n    .optional(),\n  singleton: z\n    .strictObject({\n      key: z.string().optional(),\n      mode: z.enum([\"skip\", \"cancel\"]),\n    })\n    .optional(),\n  cancel: z\n    .array(\n      z.strictObject({\n        event: z.string(),\n        if: z.string().optional(),\n        timeout: z.string().optional(),\n      }),\n    )\n    .optional(),\n  debounce: z\n    .strictObject({\n      key: z.string().optional(),\n      period: z.string().transform((x) => x as TimeStr),\n      timeout: z\n        .string()\n        .transform((x) => x as TimeStr)\n        .optional(),\n    })\n    .optional(),\n  timeouts: z\n    .strictObject({\n      start: z\n        .string()\n        .transform((x) => x as TimeStr)\n        .optional(),\n      finish: z\n        .string()\n        .transform((x) => x as TimeStr)\n        .optional(),\n    })\n    .optional(),\n  priority: z\n    .strictObject({\n      run: z.string().optional(),\n    })\n    .optional(),\n  concurrency: z\n    .union([\n      z.number(),\n      concurrencyOptionSchema.transform((x) => x as ConcurrencyOption),\n      z\n        .array(concurrencyOptionSchema.transform((x) => x as ConcurrencyOption))\n        .min(1)\n        .max(2),\n    ])\n    .optional(),\n});\n\n/**\n * The shape of an individual function being synced with Inngest.\n *\n * @internal\n */\nexport type FunctionConfig = z.output<typeof functionConfigSchema>;\n\nexport interface DevServerInfo {\n  /**\n   * The version of the dev server.\n   */\n  version: string;\n  authed: boolean;\n  startOpts: {\n    dir?: string;\n    autodiscover: boolean;\n    urls: string[];\n  };\n  functions: FunctionConfig[];\n  handlers: RegisterRequest[];\n}\n\n/**\n * Given a set of events and a user-friendly trigger paramter, returns the name\n * of the event that the user intends to listen to.\n *\n * @public\n */\nexport type EventNameFromTrigger<\n  Events extends Record<string, EventPayload>,\n  T extends InngestFunction.Trigger<keyof Events & string>,\n> = IsNever<T> extends true // `never` indicates there are no triggers, so the payload could be anything\n  ? `${internalEvents.FunctionInvoked}`\n  : T extends string // `string` indicates a migration from v2 to v3\n    ? T\n    : T extends { event: infer IEvent } // an event trigger\n      ? IEvent\n      : T extends { cron: string } // a cron trigger\n        ? `${internalEvents.ScheduledTimer}`\n        : never;\n\n/**\n * A union to represent known names of supported frameworks that we can use\n * internally to assess functionality based on a mix of framework and platform.\n */\nexport type SupportedFrameworkName =\n  | \"astro\"\n  | \"bun\"\n  | \"cloudflare-pages\"\n  | \"digitalocean\"\n  | \"edge\"\n  | \"express\"\n  | \"aws-lambda\"\n  | \"nextjs\"\n  | \"nodejs\"\n  | \"nuxt\"\n  | \"h3\"\n  | \"redwoodjs\"\n  | \"remix\"\n  | \"deno/fresh\"\n  | \"sveltekit\"\n  | \"fastify\"\n  | \"koa\"\n  | \"hono\"\n  | \"nitro\";\n\n/**\n * A set of options that can be passed to any step to configure it.\n *\n * @public\n */\nexport interface StepOptions {\n  /**\n   * The ID to use to memoize the result of this step, ensuring it is run only\n   * once. Changing this ID in an existing function will cause the step to be\n   * run again for in-progress runs; it is recommended to use a stable ID.\n   */\n  id: string;\n\n  /**\n   * The display name to use for this step in the Inngest UI. This can be\n   * changed at any time without affecting the step's behaviour.\n   */\n  name?: string;\n}\n\n/**\n * Either a step ID or a set of step options.\n *\n * @public\n */\nexport type StepOptionsOrId = StepOptions[\"id\"] | StepOptions;\n\nexport type EventsFromFunction<T extends InngestFunction.Any> =\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n  T extends InngestFunction<any, any, any, infer IClient, any, any>\n    ? GetEvents<IClient, true>\n    : never;\n\n/**\n * A function that can be invoked by Inngest.\n *\n * @public\n */\nexport type InvokeTargetFunctionDefinition =\n  | Public<InngestFunctionReference.Any>\n  | Public<InngestFunction.Any>\n  | string;\n\n/**\n * Given an invocation target, extract the payload that will be used to trigger\n * it.\n *\n * If we could not find a payload, will return `never`.\n */\nexport type TriggerEventFromFunction<\n  TFunction extends InvokeTargetFunctionDefinition,\n> = TFunction extends InngestFunction.Any\n  ? PayloadForAnyInngestFunction<TFunction>\n  : TFunction extends InngestFunctionReference<\n        infer IInput extends MinimalEventPayload,\n        // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n        any\n      >\n    ? IInput\n    : MinimalEventPayload;\n\n/**\n * Given an {@link InngestFunction} instance, extract the {@link MinimalPayload}\n * that will be used to trigger it.\n *\n * This is intended to see what **input** a developer is expected to give to\n * invoke a function; it should not be used for evaluating the payload received\n * inside an invoked function.\n *\n * If we could not find a payload or the function does not require a payload\n * (e.g. a cron), then will return `{}`, as this is intended to be used to\n * spread into other arguments.\n *\n * @internal\n */\nexport type PayloadForAnyInngestFunction<\n  TFunction extends InngestFunction.Any,\n  TEvents extends Record<\n    string,\n    EventPayload\n  > = TFunction extends InngestFunction.Any\n    ? EventsFromFunction<TFunction>\n    : never,\n> = TFunction extends InngestFunction<\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n  any,\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n  any,\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n  any,\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n  any,\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n  any,\n  infer ITriggers extends InngestFunction.Trigger<keyof TEvents & string>[]\n>\n  ? IsEqual<\n      TEvents[EventNameFromTrigger<TEvents, ITriggers[number]>][\"name\"],\n      `${internalEvents.ScheduledTimer}`\n    > extends true\n    ? object // If this is ONLY a cron trigger, then we don't need to provide a payload\n    : Simplify<\n        Omit<\n          TEvents[EventNameFromTrigger<TEvents, ITriggers[number]>],\n          \"name\" | \"ts\"\n        >\n      >\n  : never;\n\nexport type InvocationResult<TReturn> = Promise<TReturn>;\n// TODO Types ready for when we expand this.\n// & {\n//   result: InvocationResult<TReturn>;\n//   cancel: (reason: string) => Promise<void>; // TODO Need to be a Promise? ðŸ¤”\n//   queued: Promise<{ runId: string }>;\n// };\n\n/**\n * Simplified version of Rust style `Result`\n *\n * Make it easier to wrap functions with some kind of result.\n * e.g. API calls\n */\nexport type Result<T, E = undefined> =\n  | { ok: true; value: T }\n  | { ok: false; error: E | undefined };\n\nexport const ok = <T>(data: T): Result<T, never> => {\n  return { ok: true, value: data };\n};\n\nexport const err = <E>(error?: E): Result<never, E> => {\n  return { ok: false, error };\n};\n\nexport const inBandSyncRequestBodySchema = z.strictObject({\n  url: z.string(),\n});\n","import {\n  ExecutionVersion,\n  internalEvents,\n  queryKeys,\n} from \"../helpers/consts.ts\";\nimport { timeStr } from \"../helpers/strings.ts\";\nimport type { RecursiveTuple, StrictUnion } from \"../helpers/types.ts\";\nimport type {\n  Cancellation,\n  ConcurrencyOption,\n  FunctionConfig,\n  Handler,\n  TimeStr,\n  TimeStrBatch,\n  TriggersFromClient,\n} from \"../types.ts\";\nimport type {\n  IInngestExecution,\n  InngestExecutionOptions,\n} from \"./execution/InngestExecution.ts\";\nimport { createV0InngestExecution } from \"./execution/v0.ts\";\nimport { createV1InngestExecution } from \"./execution/v1.ts\";\nimport { createV2InngestExecution } from \"./execution/v2.ts\";\nimport type { GetEvents, Inngest } from \"./Inngest.ts\";\nimport type {\n  InngestMiddleware,\n  MiddlewareRegisterReturn,\n} from \"./InngestMiddleware.ts\";\n\n/**\n * A stateless Inngest function, wrapping up function configuration and any\n * in-memory steps to run when triggered.\n *\n * This function can be \"registered\" to create a handler that Inngest can\n * trigger remotely.\n *\n * @public\n */\nexport class InngestFunction<\n  TFnOpts extends InngestFunction.Options<\n    TClient,\n    TMiddleware,\n    TTriggers,\n    TFailureHandler\n  >,\n  THandler extends Handler.Any,\n  TFailureHandler extends Handler.Any,\n  TClient extends Inngest.Any = Inngest.Any,\n  TMiddleware extends InngestMiddleware.Stack = InngestMiddleware.Stack,\n  TTriggers extends InngestFunction.Trigger<\n    TriggersFromClient<TClient>\n  >[] = InngestFunction.Trigger<TriggersFromClient<TClient>>[],\n> implements InngestFunction.Like\n{\n  static stepId = \"step\";\n  static failureSuffix = \"-failure\";\n\n  get [Symbol.toStringTag](): typeof InngestFunction.Tag {\n    return InngestFunction.Tag;\n  }\n\n  public readonly opts: TFnOpts;\n  // biome-ignore lint/correctness/noUnusedPrivateClassMembers: used internally\n  private readonly fn: THandler;\n  private readonly onFailureFn?: TFailureHandler;\n  protected readonly client: TClient;\n  private readonly middleware: Promise<MiddlewareRegisterReturn[]>;\n\n  /**\n   * A stateless Inngest function, wrapping up function configuration and any\n   * in-memory steps to run when triggered.\n   *\n   * This function can be \"registered\" to create a handler that Inngest can\n   * trigger remotely.\n   */\n  constructor(\n    client: TClient,\n\n    /**\n     * Options\n     */\n    opts: TFnOpts,\n    fn: THandler,\n  ) {\n    this.client = client;\n    this.opts = opts;\n    this.fn = fn;\n    this.onFailureFn = this.opts.onFailure;\n\n    this.middleware = this.client[\"initializeMiddleware\"](\n      this.opts.middleware,\n      { registerInput: { fn: this }, prefixStack: this.client[\"middleware\"] },\n    );\n  }\n\n  /**\n   * The generated or given ID for this function.\n   */\n  public id(prefix?: string): string {\n    return [prefix, this.opts.id].filter(Boolean).join(\"-\");\n  }\n\n  /**\n   * The generated or given ID for this function, prefixed with the app ID. This\n   * is used for routing invokes and identifying the function across apps.\n   */\n  protected get absoluteId(): string {\n    return this.id(this.client.id);\n  }\n\n  /**\n   * The name of this function as it will appear in the Inngest Cloud UI.\n   */\n  public get name(): string {\n    return this.opts.name || this.id();\n  }\n\n  /**\n   * The description of this function.\n   */\n  public get description(): string | undefined {\n    return this.opts.description;\n  }\n\n  /**\n   * Retrieve the Inngest config for this function.\n   */\n\n  // biome-ignore lint/correctness/noUnusedPrivateClassMembers: used within the SDK\n  private getConfig({\n    baseUrl,\n    appPrefix,\n    isConnect,\n  }: {\n    /**\n     * Must be provided a URL that will be used to access the function and step.\n     * This function can't be expected to know how it will be accessed, so\n     * relies on an outside method providing context.\n     */\n    baseUrl: URL;\n\n    /**\n     * The prefix for the app that this function is part of.\n     */\n    appPrefix: string;\n\n    /**\n     * Whether this function is being used in a Connect handler.\n     */\n    isConnect?: boolean;\n  }): FunctionConfig[] {\n    const fnId = this.id(appPrefix);\n    const stepUrl = new URL(baseUrl.href);\n    stepUrl.searchParams.set(queryKeys.FnId, fnId);\n    stepUrl.searchParams.set(queryKeys.StepId, InngestFunction.stepId);\n\n    const {\n      retries: attempts,\n      cancelOn,\n      idempotency,\n      batchEvents,\n      rateLimit,\n      throttle,\n      concurrency,\n      debounce,\n      timeouts,\n      priority,\n      singleton,\n    } = this.opts;\n\n    /**\n     * Convert retries into the format required when defining function\n     * configuration.\n     */\n    const retries = typeof attempts === \"undefined\" ? undefined : { attempts };\n\n    const fn: FunctionConfig = {\n      id: fnId,\n      name: this.name,\n      triggers: (this.opts.triggers ?? []).map((trigger) => {\n        if (\"event\" in trigger) {\n          return {\n            event: trigger.event as string,\n            expression: trigger.if,\n          };\n        }\n\n        return {\n          cron: trigger.cron,\n        };\n      }),\n      steps: {\n        [InngestFunction.stepId]: {\n          id: InngestFunction.stepId,\n          name: InngestFunction.stepId,\n          runtime: {\n            type: isConnect ? \"ws\" : \"http\",\n            url: stepUrl.href,\n          },\n          retries,\n        },\n      },\n      idempotency,\n      batchEvents,\n      rateLimit,\n      throttle,\n      concurrency,\n      debounce,\n      priority,\n      timeouts,\n      singleton,\n    };\n\n    if (cancelOn) {\n      fn.cancel = cancelOn.map(({ event, timeout, if: ifStr, match }) => {\n        const ret: NonNullable<FunctionConfig[\"cancel\"]>[number] = {\n          event,\n        };\n\n        if (timeout) {\n          ret.timeout = timeStr(timeout);\n        }\n\n        if (match) {\n          ret.if = `event.${match} == async.${match}`;\n        } else if (ifStr) {\n          ret.if = ifStr;\n        }\n\n        return ret;\n      }, []);\n    }\n\n    const config: FunctionConfig[] = [fn];\n\n    if (this.onFailureFn) {\n      const id = `${fn.id}${InngestFunction.failureSuffix}`;\n      const name = `${fn.name ?? fn.id} (failure)`;\n\n      const failureStepUrl = new URL(stepUrl.href);\n      failureStepUrl.searchParams.set(queryKeys.FnId, id);\n\n      config.push({\n        id,\n        name,\n        triggers: [\n          {\n            event: internalEvents.FunctionFailed,\n            expression: `event.data.function_id == '${fnId}'`,\n          },\n        ],\n        steps: {\n          [InngestFunction.stepId]: {\n            id: InngestFunction.stepId,\n            name: InngestFunction.stepId,\n            runtime: {\n              type: \"http\",\n              url: failureStepUrl.href,\n            },\n            retries: { attempts: 1 },\n          },\n        },\n      });\n    }\n\n    return config;\n  }\n\n  protected createExecution(opts: CreateExecutionOptions): IInngestExecution {\n    const options: InngestExecutionOptions = {\n      fn: this,\n      ...opts.partialOptions,\n    };\n\n    const versionHandlers = {\n      [ExecutionVersion.V2]: () => createV2InngestExecution(options),\n      [ExecutionVersion.V1]: () => createV1InngestExecution(options),\n      [ExecutionVersion.V0]: () => createV0InngestExecution(options),\n    } satisfies Record<ExecutionVersion, () => IInngestExecution>;\n\n    return versionHandlers[opts.version]();\n  }\n\n  // biome-ignore lint/correctness/noUnusedPrivateClassMembers: used within the SDK\n  private shouldOptimizeParallelism(): boolean {\n    // TODO We should check the commhandler's client instead of this one?\n    return (\n      this.opts.optimizeParallelism ??\n      this.client[\"options\"].optimizeParallelism ??\n      false\n    );\n  }\n}\n\n/**\n * A stateless Inngest function, wrapping up function configuration and any\n * in-memory steps to run when triggered.\n *\n * This function can be \"registered\" to create a handler that Inngest can\n * trigger remotely.\n *\n * @public\n */\nexport namespace InngestFunction {\n  export const Tag = \"Inngest.Function\" as const;\n\n  /**\n   * Represents any `InngestFunction` instance, regardless of generics and\n   * inference.\n   */\n  export type Any = InngestFunction<\n    // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n    any,\n    Handler.Any,\n    Handler.Any,\n    // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n    any,\n    // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n    any,\n    // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n    any\n  >;\n\n  export interface Like {\n    readonly [Symbol.toStringTag]: typeof InngestFunction.Tag;\n  }\n\n  /**\n   * A user-friendly method of specifying a trigger for an Inngest function.\n   *\n   * @public\n   */\n  export type Trigger<T extends string> = StrictUnion<\n    | {\n        event: T;\n        if?: string;\n      }\n    | {\n        cron: string;\n      }\n  >;\n\n  export type GetOptions<T extends InngestFunction.Any> =\n    // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n    T extends InngestFunction<infer O, any, any, any, any, any> ? O : never;\n\n  /**\n   * A set of options for configuring an Inngest function.\n   *\n   * @public\n   */\n  export interface Options<\n    TClient extends Inngest.Any = Inngest.Any,\n    TMiddleware extends InngestMiddleware.Stack = InngestMiddleware.Stack,\n    TTriggers extends InngestFunction.Trigger<\n      TriggersFromClient<TClient>\n    >[] = InngestFunction.Trigger<TriggersFromClient<TClient>>[],\n    TFailureHandler extends Handler.Any = Handler.Any,\n  > {\n    triggers?: TTriggers;\n\n    /**\n     * An unique ID used to identify the function. This is used internally for\n     * versioning and referring to your function, so should not change between\n     * deployments.\n     *\n     * If you'd like to set a prettier name for your function, use the `name`\n     * option.\n     */\n    id: string;\n\n    /**\n     * A name for the function as it will appear in the Inngest Cloud UI.\n     */\n    name?: string;\n\n    /**\n     * A description of the function.\n     */\n    description?: string;\n\n    /**\n     * Concurrency specifies a limit on the total number of concurrent steps that\n     * can occur across all runs of the function.  A value of 0 (or undefined) means\n     * use the maximum available concurrency.\n     *\n     * Specifying just a number means specifying only the concurrency limit. A\n     * maximum of two concurrency options can be specified.\n     */\n    concurrency?:\n      | number\n      | ConcurrencyOption\n      | RecursiveTuple<ConcurrencyOption, 2>;\n\n    /**\n     * batchEvents specifies the batch configuration on when this function\n     * should be invoked when one of the requirements are fulfilled.\n     */\n    batchEvents?: {\n      /**\n       * The maximum number of events to be consumed in one batch.\n       * Check the pricing page to verify the limit for each plan.\n       */\n      maxSize: number;\n\n      /**\n       * How long to wait before invoking the function with a list of events.\n       * If timeout is reached, the function will be invoked with a batch\n       * even if it's not filled up to `maxSize`.\n       *\n       * Expects a time string such as 1s, 60s or 15m15s.\n       */\n      timeout: TimeStrBatch;\n\n      /**\n       * An optional key to use for batching.\n       *\n       * See [batch documentation](https://innge.st/batching) for more\n       * information on how to use `key` expressions.\n       */\n      key?: string;\n\n      /**\n       * An optional boolean expression to determine an event's eligibility for batching\n       *\n       * See [batch documentation](https://innge.st/batching) for more\n       * information on how to use `if` expressions.\n       */\n      if?: string;\n    };\n\n    /**\n     * Allow the specification of an idempotency key using event data. If\n     * specified, this overrides the `rateLimit` object.\n     */\n    idempotency?: string;\n\n    /**\n     * Rate limit function runs, only running them a given number of times (limit) per\n     * period.  Note that rate limit is a lossy, hard limit.  Once the limit is hit,\n     * new runs will be skipped.  To enqueue work when a rate limit is hit, use the\n     * {@link throttle} parameter.\n     */\n    rateLimit?: {\n      /**\n       * An optional key to use for rate limiting, similar to idempotency.\n       */\n      key?: string;\n\n      /**\n       * The number of times to allow the function to run per the given `period`.\n       */\n      limit: number;\n\n      /**\n       * The period of time to allow the function to run `limit` times.\n       */\n      period: TimeStr;\n    };\n\n    /**\n     * Throttles function runs, only running them a given number of times (limit) per\n     * period.  Once the limit is hit, new runs will be enqueued and will start when there's\n     * capacity.  This may lead to a large backlog.  For hard rate limiting, use the\n     * {@link rateLimit} parameter.\n     */\n    throttle?: {\n      /**\n       *  An optional expression which returns a throttling key for controlling throttling.\n       *  Every unique key is its own throttle limit.  Event data may be used within this\n       *  expression, eg \"event.data.user_id\".\n       */\n      key?: string;\n\n      /**\n       * The total number of runs allowed to start within the given `period`.  The limit is\n       * applied evenly over the period.\n       */\n      limit: number;\n\n      /**\n       * The period of time for the rate limit.  Run starts are evenly spaced through\n       * the given period.  The minimum granularity is 1 second.\n       */\n      period: TimeStr;\n\n      /**\n       * The number of runs allowed to start in the given window in a single burst.\n       * A burst > 1 bypasses smoothing for the burst and allows many runs to start\n       * at once, if desired.  Defaults to 1, which disables bursting.\n       */\n      burst?: number;\n    };\n\n    /**\n     * Debounce delays functions for the `period` specified. If an event is sent,\n     * the function will not run until at least `period` has elapsed.\n     *\n     * If any new events are received that match the same debounce `key`, the\n     * function is rescheduled for another `period` delay, and the triggering\n     * event is replaced with the latest event received.\n     *\n     * See the [Debounce documentation](https://innge.st/debounce) for more\n     * information.\n     */\n    debounce?: {\n      /**\n       * An optional key to use for debouncing.\n       *\n       * See [Debounce documentation](https://innge.st/debounce) for more\n       * information on how to use `key` expressions.\n       */\n      key?: string;\n\n      /**\n       * The period of time to delay after receiving the last trigger to run the\n       * function.\n       *\n       * See [Debounce documentation](https://innge.st/debounce) for more\n       * information.\n       */\n      period: TimeStr;\n\n      /**\n       * The maximum time that a debounce can be extended before running.\n       * If events are continually received within the given period, a function\n       * will always run after the given timeout period.\n       *\n       * See [Debounce documentation](https://innge.st/debounce) for more\n       * information.\n       */\n      timeout?: TimeStr;\n    };\n\n    /**\n     * Configure how the priority of a function run is decided when multiple\n     * functions are triggered at the same time.\n     *\n     * See the [Priority documentation](https://innge.st/priority) for more\n     * information.\n     */\n    priority?: {\n      /**\n       * An expression to use to determine the priority of a function run. The\n       * expression can return a number between `-600` and `600`, where `600`\n       * declares that this run should be executed before any others enqueued in\n       * the last 600 seconds (10 minutes), and `-600` declares that this run\n       * should be executed after any others enqueued in the last 600 seconds.\n       *\n       * See the [Priority documentation](https://innge.st/priority) for more\n       * information.\n       */\n      run?: string;\n    };\n\n    /**\n     * Configure timeouts for the function.  If any of the timeouts are hit, the\n     * function run will be cancelled.\n     */\n    timeouts?: {\n      /**\n       * Start represents the timeout for starting a function.  If the time\n       * between scheduling and starting a function exceeds this value, the\n       * function will be cancelled.\n       *\n       * This is, essentially, the amount of time that a function sits in the\n       * queue before starting.\n       *\n       * A function may exceed this duration because of concurrency limits,\n       * throttling, etc.\n       */\n      start?: TimeStr;\n\n      /**\n       * Finish represents the time between a function starting and the function\n       * finishing. If a function takes longer than this time to finish, the\n       * function is marked as cancelled.\n       *\n       * The start time is taken from the time that the first successful\n       * function request begins, and does not include the time spent in the\n       * queue before the function starts.\n       *\n       * Note that if the final request to a function begins before this\n       * timeout, and completes after this timeout, the function will succeed.\n       */\n      finish?: TimeStr;\n    };\n\n    /**\n     * Ensures that only one run of the function is active at a time for a given key.\n     * If a new run is triggered while another is still in progress with the same key,\n     * the new run will either be skipped or replace the active one, depending on the mode.\n     *\n     * This is useful for deduplication or enforcing exclusive execution.\n     */\n    singleton?: {\n      /**\n       * An optional key expression used to scope singleton execution.\n       * Each unique key has its own singleton lock. Event data can be referenced,\n       * e.g. \"event.data.user_id\".\n       */\n      key?: string;\n\n      /**\n       * Determines how to handle new runs when one is already active for the same key.\n       * - `\"skip\"` skips the new run.\n       * - `\"cancel\"` cancels the existing run and starts the new one.\n       */\n      mode: \"skip\" | \"cancel\";\n    };\n\n    cancelOn?: Cancellation<GetEvents<TClient, true>>[];\n\n    /**\n     * Specifies the maximum number of retries for all steps across this function.\n     *\n     * Can be a number from `0` to `20`. Defaults to `3`.\n     */\n    retries?:\n      | 0\n      | 1\n      | 2\n      | 3\n      | 4\n      | 5\n      | 6\n      | 7\n      | 8\n      | 9\n      | 10\n      | 11\n      | 12\n      | 13\n      | 14\n      | 15\n      | 16\n      | 17\n      | 18\n      | 19\n      | 20;\n\n    /**\n     * Provide a function to be called if your function fails, meaning\n     * that it ran out of retries and was unable to complete successfully.\n     *\n     * This is useful for sending warning notifications or cleaning up\n     * after a failure and supports all the same functionality as a\n     * regular handler.\n     */\n    onFailure?: TFailureHandler;\n\n    /**\n     * Define a set of middleware that can be registered to hook into\n     * various lifecycles of the SDK and affect input and output of\n     * Inngest functionality.\n     *\n     * See {@link https://innge.st/middleware}\n     *\n     * @example\n     *\n     * ```ts\n     * export const inngest = new Inngest({\n     *   middleware: [\n     *     new InngestMiddleware({\n     *       name: \"My Middleware\",\n     *       init: () => {\n     *         // ...\n     *       }\n     *     })\n     *   ]\n     * });\n     * ```\n     */\n    middleware?: TMiddleware;\n\n    /**\n     * If `true`, parallel steps within this function are optimized to reduce\n     * traffic during `Promise` resolution, which can hugely reduce the time\n     * taken and number of requests for each run.\n     *\n     * Note that this will be the default behaviour in v4 and in its current\n     * form will cause `Promise.*()` to wait for all promises to settle before\n     * resolving.\n     *\n     * Providing this value here will overwrite the same value given on the\n     * client.\n     *\n     * @default false\n     */\n    optimizeParallelism?: boolean;\n  }\n}\n\nexport type CreateExecutionOptions = {\n  version: ExecutionVersion;\n  partialOptions: Omit<InngestExecutionOptions, \"fn\">;\n};\n","import Debug, { type Debugger } from \"debug\";\nimport { debugPrefix, ExecutionVersion } from \"../../helpers/consts.ts\";\nimport type { ServerTiming } from \"../../helpers/ServerTiming.ts\";\nimport type { MaybePromise, Simplify } from \"../../helpers/types.ts\";\nimport type { Context, IncomingOp, OutgoingOp } from \"../../types.ts\";\nimport type { Inngest } from \"../Inngest.ts\";\nimport type { ActionResponse } from \"../InngestCommHandler.ts\";\nimport type { InngestFunction } from \"../InngestFunction.ts\";\n\n// Re-export ExecutionVersion so it's correctly recognized as an enum and not\n// just a type. This can be lost when bundling if we don't re-export it here.\n// See `pnpm run test:dist`.\nexport { ExecutionVersion };\n\n/**\n * The possible results of an execution.\n */\nexport interface ExecutionResults {\n  \"function-resolved\": { data: unknown };\n  \"step-ran\": { step: OutgoingOp; retriable?: boolean | string };\n  \"function-rejected\": { error: unknown; retriable: boolean | string };\n  \"steps-found\": { steps: [OutgoingOp, ...OutgoingOp[]] };\n  \"step-not-found\": { step: OutgoingOp };\n}\n\nexport type ExecutionResult = {\n  [K in keyof ExecutionResults]: Simplify<\n    {\n      type: K;\n      ctx: Context.Any;\n      ops: Record<string, MemoizedOp>;\n    } & ExecutionResults[K]\n  >;\n}[keyof ExecutionResults];\n\nexport type ExecutionResultHandler<T = ActionResponse> = (\n  result: ExecutionResult,\n) => MaybePromise<T>;\n\nexport type ExecutionResultHandlers<T = ActionResponse> = {\n  [E in ExecutionResult as E[\"type\"]]: (result: E) => MaybePromise<T>;\n};\n\nexport interface MemoizedOp extends IncomingOp {\n  /**\n   * If the step has been hit during this run, these will be the arguments\n   * passed to it.\n   */\n  rawArgs?: unknown[];\n  fulfilled?: boolean;\n\n  /**\n   * The promise that has been returned to userland code.\n   */\n  promise?: Promise<unknown>;\n  seen?: boolean;\n}\n\n/**\n * The preferred execution version that will be used by the SDK when handling\n * brand new runs where the Executor is allowing us to choose.\n *\n * Changing this should not ever be a breaking change, as this will only change\n * new runs, not existing ones.\n */\nexport const PREFERRED_EXECUTION_VERSION =\n  ExecutionVersion.V1 satisfies ExecutionVersion;\n\n/**\n * Options for creating a new {@link InngestExecution} instance.\n */\nexport interface InngestExecutionOptions {\n  client: Inngest.Any;\n  fn: InngestFunction.Any;\n  reqArgs: unknown[];\n  runId: string;\n  data: Omit<Context.Any, \"step\">;\n  stepState: Record<string, MemoizedOp>;\n  stepCompletionOrder: string[];\n\n  /**\n   * Headers to be sent with any request to Inngest during this execution.\n   */\n  headers: Record<string, string>;\n  requestedRunStep?: string;\n  timer?: ServerTiming;\n  isFailureHandler?: boolean;\n  disableImmediateExecution?: boolean;\n\n  /**\n   * Provide the ability to transform the context passed to the function before\n   * the execution starts.\n   */\n  transformCtx?: (ctx: Readonly<Context.Any>) => Context.Any;\n}\n\nexport type InngestExecutionFactory = (\n  options: InngestExecutionOptions,\n) => IInngestExecution;\n\nexport class InngestExecution {\n  protected debug: Debugger;\n\n  constructor(protected options: InngestExecutionOptions) {\n    this.debug = Debug(`${debugPrefix}:${this.options.runId}`);\n  }\n}\n\nexport interface IInngestExecution {\n  start(): Promise<ExecutionResult>;\n}\n","import chalk from \"chalk\";\n\n/**\n * Keys for accessing query parameters included in requests from Inngest to run\n * functions.\n *\n * Used internally to create handlers using `InngestCommHandler`, but can be\n * imported to be used if creating a custom handler outside of the package.\n *\n * @public\n */\nexport enum queryKeys {\n  DeployId = \"deployId\",\n  FnId = \"fnId\",\n  Probe = \"probe\",\n  StepId = \"stepId\",\n}\n\nexport enum probe {\n  Trust = \"trust\",\n}\n\nexport enum envKeys {\n  InngestSigningKey = \"INNGEST_SIGNING_KEY\",\n  InngestSigningKeyFallback = \"INNGEST_SIGNING_KEY_FALLBACK\",\n  InngestEventKey = \"INNGEST_EVENT_KEY\",\n\n  /**\n   * @deprecated Removed in v3. Use {@link InngestBaseUrl} instead.\n   */\n  InngestDevServerUrl = \"INNGEST_DEVSERVER_URL\",\n  InngestEnvironment = \"INNGEST_ENV\",\n  InngestBaseUrl = \"INNGEST_BASE_URL\",\n  InngestEventApiBaseUrl = \"INNGEST_EVENT_API_BASE_URL\",\n  InngestApiBaseUrl = \"INNGEST_API_BASE_URL\",\n  InngestServeHost = \"INNGEST_SERVE_HOST\",\n  InngestServePath = \"INNGEST_SERVE_PATH\",\n  InngestLogLevel = \"INNGEST_LOG_LEVEL\",\n  InngestStreaming = \"INNGEST_STREAMING\",\n  InngestDevMode = \"INNGEST_DEV\",\n  InngestAllowInBandSync = \"INNGEST_ALLOW_IN_BAND_SYNC\",\n\n  /**\n   * @deprecated It's unknown what this env var was used for, but we do not\n   * provide explicit support for it. Prefer using `INNGEST_ENV` instead.\n   */\n  BranchName = \"BRANCH_NAME\",\n\n  /**\n   * The git branch of the commit the deployment was triggered by. Example:\n   * `improve-about-page`.\n   *\n   * {@link https://vercel.com/docs/concepts/projects/environment-variables/system-environment-variables#system-environment-variables}\n   */\n  VercelBranch = \"VERCEL_GIT_COMMIT_REF\",\n\n  /**\n   * Expected to be `\"1\"` if defined.\n   */\n  IsVercel = \"VERCEL\",\n\n  /**\n   * The branch name of the current deployment. May only be accessible at build\n   * time, but included here just in case.\n   *\n   * {@link https://developers.cloudflare.com/pages/platform/build-configuration/#environment-variables}\n   */\n  CloudflarePagesBranch = \"CF_PAGES_BRANCH\",\n\n  /**\n   * Expected to be `\"1\"` if defined.\n   */\n  IsCloudflarePages = \"CF_PAGES\",\n\n  /**\n   * The branch name of the deployment from Git to Netlify, if available.\n   *\n   * {@link https://docs.netlify.com/configure-builds/environment-variables/#git-metadata}\n   */\n  NetlifyBranch = \"BRANCH\",\n\n  /**\n   * Expected to be `\"true\"` if defined.\n   */\n  IsNetlify = \"NETLIFY\",\n\n  /**\n   * The Git branch for a service or deploy.\n   *\n   * {@link https://render.com/docs/environment-variables#all-services}\n   */\n  RenderBranch = \"RENDER_GIT_BRANCH\",\n\n  /**\n   * Expected to be `\"true\"` if defined.\n   */\n  IsRender = \"RENDER\",\n\n  /**\n   * The branch that triggered the deployment. Example: `main`\n   *\n   * {@link https://docs.railway.app/develop/variables#railway-provided-variables}\n   */\n  RailwayBranch = \"RAILWAY_GIT_BRANCH\",\n\n  /**\n   * The railway environment for the deployment. Example: `production`\n   *\n   * {@link https://docs.railway.app/develop/variables#railway-provided-variables}\n   */\n  RailwayEnvironment = \"RAILWAY_ENVIRONMENT\",\n\n  VercelEnvKey = \"VERCEL_ENV\",\n\n  OpenAiApiKey = \"OPENAI_API_KEY\",\n  GeminiApiKey = \"GEMINI_API_KEY\",\n  AnthropicApiKey = \"ANTHROPIC_API_KEY\",\n}\n\n/**\n * Keys for accessing headers included in requests from Inngest to run\n * functions.\n *\n * Used internally to create handlers using `InngestCommHandler`, but can be\n * imported to be used if creating a custom handler outside of the package.\n *\n * @public\n */\nexport enum headerKeys {\n  ContentLength = \"content-length\",\n  Signature = \"x-inngest-signature\",\n  SdkVersion = \"x-inngest-sdk\",\n  Environment = \"x-inngest-env\",\n  Platform = \"x-inngest-platform\",\n  Framework = \"x-inngest-framework\",\n  NoRetry = \"x-inngest-no-retry\",\n  RequestVersion = \"x-inngest-req-version\",\n  RetryAfter = \"retry-after\",\n  InngestServerKind = \"x-inngest-server-kind\",\n  InngestExpectedServerKind = \"x-inngest-expected-server-kind\",\n  InngestSyncKind = \"x-inngest-sync-kind\",\n  EventIdSeed = \"x-inngest-event-id-seed\",\n  TraceParent = \"traceparent\",\n  TraceState = \"tracestate\",\n}\n\nexport const defaultInngestApiBaseUrl = \"https://api.inngest.com/\";\nexport const defaultInngestEventBaseUrl = \"https://inn.gs/\";\nexport const defaultDevServerHost = \"http://localhost:8288/\";\n\n/**\n * Events that Inngest may send internally that can be used to trigger\n * functions.\n *\n * @public\n */\nexport enum internalEvents {\n  /**\n   * A function has failed after exhausting all available retries. This event\n   * will contain the original event and the error that caused the failure.\n   */\n  FunctionFailed = \"inngest/function.failed\",\n  FunctionInvoked = \"inngest/function.invoked\",\n  FunctionFinished = \"inngest/function.finished\",\n  FunctionCancelled = \"inngest/function.cancelled\",\n  ScheduledTimer = \"inngest/scheduled.timer\",\n}\n\nexport const logPrefix: string = chalk.magenta.bold(\"[Inngest]\");\n\nexport const debugPrefix = \"inngest\";\n\nexport const dummyEventKey = \"NO_EVENT_KEY_SET\";\n\nexport enum serverKind {\n  Dev = \"dev\",\n  Cloud = \"cloud\",\n}\n\nexport enum syncKind {\n  InBand = \"in_band\",\n  OutOfBand = \"out_of_band\",\n}\n\n/**\n * The execution models the SDK is aware of.\n *\n * This is used in a number of places to ensure all execution versions are\n * accounted for for a given operation.\n */\nexport enum ExecutionVersion {\n  /**\n   * Very legacy, initial version of the executor. Uses hashed op objects and\n   * `pos` to determine the order of execution and which ops to run.\n   *\n   * Very stubborn about determinism.\n   */\n  V0 = 0,\n\n  /**\n   * Uses a more flexible approach to execution and is more lenient about\n   * determinism, allowing non-step async actions and non-determinism.\n   *\n   * Nowhere near as stubborn about determinism and so can silently migrate\n   * between versions after bug fixes.\n   */\n  V1 = 1,\n\n  /**\n   * Identical to V1, but allows the Executor to optimize parallel calls, hugely\n   * reducing traffic going to/from the SDK.\n   */\n  V2 = 2,\n}\n","import canonicalize from \"canonicalize\";\nimport hashjs from \"hash.js\";\nimport { z } from \"zod/v3\";\nimport {\n  deserializeError,\n  ErrCode,\n  functionStoppedRunningErr,\n  prettyError,\n  serializeError,\n} from \"../../helpers/errors.ts\";\nimport { undefinedToNull } from \"../../helpers/functions.ts\";\nimport {\n  resolveAfterPending,\n  resolveNextTick,\n  runAsPromise,\n} from \"../../helpers/promises.ts\";\nimport type { MaybePromise, PartialK } from \"../../helpers/types.ts\";\nimport {\n  type BaseContext,\n  type Context,\n  type EventPayload,\n  type FailureEventArgs,\n  type Handler,\n  type HashedOp,\n  type IncomingOp,\n  jsonErrorSchema,\n  type OpStack,\n  type OutgoingOp,\n  StepOpCode,\n} from \"../../types.ts\";\nimport type { Inngest } from \"../Inngest.ts\";\nimport { getHookStack, type RunHookStack } from \"../InngestMiddleware.ts\";\nimport {\n  createStepTools,\n  getStepOptions,\n  type StepHandler,\n} from \"../InngestStepTools.ts\";\nimport { NonRetriableError } from \"../NonRetriableError.ts\";\nimport { RetryAfterError } from \"../RetryAfterError.ts\";\nimport {\n  type ExecutionResult,\n  type IInngestExecution,\n  InngestExecution,\n  type InngestExecutionFactory,\n  type InngestExecutionOptions,\n  type MemoizedOp,\n} from \"./InngestExecution.ts\";\n\nconst { sha1 } = hashjs;\n\nexport const createV0InngestExecution: InngestExecutionFactory = (options) => {\n  return new V0InngestExecution(options);\n};\n\nexport class V0InngestExecution\n  extends InngestExecution\n  implements IInngestExecution\n{\n  private state: V0ExecutionState;\n  private execution: Promise<ExecutionResult> | undefined;\n  private userFnToRun: Handler.Any;\n  private fnArg: Context.Any;\n\n  constructor(options: InngestExecutionOptions) {\n    super(options);\n\n    this.userFnToRun = this.getUserFnToRun();\n    this.state = this.createExecutionState();\n    this.fnArg = this.createFnArg();\n  }\n\n  public start() {\n    this.debug(\"starting V0 execution\");\n\n    // biome-ignore lint/suspicious/noAssignInExpressions: <explanation>\n    return (this.execution ??= this._start().then((result) => {\n      this.debug(\"result:\", result);\n      return result;\n    }));\n  }\n\n  private async _start(): Promise<ExecutionResult> {\n    this.state.hooks = await this.initializeMiddleware();\n\n    try {\n      await this.transformInput();\n      await this.state.hooks.beforeMemoization?.();\n\n      if (this.state.opStack.length === 0 && !this.options.requestedRunStep) {\n        await this.state.hooks.afterMemoization?.();\n        await this.state.hooks.beforeExecution?.();\n      }\n\n      const userFnPromise = runAsPromise(() => this.userFnToRun(this.fnArg));\n\n      let pos = -1;\n\n      do {\n        if (pos >= 0) {\n          if (\n            !this.options.requestedRunStep &&\n            pos === this.state.opStack.length - 1\n          ) {\n            await this.state.hooks.afterMemoization?.();\n            await this.state.hooks.beforeExecution?.();\n          }\n\n          this.state.tickOps = {};\n          const incomingOp = this.state.opStack[pos] as IncomingOp;\n          this.state.currentOp = this.state.allFoundOps[incomingOp.id];\n\n          if (!this.state.currentOp) {\n            /**\n             * We're trying to resume the function, but we can't find where to go.\n             *\n             * This means that either the function has changed or there are async\n             * actions in-between steps that we haven't noticed in previous\n             * executions.\n             *\n             * Whichever the case, this is bad and we can't continue in this\n             * undefined state.\n             */\n            throw new NonRetriableError(\n              prettyError({\n                whatHappened: \" Your function was stopped from running\",\n                why: \"We couldn't resume your function's state because it may have changed since the run started or there are async actions in-between steps that we haven't noticed in previous executions.\",\n                consequences:\n                  \"Continuing to run the function may result in unexpected behaviour, so we've stopped your function to ensure nothing unexpected happened!\",\n                toFixNow:\n                  \"Ensure that your function is either entirely step-based or entirely non-step-based, by either wrapping all asynchronous logic in `step.run()` calls or by removing all `step.*()` calls.\",\n                otherwise:\n                  \"For more information on why step functions work in this manner, see https://www.inngest.com/docs/functions/multi-step#gotchas\",\n                stack: true,\n                code: ErrCode.NON_DETERMINISTIC_FUNCTION,\n              }),\n            );\n          }\n\n          this.state.currentOp.fulfilled = true;\n\n          if (typeof incomingOp.data !== \"undefined\") {\n            this.state.currentOp.resolve(incomingOp.data);\n          } else {\n            this.state.currentOp.reject(incomingOp.error);\n          }\n        }\n\n        await resolveAfterPending();\n        this.state.reset();\n        pos++;\n      } while (pos < this.state.opStack.length);\n\n      await this.state.hooks.afterMemoization?.();\n\n      const discoveredOps = Object.values(this.state.tickOps).map<OutgoingOp>(\n        tickOpToOutgoing,\n      );\n\n      const runStep =\n        this.options.requestedRunStep ||\n        this.getEarlyExecRunStep(discoveredOps);\n\n      if (runStep) {\n        const userFnOp = this.state.allFoundOps[runStep];\n        const stepToRun = userFnOp?.fn;\n\n        if (!stepToRun) {\n          throw new Error(\n            `Bad stack; executor requesting to run unknown step \"${runStep}\"`,\n          );\n        }\n\n        const outgoingUserFnOp = {\n          ...tickOpToOutgoing(userFnOp),\n          op: StepOpCode.Step,\n        };\n\n        await this.state.hooks.beforeExecution?.();\n        this.state.executingStep = true;\n\n        const result = await runAsPromise(stepToRun)\n          .finally(() => {\n            this.state.executingStep = false;\n          })\n          .catch(async (error: Error) => {\n            return await this.transformOutput({ error }, outgoingUserFnOp);\n          })\n          .then(async (data) => {\n            await this.state.hooks?.afterExecution?.();\n            return await this.transformOutput({ data }, outgoingUserFnOp);\n          });\n\n        const { type: _type, ...rest } = result;\n\n        return {\n          type: \"step-ran\",\n          ctx: this.fnArg,\n          ops: this.ops,\n          step: { ...outgoingUserFnOp, ...rest },\n        };\n      }\n\n      if (!discoveredOps.length) {\n        const fnRet = await Promise.race([\n          userFnPromise.then((data) => ({ type: \"complete\", data }) as const),\n          resolveNextTick().then(() => ({ type: \"incomplete\" }) as const),\n        ]);\n\n        if (fnRet.type === \"complete\") {\n          await this.state.hooks.afterExecution?.();\n\n          const allOpsFulfilled = Object.values(this.state.allFoundOps).every(\n            (op) => {\n              return op.fulfilled;\n            },\n          );\n\n          if (allOpsFulfilled) {\n            return await this.transformOutput({ data: fnRet.data });\n          }\n        } else if (!this.state.hasUsedTools) {\n          this.state.nonStepFnDetected = true;\n          const data = await userFnPromise;\n          await this.state.hooks.afterExecution?.();\n          return await this.transformOutput({ data });\n        } else {\n          const hasOpsPending = Object.values(this.state.allFoundOps).some(\n            (op) => {\n              return op.fulfilled === false;\n            },\n          );\n\n          if (!hasOpsPending) {\n            throw new NonRetriableError(\n              functionStoppedRunningErr(\n                ErrCode.ASYNC_DETECTED_AFTER_MEMOIZATION,\n              ),\n            );\n          }\n        }\n      }\n\n      await this.state.hooks.afterExecution?.();\n\n      return {\n        type: \"steps-found\",\n        ctx: this.fnArg,\n        ops: this.ops,\n        steps: discoveredOps as [OutgoingOp, ...OutgoingOp[]],\n      };\n    } catch (error) {\n      return await this.transformOutput({ error });\n    } finally {\n      await this.state.hooks.beforeResponse?.();\n    }\n  }\n\n  private async initializeMiddleware(): Promise<RunHookStack> {\n    const ctx = this.options.data as Pick<\n      Readonly<BaseContext<Inngest.Any>>,\n      \"event\" | \"events\" | \"runId\"\n    >;\n\n    const hooks = await getHookStack(\n      this.options.fn[\"middleware\"],\n      \"onFunctionRun\",\n      {\n        ctx,\n        fn: this.options.fn,\n        steps: Object.values(this.options.stepState),\n        reqArgs: this.options.reqArgs,\n      },\n      {\n        transformInput: (prev, output) => {\n          return {\n            ctx: { ...prev.ctx, ...output?.ctx },\n            fn: this.options.fn,\n            steps: prev.steps.map((step, i) => ({\n              ...step,\n              ...output?.steps?.[i],\n            })),\n            reqArgs: prev.reqArgs,\n          };\n        },\n        transformOutput: (prev, output) => {\n          return {\n            result: { ...prev.result, ...output?.result },\n            step: prev.step,\n          };\n        },\n      },\n    );\n\n    return hooks;\n  }\n\n  private createExecutionState(): V0ExecutionState {\n    const state: V0ExecutionState = {\n      allFoundOps: {},\n      tickOps: {},\n      tickOpHashes: {},\n      currentOp: undefined,\n      hasUsedTools: false,\n      reset: () => {\n        state.tickOpHashes = {};\n        state.allFoundOps = { ...state.allFoundOps, ...state.tickOps };\n      },\n      nonStepFnDetected: false,\n      executingStep: false,\n      opStack: this.options.stepCompletionOrder.reduce<IncomingOp[]>(\n        (acc, stepId) => {\n          const stepState = this.options.stepState[stepId];\n          if (!stepState) {\n            return acc;\n          }\n\n          return [...acc, stepState];\n        },\n        [],\n      ),\n    };\n\n    return state;\n  }\n\n  get ops(): Record<string, MemoizedOp> {\n    return Object.fromEntries(\n      Object.entries(this.state.allFoundOps).map<[string, MemoizedOp]>(\n        ([id, op]) => [\n          id,\n          {\n            id: op.id,\n            rawArgs: op.rawArgs,\n            data: op.data,\n            error: op.error,\n            fulfilled: op.fulfilled,\n            seen: true,\n          },\n        ],\n      ),\n    );\n  }\n\n  private getUserFnToRun(): Handler.Any {\n    if (!this.options.isFailureHandler) {\n      return this.options.fn[\"fn\"];\n    }\n\n    if (!this.options.fn[\"onFailureFn\"]) {\n      /**\n       * Somehow, we've ended up detecting that this is a failure handler but\n       * doesn't have an `onFailure` function. This should never happen.\n       */\n      throw new Error(\"Cannot find function `onFailure` handler\");\n    }\n\n    // TODO: Review; inferred types results in an `any` here!\n    return this.options.fn[\"onFailureFn\"];\n  }\n\n  private createFnArg(): Context.Any {\n    // Start referencing everything\n    this.state.tickOps = this.state.allFoundOps;\n\n    /**\n     * Create a unique hash of an operation using only a subset of the operation's\n     * properties; will never use `data` and will guarantee the order of the\n     * object so we don't rely on individual tools for that.\n     *\n     * If the operation already contains an ID, the current ID will be used\n     * instead, so that users can provide their own IDs.\n     */\n    const hashOp = (\n      /**\n       * The op to generate a hash from. We only use a subset of the op's\n       * properties when creating the hash.\n       */\n      op: PartialK<HashedOp, \"id\">,\n    ): HashedOp => {\n      /**\n       * It's difficult for v0 to understand whether or not an op has\n       * historically contained a custom ID, as all step usage now require them.\n       *\n       * For this reason, we make the assumption that steps in v0 do not have a\n       * custom ID and generate one for them as we would in all recommendations\n       * and examples.\n       */\n      const obj = {\n        parent: this.state.currentOp?.id ?? null,\n        op: op.op,\n        name: op.name as string,\n\n        // Historically, no v0 runs could have options for `step.run()` call,\n        // but this object can be specified in future versions.\n        //\n        // For this purpose, we change this to always use `null` if the op is\n        // that of a `step.run()`.\n        opts: op.op === StepOpCode.StepPlanned ? null : (op.opts ?? null),\n      };\n\n      const collisionHash = _internals.hashData(obj);\n\n      // biome-ignore lint/suspicious/noAssignInExpressions: <explanation>\n      const pos = (this.state.tickOpHashes[collisionHash] =\n        (this.state.tickOpHashes[collisionHash] ?? -1) + 1);\n\n      return {\n        ...op,\n        id: _internals.hashData({ pos, ...obj }),\n      };\n    };\n\n    const stepHandler: StepHandler = ({ args, matchOp, opts }) => {\n      if (this.state.nonStepFnDetected) {\n        throw new NonRetriableError(\n          functionStoppedRunningErr(ErrCode.STEP_USED_AFTER_ASYNC),\n        );\n      }\n\n      if (this.state.executingStep) {\n        throw new NonRetriableError(\n          prettyError({\n            whatHappened: \"Your function was stopped from running\",\n            why: \"We detected that you have nested `step.*` tooling.\",\n            consequences: \"Nesting `step.*` tooling is not supported.\",\n            stack: true,\n            toFixNow:\n              \"Make sure you're not using `step.*` tooling inside of other `step.*` tooling. If you need to compose steps together, you can create a new async function and call it from within your step function, or use promise chaining.\",\n            otherwise:\n              \"For more information on step functions with Inngest, see https://www.inngest.com/docs/functions/multi-step\",\n            code: ErrCode.NESTING_STEPS,\n          }),\n        );\n      }\n\n      this.state.hasUsedTools = true;\n\n      const stepOptions = getStepOptions(args[0]);\n      const opId = hashOp(matchOp(stepOptions, ...args.slice(1)));\n\n      return new Promise<unknown>((resolve, reject) => {\n        this.state.tickOps[opId.id] = {\n          ...opId,\n          ...(opts?.fn ? { fn: () => opts.fn?.(...args) } : {}),\n          rawArgs: args,\n          resolve,\n          reject,\n          fulfilled: false,\n        };\n      });\n    };\n\n    const step = createStepTools(this.options.client, this, stepHandler);\n\n    let fnArg = {\n      ...(this.options.data as { event: EventPayload }),\n      step,\n    } as Context.Any;\n\n    if (this.options.isFailureHandler) {\n      const eventData = z\n        .object({ error: jsonErrorSchema })\n        .parse(fnArg.event?.data);\n\n      (fnArg as Partial<Pick<FailureEventArgs, \"error\">>) = {\n        ...fnArg,\n        error: deserializeError(eventData.error),\n      };\n    }\n\n    return this.options.transformCtx?.(fnArg) ?? fnArg;\n  }\n\n  /**\n   * Using middleware, transform input before running.\n   */\n  private async transformInput() {\n    const inputMutations = await this.state.hooks?.transformInput?.({\n      ctx: { ...this.fnArg },\n      steps: Object.values(this.options.stepState),\n      fn: this.options.fn,\n      reqArgs: this.options.reqArgs,\n    });\n\n    if (inputMutations?.ctx) {\n      this.fnArg = inputMutations.ctx;\n    }\n\n    if (inputMutations?.steps) {\n      this.state.opStack = [...inputMutations.steps];\n    }\n  }\n\n  private getEarlyExecRunStep(ops: OutgoingOp[]): string | undefined {\n    if (ops.length !== 1) return;\n\n    const op = ops[0];\n\n    if (\n      op &&\n      op.op === StepOpCode.StepPlanned\n      // TODO We must individually check properties here that we do not want to\n      // execute on, such as retry counts. Nothing exists here that falls in to\n      // this case, but should be accounted for when we add them.\n      // && typeof op.opts === \"undefined\"\n    ) {\n      return op.id;\n    }\n\n    return;\n  }\n\n  /**\n   * Using middleware, transform output before returning.\n   */\n  private async transformOutput(\n    dataOrError: Parameters<\n      NonNullable<RunHookStack[\"transformOutput\"]>\n    >[0][\"result\"],\n    step?: Readonly<Omit<OutgoingOp, \"id\">>,\n  ): Promise<ExecutionResult> {\n    const output = { ...dataOrError };\n\n    if (typeof output.error !== \"undefined\") {\n      output.data = serializeError(output.error);\n    }\n\n    const transformedOutput = await this.state.hooks?.transformOutput?.({\n      result: { ...output },\n      step,\n    });\n\n    const { data, error } = { ...output, ...transformedOutput?.result };\n\n    if (!step) {\n      await this.state.hooks?.finished?.({\n        result: { ...(typeof error !== \"undefined\" ? { error } : { data }) },\n      });\n    }\n\n    if (typeof error !== \"undefined\") {\n      /**\n       * Ensure we give middleware the chance to decide on retriable behaviour\n       * by looking at the error returned from output transformation.\n       */\n      let retriable: boolean | string = !(error instanceof NonRetriableError);\n      if (retriable && error instanceof RetryAfterError) {\n        retriable = error.retryAfter;\n      }\n\n      const serializedError = serializeError(error);\n\n      return {\n        type: \"function-rejected\",\n        ctx: this.fnArg,\n        ops: this.ops,\n        error: serializedError,\n        retriable,\n      };\n    }\n\n    return {\n      type: \"function-resolved\",\n      ctx: this.fnArg,\n      ops: this.ops,\n      data: undefinedToNull(data),\n    };\n  }\n}\n\ninterface TickOp extends HashedOp {\n  rawArgs: unknown[];\n  fn?: (...args: unknown[]) => unknown;\n  fulfilled: boolean;\n  resolve: (value: MaybePromise<unknown>) => void;\n  reject: (reason?: unknown) => void;\n}\n\nexport interface V0ExecutionState {\n  /**\n   * The tree of all found ops in the entire invocation.\n   */\n  allFoundOps: Record<string, TickOp>;\n\n  /**\n   * All synchronous operations found in this particular tick. The array is\n   * reset every tick.\n   */\n  tickOps: Record<string, TickOp>;\n\n  /**\n   * A hash of operations found within this tick, with keys being the hashed\n   * ops themselves (without a position) and the values being the number of\n   * times that op has been found.\n   *\n   * This is used to provide some mutation resilience to the op stack,\n   * allowing us to survive same-tick mutations of code by ensuring per-tick\n   * hashes are based on uniqueness rather than order.\n   */\n  tickOpHashes: Record<string, number>;\n\n  /**\n   * Tracks the current operation being processed. This can be used to\n   * understand the contextual parent of any recorded operations.\n   */\n  currentOp: TickOp | undefined;\n\n  /**\n   * If we've found a user function to run, we'll store it here so a component\n   * higher up can invoke and await it.\n   */\n  userFnToRun?: (...args: unknown[]) => unknown;\n\n  /**\n   * A boolean to represent whether the user's function is using any step\n   * tools.\n   *\n   * If the function survives an entire tick of the event loop and hasn't\n   * touched any tools, we assume that it is a single-step async function and\n   * should be awaited as usual.\n   */\n  hasUsedTools: boolean;\n\n  /**\n   * A function that should be used to reset the state of the tools after a\n   * tick has completed.\n   */\n  reset: () => void;\n\n  /**\n   * If `true`, any use of step tools will, by default, throw an error. We do\n   * this when we detect that a function may be mixing step and non-step code.\n   *\n   * Created step tooling can decide how to manually handle this on a\n   * case-by-case basis.\n   *\n   * In the future, we can provide a way for a user to override this if they\n   * wish to and understand the danger of side-effects.\n   *\n   * Defaults to `false`.\n   */\n  nonStepFnDetected: boolean;\n\n  /**\n   * When true, we are currently executing a user's code for a single step\n   * within a step function.\n   */\n  executingStep: boolean;\n\n  /**\n   * Initialized middleware hooks for this execution.\n   *\n   * Middleware hooks are cached to ensure they can only be run once, which\n   * means that these hooks can be called in many different places to ensure we\n   * handle all possible execution paths.\n   */\n  hooks?: RunHookStack;\n\n  /**\n   * The op stack to pass to the function as state, likely stored in\n   * `ctx._state` in the Inngest payload.\n   *\n   * This must be provided in order to always be cognizant of step function\n   * state and to allow for multi-step functions.\n   */\n  opStack: OpStack;\n}\n\nconst tickOpToOutgoing = (op: TickOp): OutgoingOp => {\n  return {\n    op: op.op,\n    id: op.id,\n    name: op.name,\n    opts: op.opts,\n  };\n};\n\n/**\n * An operation ready to hash to be used to memoise step function progress.\n *\n * @internal\n */\nexport type UnhashedOp = {\n  name: string;\n  op: StepOpCode;\n  opts: Record<string, unknown> | null;\n  parent: string | null;\n  pos?: number;\n};\n\nconst hashData = (op: UnhashedOp): string => {\n  return sha1().update(canonicalize(op)).digest(\"hex\");\n};\n\n/**\n * Exported for testing.\n */\nexport const _internals = { hashData };\n","/**\n * An error that, when thrown, indicates to Inngest that the function should\n * cease all execution and not retry.\n *\n * A `message` must be provided, and an optional `cause` can be provided to\n * provide more context to the error.\n *\n * @public\n */\nexport class NonRetriableError extends Error {\n  /**\n   * The underlying cause of the error, if any.\n   *\n   * This will be serialized and sent to Inngest.\n   */\n  public override readonly cause?: unknown;\n\n  constructor(\n    message: string,\n    options?: {\n      /**\n       * The underlying cause of the error, if any.\n       *\n       * This will be serialized and sent to Inngest.\n       */\n      cause?: unknown;\n    },\n  ) {\n    super(message);\n\n    this.cause = options?.cause;\n\n    this.name = \"NonRetriableError\";\n  }\n}\n","import type { MaybePromise } from \"./types.ts\";\n\n/**\n * Some environments don't allow access to the global queueMicrotask(). While we\n * had assumed this was only true for those powered by earlier versions of Node\n * (<14) that we don't officially support, Vercel's Edge Functions also obscure\n * the function in dev, even though the platform it's based on (Cloudflare\n * Workers) appropriately exposes it. Even worse, production Vercel Edge\n * Functions can see the function, but it immediately blows up the function when\n * used.\n *\n * Therefore, we can fall back to a reasonable alternative of\n * `Promise.resolve().then(fn)` instead. This _may_ be slightly slower in modern\n * environments, but at least we can still work in these environments.\n */\nconst shimQueueMicrotask = (callback: () => void): void => {\n  void Promise.resolve().then(callback);\n};\n\n/**\n * A helper function to create a `Promise` that will never settle.\n *\n * It purposefully creates no references to `resolve` or `reject` so that the\n * returned `Promise` will remain unsettled until it falls out of scope and is\n * garbage collected.\n *\n * This should be used within transient closures to fake asynchronous action, so\n * long as it's guaranteed that they will fall out of scope.\n */\nexport const createFrozenPromise = (): Promise<unknown> => {\n  return new Promise(() => undefined);\n};\n\n/**\n * Returns a Promise that resolves after the current event loop's microtasks\n * have finished, but before the next event loop tick.\n */\nexport const resolveAfterPending = (count = 100): Promise<void> => {\n  /**\n   * This uses a brute force implementation that will continue to enqueue\n   * microtasks 10 times before resolving. This is to ensure that the microtask\n   * queue is drained, even if the microtask queue is being manipulated by other\n   * code.\n   *\n   * While this still doesn't guarantee that the microtask queue is drained,\n   * it's our best bet for giving other non-controlled promises a chance to\n   * resolve before we continue without resorting to falling in to the next\n   * tick.\n   */\n  return new Promise((resolve) => {\n    let i = 0;\n\n    const iterate = () => {\n      shimQueueMicrotask(() => {\n        if (i++ > count) {\n          return resolve();\n        }\n\n        iterate();\n      });\n    };\n\n    iterate();\n  });\n};\n\ntype DeferredPromiseReturn<T> = {\n  promise: Promise<T>;\n  resolve: (value: T) => DeferredPromiseReturn<T>;\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n  reject: (reason: any) => DeferredPromiseReturn<T>;\n};\n\n/**\n * Creates and returns Promise that can be resolved or rejected with the\n * returned `resolve` and `reject` functions.\n *\n * Resolving or rejecting the function will return a new set of Promise control\n * functions. These can be ignored if the original Promise is all that's needed.\n */\nexport const createDeferredPromise = <T>(): DeferredPromiseReturn<T> => {\n  let resolve: DeferredPromiseReturn<T>[\"resolve\"];\n  let reject: DeferredPromiseReturn<T>[\"reject\"];\n\n  const promise = new Promise<T>((_resolve, _reject) => {\n    resolve = (value: T) => {\n      _resolve(value);\n      return createDeferredPromise<T>();\n    };\n\n    reject = (reason) => {\n      _reject(reason);\n      return createDeferredPromise<T>();\n    };\n  });\n\n  return { promise, resolve: resolve!, reject: reject! };\n};\n\n/**\n * Creates and returns a deferred Promise that can be resolved or rejected with\n * the returned `resolve` and `reject` functions.\n *\n * For each Promise resolved or rejected this way, this will also keep a stack\n * of all unhandled Promises, resolved or rejected.\n *\n * Once a Promise is read, it is removed from the stack.\n */\nexport const createDeferredPromiseWithStack = <T>(): {\n  deferred: DeferredPromiseReturn<T>;\n  results: AsyncGenerator<Awaited<T>, void, void>;\n} => {\n  const settledPromises: Promise<T>[] = [];\n  // biome-ignore lint/suspicious/noConfusingVoidType: <explanation>\n  let rotateQueue: (value: void) => void = () => {};\n\n  const results = (async function* () {\n    while (true) {\n      const next = settledPromises.shift();\n\n      if (next) {\n        yield next;\n      } else {\n        await new Promise<void>((resolve) => {\n          rotateQueue = resolve;\n        });\n      }\n    }\n  })();\n\n  const shimDeferredPromise = (deferred: DeferredPromiseReturn<T>) => {\n    const originalResolve = deferred.resolve;\n    const originalReject = deferred.reject;\n\n    deferred.resolve = (value: T) => {\n      settledPromises.push(deferred.promise);\n      rotateQueue();\n      return shimDeferredPromise(originalResolve(value));\n    };\n\n    deferred.reject = (reason) => {\n      settledPromises.push(deferred.promise);\n      rotateQueue();\n      return shimDeferredPromise(originalReject(reason));\n    };\n\n    return deferred;\n  };\n\n  const deferred = shimDeferredPromise(createDeferredPromise<T>());\n\n  return { deferred, results };\n};\n\ninterface TimeoutPromise extends Promise<void> {\n  /**\n   * Starts the timeout. If the timer is already started, this does nothing.\n   *\n   * @returns The promise that will resolve when the timeout expires.\n   */\n  start: () => TimeoutPromise;\n\n  /**\n   * Clears the timeout.\n   */\n  clear: () => void;\n\n  /**\n   * Clears the timeout and starts it again.\n   *\n   * @returns The promise that will resolve when the timeout expires.\n   */\n  reset: () => TimeoutPromise;\n}\n\n/**\n * Creates a Promise that will resolve after the given duration, along with\n * methods to start, clear, and reset the timeout.\n */\nexport const createTimeoutPromise = (duration: number): TimeoutPromise => {\n  const { promise, resolve } = createDeferredPromise<void>();\n\n  let timeout: ReturnType<typeof setTimeout> | undefined;\n  // biome-ignore lint/style/useConst: <explanation>\n  let ret: TimeoutPromise;\n\n  const start = () => {\n    if (timeout) return ret;\n\n    timeout = setTimeout(() => {\n      resolve();\n    }, duration);\n\n    return ret;\n  };\n\n  const clear = () => {\n    clearTimeout(timeout);\n    timeout = undefined;\n  };\n\n  const reset = () => {\n    clear();\n    return start();\n  };\n\n  ret = Object.assign(promise, { start, clear, reset });\n\n  return ret;\n};\n\n/**\n * Take any function and safely promisify such that both synchronous and\n * asynchronous errors are caught and returned as a rejected Promise.\n *\n * The passed `fn` can be undefined to support functions that may conditionally\n * be defined.\n */\n// biome-ignore lint/suspicious/noExplicitAny: <explanation>\nexport const runAsPromise = <T extends (() => any) | undefined>(\n  fn: T,\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n): Promise<T extends () => any ? Awaited<ReturnType<T>> : T> => {\n  return Promise.resolve().then(fn);\n};\n\n/**\n * Returns a Promise that resolve after the current event loop tick.\n */\nexport const resolveNextTick = (): Promise<void> => {\n  return new Promise((resolve) => setTimeout(resolve));\n};\n\nexport const retryWithBackoff = async <T>(\n  fn: () => MaybePromise<T>,\n  opts?: {\n    maxAttempts?: number;\n    baseDelay?: number;\n  },\n): Promise<T> => {\n  const maxAttempts = opts?.maxAttempts || 5;\n  const baseDelay = opts?.baseDelay ?? 100;\n\n  for (let attempt = 1; attempt <= maxAttempts; attempt++) {\n    try {\n      return await fn();\n    } catch (err) {\n      if (attempt >= maxAttempts) {\n        throw err;\n      }\n\n      const jitter = Math.random() * baseDelay;\n      const delay = baseDelay * Math.pow(2, attempt - 1) + jitter;\n      await new Promise((resolve) => setTimeout(resolve, delay));\n    }\n  }\n\n  throw new Error(\"Max retries reached; this should be unreachable.\");\n};\n","import chalk from \"chalk\";\nimport stringify from \"json-stringify-safe\";\nimport {\n  type SerializedError as CjsSerializedError,\n  deserializeError as cjsDeserializeError,\n  serializeError as cjsSerializeError,\n  errorConstructors,\n} from \"serialize-error-cjs\";\nimport stripAnsi from \"strip-ansi\";\nimport { z } from \"zod/v3\";\nimport type { Inngest } from \"../components/Inngest.ts\";\nimport { NonRetriableError } from \"../components/NonRetriableError.ts\";\nimport type { ClientOptions, OutgoingOp } from \"../types.ts\";\n\nconst SERIALIZED_KEY = \"__serialized\";\nconst SERIALIZED_VALUE = true;\n\n/**\n * Add first-class support for certain errors that we control, in addition to\n * built-in errors such as `TypeError`.\n *\n * Adding these allows these non-standard errors to be correctly serialized,\n * sent to Inngest, then deserialized back into the correct error type for users\n * to react to correctly.\n *\n * Note that these errors only support `message?: string | undefined` as the\n * input; more custom errors are not supported with this current strategy.\n */\nerrorConstructors.set(\n  \"NonRetriableError\",\n  NonRetriableError as ErrorConstructor,\n);\n\nexport interface SerializedError extends Readonly<CjsSerializedError> {\n  readonly [SERIALIZED_KEY]: typeof SERIALIZED_VALUE;\n}\n\n/**\n * Serialise an error to a serialized JSON string.\n *\n * Errors do not serialise nicely to JSON, so we use this function to convert\n * them to a serialized JSON string. Doing this is also non-trivial for some\n * errors, so we use the `serialize-error` package to do it for us.\n *\n * See {@link https://www.npmjs.com/package/serialize-error}\n *\n * This function is a small wrapper around that package to also add a `type`\n * property to the serialised error, so that we can distinguish between\n * serialised errors and other objects.\n *\n * Will not reserialise existing serialised errors.\n */\nexport const serializeError = <\n  TAllowUnknown extends boolean = false,\n  TOutput extends TAllowUnknown extends true\n    ? unknown\n    : SerializedError = TAllowUnknown extends true ? unknown : SerializedError,\n>(\n  /**\n   * The suspected error to serialize.\n   */\n  subject: unknown,\n\n  /**\n   * If `true` and the error is not serializable, will return the original value\n   * as `unknown` instead of coercing it to a serialized error.\n   */\n  allowUnknown: TAllowUnknown = false as TAllowUnknown,\n): TOutput => {\n  try {\n    // Try to understand if this is already done.\n    // Will handle stringified errors.\n    const existingSerializedError = isSerializedError(subject);\n\n    if (existingSerializedError) {\n      return existingSerializedError as TOutput;\n    }\n\n    if (typeof subject === \"object\" && subject !== null) {\n      // Is an object, so let's try and serialize it.\n      const serializedErr = cjsSerializeError(subject as Error);\n\n      // Not a proper error was caught, so give us a chance to return `unknown`.\n      if (!serializedErr.name && allowUnknown) {\n        return subject as TOutput;\n      }\n\n      // Serialization can succeed but assign no name or message, so we'll\n      // map over the result here to ensure we have everything.\n      // We'll just stringify the entire subject for the message, as this at\n      // least provides some context for the user.\n      const ret = {\n        // Ensure we spread to also capture additional properties such as\n        // `cause`.\n        ...serializedErr,\n\n        name: serializedErr.name || \"Error\",\n        message:\n          serializedErr.message ||\n          stringify(subject) ||\n          \"Unknown error; error serialization could not find a message.\",\n        stack: serializedErr.stack || \"\",\n        [SERIALIZED_KEY]: SERIALIZED_VALUE,\n      } as const;\n\n      // If we have a cause, make sure we recursively serialize them too. We are\n      // lighter with causes though; attempt to recursively serialize them, but\n      // stop if we find something that doesn't work and just return `unknown`.\n      let target: unknown = ret;\n      const maxDepth = 5;\n      for (let i = 0; i < maxDepth; i++) {\n        if (\n          typeof target === \"object\" &&\n          target !== null &&\n          \"cause\" in target &&\n          target.cause\n        ) {\n          target = target.cause = serializeError(target.cause, true);\n          continue;\n        }\n\n        break;\n      }\n\n      return ret as TOutput;\n    }\n\n    // If it's not an object, it's hard to parse this as an Error. In this case,\n    // we'll throw an error to start attempting backup strategies.\n    throw new Error(\"Error is not an object; strange throw value.\");\n  } catch {\n    if (allowUnknown) {\n      // If we are allowed to return unknown, we'll just return the original\n      // value.\n      return subject as TOutput;\n    }\n\n    try {\n      // If serialization fails, fall back to a regular Error and use the\n      // original object as the message for an Error. We don't know what this\n      // object looks like, so we can't do anything else with it.\n      return {\n        ...serializeError(\n          new Error(typeof subject === \"string\" ? subject : stringify(subject)),\n          false,\n        ),\n        // Remove the stack; it's not relevant here\n        stack: \"\",\n        [SERIALIZED_KEY]: SERIALIZED_VALUE,\n      } as TOutput;\n    } catch {\n      // If this failed, then stringifying the object also failed, so we'll just\n      // return a completely generic error.\n      // Failing to stringify the object is very unlikely.\n      return {\n        name: \"Could not serialize source error\",\n        message: \"Serializing the source error failed.\",\n        stack: \"\",\n        [SERIALIZED_KEY]: SERIALIZED_VALUE,\n      } as TOutput;\n    }\n  }\n};\n\n/**\n * Check if an object or a string is a serialised error created by\n * {@link serializeError}.\n */\nexport const isSerializedError = (\n  value: unknown,\n): SerializedError | undefined => {\n  try {\n    if (typeof value === \"string\") {\n      const parsed = z\n        .object({\n          [SERIALIZED_KEY]: z.literal(SERIALIZED_VALUE),\n          name: z.enum([...Array.from(errorConstructors.keys())] as [\n            string,\n            ...string[],\n          ]),\n          message: z.string(),\n          stack: z.string(),\n        })\n        .passthrough()\n        .safeParse(JSON.parse(value));\n\n      if (parsed.success) {\n        return parsed.data as SerializedError;\n      }\n    }\n\n    if (typeof value === \"object\" && value !== null) {\n      const objIsSerializedErr =\n        Object.hasOwn(value, SERIALIZED_KEY) &&\n        (value as { [SERIALIZED_KEY]: unknown })[SERIALIZED_KEY] ===\n          SERIALIZED_VALUE;\n\n      if (objIsSerializedErr) {\n        return value as SerializedError;\n      }\n    }\n  } catch {\n    // no-op; we'll return undefined if parsing failed, as it isn't a serialized\n    // error\n  }\n\n  return;\n};\n\n/**\n * Deserialise an error created by {@link serializeError}.\n *\n * Ensures we only deserialise errors that meet a minimum level of\n * applicability, inclusive of error handling to ensure that badly serialized\n * errors are still handled.\n */\nexport const deserializeError = <\n  TAllowUnknown extends boolean = false,\n  TOutput extends TAllowUnknown extends true\n    ? unknown\n    : Error = TAllowUnknown extends true ? unknown : Error,\n>(\n  subject: Partial<SerializedError>,\n  allowUnknown: TAllowUnknown = false as TAllowUnknown,\n): TOutput => {\n  const requiredFields: (keyof SerializedError)[] = [\"name\", \"message\"];\n\n  try {\n    const hasRequiredFields = requiredFields.every((field) => {\n      return Object.hasOwn(subject, field);\n    });\n\n    if (!hasRequiredFields) {\n      throw new Error();\n    }\n\n    const deserializedErr = cjsDeserializeError(subject as SerializedError);\n\n    if (\"cause\" in deserializedErr) {\n      deserializedErr.cause = deserializeError(\n        deserializedErr.cause as Partial<SerializedError>,\n        true,\n      );\n    }\n\n    return deserializedErr as TOutput;\n  } catch {\n    if (allowUnknown) {\n      // If we are allowed to return unknown, we'll just return the original\n      // value.\n      return subject as TOutput;\n    }\n\n    const err = new Error(\"Unknown error; could not reserialize\");\n\n    /**\n     * Remove the stack so that it's not misleadingly shown as the Inngest\n     * internals.\n     */\n    err.stack = undefined;\n\n    return err as TOutput;\n  }\n};\n\nexport enum ErrCode {\n  NESTING_STEPS = \"NESTING_STEPS\",\n\n  /**\n   * Legacy v0 execution error code for when a function has changed and no\n   * longer matches its in-progress state.\n   *\n   * @deprecated Not for use in latest execution method.\n   */\n  NON_DETERMINISTIC_FUNCTION = \"NON_DETERMINISTIC_FUNCTION\",\n\n  /**\n   * Legacy v0 execution error code for when a function is found to be using\n   * async actions after memoziation has occurred, which v0 doesn't support.\n   *\n   * @deprecated Not for use in latest execution method.\n   */\n  ASYNC_DETECTED_AFTER_MEMOIZATION = \"ASYNC_DETECTED_AFTER_MEMOIZATION\",\n\n  /**\n   * Legacy v0 execution error code for when a function is found to be using\n   * steps after a non-step async action has occurred.\n   *\n   * @deprecated Not for use in latest execution method.\n   */\n  STEP_USED_AFTER_ASYNC = \"STEP_USED_AFTER_ASYNC\",\n\n  AUTOMATIC_PARALLEL_INDEXING = \"AUTOMATIC_PARALLEL_INDEXING\",\n}\n\nexport interface PrettyError {\n  /**\n   * The type of message, used to decide on icon and color use.\n   */\n  type?: \"error\" | \"warn\";\n\n  /**\n   * A short, succinct description of what happened. Will be used as the error's\n   * header, so should be short and to the point with no trailing punctuation.\n   */\n  whatHappened: string;\n\n  /**\n   * If applicable, provide a full sentence to reassure the user about certain\n   * details, for example if an error occurred whilst uploading a file, but we\n   * can assure the user that uploading succeeded and something internal failed.\n   */\n  reassurance?: string;\n\n  /**\n   * Tell the user why the error happened if we can. This should be a full\n   * sentence or paragraph that explains the error in more detail, for example\n   * to explain that a file failed to upload because it was too large and that\n   * the maximum size is 10MB.\n   */\n  why?: string;\n\n  /**\n   * If applicable, tell the user what the consequences of the error are, for\n   * example to tell them that their file was not uploaded and that they will\n   * need to try again.\n   */\n  consequences?: string;\n\n  /**\n   * If we can, tell the user what they can do to fix the error now. This should\n   * be a full sentence or paragraph that explains what the user can do to fix\n   * the error, for example to tell them to try uploading a smaller file or\n   * upgrade to a paid plan.\n   */\n  toFixNow?: string | string[];\n\n  /**\n   * If applicable, tell the user what to do if the error persists, they want\n   * more information, or the fix we've given them doesn't work.\n   *\n   * This should be a full sentence or paragraph, and will likely refer users\n   * to contact us for support, join our Discord, or read documentation.\n   */\n  otherwise?: string;\n\n  /**\n   * Add a stack trace to the message so that the user knows what line of code\n   * the error is in relation to.\n   */\n  stack?: true;\n\n  /**\n   * If applicable, provide a code that the user can use to reference the error\n   * when contacting support.\n   */\n  code?: ErrCode;\n}\n\nexport const prettyErrorSplitter =\n  \"=================================================\";\n\n/**\n * Given an unknown `err`, mutate it to minify any pretty errors that it\n * contains.\n */\nexport const minifyPrettyError = <T>(err: T): T => {\n  try {\n    if (!isError(err)) {\n      return err;\n    }\n\n    const isPrettyError = err.message.includes(prettyErrorSplitter);\n    if (!isPrettyError) {\n      return err;\n    }\n\n    const sanitizedMessage = stripAnsi(err.message);\n\n    const message =\n      sanitizedMessage.split(\"  \")[1]?.split(\"\\n\")[0]?.trim() || err.message;\n    const code =\n      sanitizedMessage.split(\"\\n\\nCode: \")[1]?.split(\"\\n\\n\")[0]?.trim() ||\n      undefined;\n\n    err.message = [code, message].filter(Boolean).join(\" - \");\n\n    if (err.stack) {\n      const sanitizedStack = stripAnsi(err.stack);\n      const stackRest = sanitizedStack\n        .split(`${prettyErrorSplitter}\\n`)\n        .slice(2)\n        .join(\"\\n\");\n\n      err.stack = `${err.name}: ${err.message}\\n${stackRest}`;\n    }\n\n    return err;\n  } catch (_noopErr) {\n    return err;\n  }\n};\n\n/**\n * Given an `err`, return a boolean representing whether it is in the shape of\n * an `Error` or not.\n */\nconst isError = (err: unknown): err is Error => {\n  try {\n    if (err instanceof Error) {\n      return true;\n    }\n\n    if (typeof err !== \"object\" || err === null) {\n      return false;\n    }\n\n    const hasName = Object.hasOwn(err, \"name\");\n    const hasMessage = Object.hasOwn(err, \"message\");\n\n    return hasName && hasMessage;\n  } catch (_noopErr) {\n    return false;\n  }\n};\n\n/**\n * Given an `unknown` object, retrieve the `message` property from it, or fall\n * back to the `fallback` string if it doesn't exist or is empty.\n */\nexport const getErrorMessage = (err: unknown, fallback: string): string => {\n  const { message } = z\n    .object({ message: z.string().min(1) })\n    .catch({ message: fallback })\n    .parse(err);\n\n  return message;\n};\n\n/**\n * Given a {@link PrettyError}, return a nicely-formatted string ready to log\n * or throw.\n *\n * Useful for ensuring that errors are logged in a consistent, helpful format\n * across the SDK by prompting for key pieces of information.\n */\nexport const prettyError = ({\n  type = \"error\",\n  whatHappened,\n  otherwise,\n  reassurance,\n  toFixNow,\n  why,\n  consequences,\n  stack,\n  code,\n}: PrettyError): string => {\n  const { icon, colorFn } = (\n    {\n      error: { icon: \"âŒ\", colorFn: chalk.red },\n      warn: { icon: \"âš ï¸\", colorFn: chalk.yellow },\n    } satisfies Record<\n      NonNullable<PrettyError[\"type\"]>,\n      { icon: string; colorFn: (s: string) => string }\n    >\n  )[type];\n\n  let header = `${icon}  ${chalk.bold.underline(whatHappened.trim())}`;\n  if (stack) {\n    header +=\n      \"\\n\" +\n      [...(new Error().stack?.split(\"\\n\").slice(1).filter(Boolean) || [])].join(\n        \"\\n\",\n      );\n  }\n\n  let toFixNowStr =\n    (Array.isArray(toFixNow)\n      ? toFixNow\n          .map((s) => s.trim())\n          .filter(Boolean)\n          .map((s, i) => `\\t${i + 1}. ${s}`)\n          .join(\"\\n\")\n      : toFixNow?.trim()) ?? \"\";\n\n  if (Array.isArray(toFixNow) && toFixNowStr) {\n    toFixNowStr = `To fix this, you can take one of the following courses of action:\\n\\n${toFixNowStr}`;\n  }\n\n  let body = [reassurance?.trim(), why?.trim(), consequences?.trim()]\n    .filter(Boolean)\n    .join(\" \");\n  body += body ? `\\n\\n${toFixNowStr}` : toFixNowStr;\n\n  const trailer = [otherwise?.trim()].filter(Boolean).join(\" \");\n\n  const message = [\n    prettyErrorSplitter,\n    header,\n    body,\n    trailer,\n    code ? `Code: ${code}` : \"\",\n    prettyErrorSplitter,\n  ]\n    .filter(Boolean)\n    .join(\"\\n\\n\");\n\n  return colorFn(message);\n};\n\nexport const fixEventKeyMissingSteps = [\n  \"Set the `INNGEST_EVENT_KEY` environment variable\",\n  `Pass a key to the \\`new Inngest()\\` constructor using the \\`${\n    \"eventKey\" satisfies keyof ClientOptions\n  }\\` option`,\n  `Use \\`inngest.${\"setEventKey\" satisfies keyof Inngest.Any}()\\` at runtime`,\n];\n\n/**\n * An error that, when thrown, indicates internally that an outgoing operation\n * contains an error.\n *\n * We use this because serialized `data` sent back to Inngest may differ from\n * the error instance itself due to middleware.\n *\n * @internal\n */\nexport class OutgoingResultError extends Error {\n  public readonly result: Pick<OutgoingOp, \"data\" | \"error\">;\n\n  constructor(result: Pick<OutgoingOp, \"data\" | \"error\">) {\n    super(\"OutgoingOpError\");\n    this.result = result;\n  }\n}\n\n/**\n * Create a function that will rethrow an error with a prefix added to the\n * message.\n *\n * Useful for adding context to errors that are rethrown.\n *\n * @example\n * ```ts\n * await doSomeAction().catch(rethrowError(\"Failed to do some action\"));\n * ```\n */\n// biome-ignore lint/suspicious/noExplicitAny: <explanation>\nexport const rethrowError = (prefix: string): ((err: any) => never) => {\n  return (err) => {\n    try {\n      err.message &&= `${prefix}; ${err.message}`;\n    } catch (_noopErr) {\n      // no-op\n    } finally {\n      // biome-ignore lint/correctness/noUnsafeFinally: <explanation>\n      throw err;\n    }\n  };\n};\n\n/**\n * Legacy v0 execution error for functions that don't support mixing steps and\n * regular async actions.\n */\nexport const functionStoppedRunningErr = (code: ErrCode) => {\n  return prettyError({\n    whatHappened: \"Your function was stopped from running\",\n    why: \"We detected a mix of asynchronous logic, some using step tooling and some not.\",\n    consequences:\n      \"This can cause unexpected behaviour when a function is paused and resumed and is therefore strongly discouraged; we stopped your function to ensure nothing unexpected happened!\",\n    stack: true,\n    toFixNow:\n      \"Ensure that your function is either entirely step-based or entirely non-step-based, by either wrapping all asynchronous logic in `step.run()` calls or by removing all `step.*()` calls.\",\n    otherwise:\n      \"For more information on why step functions work in this manner, see https://www.inngest.com/docs/functions/multi-step#gotchas\",\n    code,\n  });\n};\n","import { trace } from \"@opentelemetry/api\";\nimport hashjs from \"hash.js\";\nimport { z } from \"zod/v3\";\nimport { headerKeys, internalEvents } from \"../../helpers/consts.ts\";\nimport {\n  deserializeError,\n  ErrCode,\n  minifyPrettyError,\n  prettyError,\n  serializeError,\n} from \"../../helpers/errors.js\";\nimport { undefinedToNull } from \"../../helpers/functions.js\";\nimport {\n  createDeferredPromise,\n  createDeferredPromiseWithStack,\n  createTimeoutPromise,\n  runAsPromise,\n} from \"../../helpers/promises.ts\";\nimport type { MaybePromise, Simplify } from \"../../helpers/types.ts\";\nimport {\n  type BaseContext,\n  type Context,\n  type EventPayload,\n  type FailureEventArgs,\n  type Handler,\n  jsonErrorSchema,\n  type OutgoingOp,\n  StepOpCode,\n} from \"../../types.ts\";\nimport { version } from \"../../version.ts\";\nimport type { Inngest } from \"../Inngest.ts\";\nimport { getHookStack, type RunHookStack } from \"../InngestMiddleware.ts\";\nimport {\n  createStepTools,\n  type FoundStep,\n  getStepOptions,\n  invokePayloadSchema,\n  STEP_INDEXING_SUFFIX,\n  type StepHandler,\n} from \"../InngestStepTools.ts\";\nimport { NonRetriableError } from \"../NonRetriableError.ts\";\nimport { RetryAfterError } from \"../RetryAfterError.ts\";\nimport { StepError } from \"../StepError.ts\";\nimport { getAsyncCtx, getAsyncLocalStorage } from \"./als.ts\";\nimport {\n  type ExecutionResult,\n  type IInngestExecution,\n  InngestExecution,\n  type InngestExecutionFactory,\n  type InngestExecutionOptions,\n  type MemoizedOp,\n} from \"./InngestExecution.ts\";\nimport { clientProcessorMap } from \"./otel/access.ts\";\n\nconst { sha1 } = hashjs;\n\nexport const createV2InngestExecution: InngestExecutionFactory = (options) => {\n  return new V2InngestExecution(options);\n};\n\nclass V2InngestExecution extends InngestExecution implements IInngestExecution {\n  private state: V2ExecutionState;\n  private fnArg: Context.Any;\n  private checkpointHandlers: CheckpointHandlers;\n  private timeoutDuration = 1000 * 10;\n  private execution: Promise<ExecutionResult> | undefined;\n  private userFnToRun: Handler.Any;\n\n  /**\n   * If we're supposed to run a particular step via `requestedRunStep`, this\n   * will be a `Promise` that resolves after no steps have been found for\n   * `timeoutDuration` milliseconds.\n   *\n   * If we're not supposed to run a particular step, this will be `undefined`.\n   */\n  private timeout?: ReturnType<typeof createTimeoutPromise>;\n\n  constructor(options: InngestExecutionOptions) {\n    super(options);\n\n    this.userFnToRun = this.getUserFnToRun();\n    this.state = this.createExecutionState();\n    this.fnArg = this.createFnArg();\n    this.checkpointHandlers = this.createCheckpointHandlers();\n    this.initializeTimer(this.state);\n\n    this.debug(\n      \"created new V2 execution for run;\",\n      this.options.requestedRunStep\n        ? `wanting to run step \"${this.options.requestedRunStep}\"`\n        : \"discovering steps\",\n    );\n\n    this.debug(\"existing state keys:\", Object.keys(this.state.stepState));\n  }\n\n  /**\n   * Idempotently start the execution of the user's function.\n   */\n  public start() {\n    if (!this.execution) {\n      this.debug(\"starting V2 execution\");\n\n      const tracer = trace.getTracer(\"inngest\", version);\n\n      this.execution = getAsyncLocalStorage().then((als) => {\n        return als.run(\n          { app: this.options.client, ctx: this.fnArg },\n          async () => {\n            return tracer.startActiveSpan(\"inngest.execution\", (span) => {\n              clientProcessorMap.get(this.options.client)?.declareStartingSpan({\n                span,\n                runId: this.options.runId,\n                traceparent: this.options.headers[headerKeys.TraceParent],\n                tracestate: this.options.headers[headerKeys.TraceState],\n              });\n\n              return this._start()\n                .then((result) => {\n                  this.debug(\"result:\", result);\n                  return result;\n                })\n                .finally(() => {\n                  span.end();\n                });\n            });\n          },\n        );\n      });\n    }\n\n    return this.execution;\n  }\n\n  /**\n   * Starts execution of the user's function and the core loop.\n   */\n  private async _start(): Promise<ExecutionResult> {\n    try {\n      const allCheckpointHandler = this.getCheckpointHandler(\"\");\n      this.state.hooks = await this.initializeMiddleware();\n      await this.startExecution();\n\n      for await (const checkpoint of this.state.loop) {\n        await allCheckpointHandler(checkpoint);\n\n        const handler = this.getCheckpointHandler(checkpoint.type);\n        const result = await handler(checkpoint);\n\n        if (result) {\n          return result;\n        }\n      }\n    } catch (error) {\n      return await this.transformOutput({ error });\n    } finally {\n      void this.state.loop.return();\n      await this.state.hooks?.beforeResponse?.();\n    }\n\n    /**\n     * If we're here, the generator somehow finished without returning a value.\n     * This should never happen.\n     */\n    throw new Error(\"Core loop finished without returning a value\");\n  }\n\n  /**\n   * Creates a handler for every checkpoint type, defining what to do when we\n   * reach that checkpoint in the core loop.\n   */\n  private createCheckpointHandlers(): CheckpointHandlers {\n    return {\n      /**\n       * Run for all checkpoints. Best used for logging or common actions.\n       * Use other handlers to return values and interrupt the core loop.\n       */\n      \"\": (checkpoint) => {\n        this.debug(\"checkpoint:\", checkpoint);\n      },\n\n      /**\n       * The user's function has completed and returned a value.\n       */\n      \"function-resolved\": async (checkpoint) => {\n        return await this.transformOutput({ data: checkpoint.data });\n      },\n\n      /**\n       * The user's function has thrown an error.\n       */\n      \"function-rejected\": async (checkpoint) => {\n        return await this.transformOutput({ error: checkpoint.error });\n      },\n\n      /**\n       * We've found one or more steps. Here we may want to run a step or report\n       * them back to Inngest.\n       */\n      \"steps-found\": async ({ steps }) => {\n        const stepResult = await this.tryExecuteStep(steps);\n        if (stepResult) {\n          const transformResult = await this.transformOutput(stepResult);\n\n          /**\n           * Transforming output will always return either function rejection or\n           * resolution. In most cases, this can be immediately returned, but in\n           * this particular case we want to handle it differently.\n           */\n          if (transformResult.type === \"function-resolved\") {\n            return {\n              type: \"step-ran\",\n              ctx: transformResult.ctx,\n              ops: transformResult.ops,\n              step: _internals.hashOp({\n                ...stepResult,\n                data: transformResult.data,\n              }),\n            };\n          } else if (transformResult.type === \"function-rejected\") {\n            const stepForResponse = _internals.hashOp({\n              ...stepResult,\n              error: transformResult.error,\n            });\n\n            if (stepResult.op === StepOpCode.StepFailed) {\n              const ser = serializeError(transformResult.error);\n              stepForResponse.data = {\n                __serialized: true,\n                name: ser.name,\n                message: ser.message,\n                stack: \"\",\n              };\n            }\n\n            return {\n              type: \"step-ran\",\n              ctx: transformResult.ctx,\n              ops: transformResult.ops,\n              retriable: transformResult.retriable,\n              step: stepForResponse,\n            };\n          }\n\n          return transformResult;\n        }\n\n        const newSteps = await this.filterNewSteps(\n          Array.from(this.state.steps.values()),\n        );\n        if (newSteps) {\n          return {\n            type: \"steps-found\",\n            ctx: this.fnArg,\n            ops: this.ops,\n            steps: newSteps,\n          };\n        }\n\n        return;\n      },\n\n      /**\n       * While trying to find a step that Inngest has told us to run, we've\n       * timed out or have otherwise decided that it doesn't exist.\n       */\n      \"step-not-found\": ({ step }) => {\n        return { type: \"step-not-found\", ctx: this.fnArg, ops: this.ops, step };\n      },\n    };\n  }\n\n  private getCheckpointHandler(type: keyof CheckpointHandlers) {\n    return this.checkpointHandlers[type] as (\n      checkpoint: Checkpoint,\n    ) => MaybePromise<ExecutionResult | undefined>;\n  }\n\n  private async tryExecuteStep(\n    steps: FoundStep[],\n  ): Promise<OutgoingOp | undefined> {\n    const hashedStepIdToRun =\n      this.options.requestedRunStep || this.getEarlyExecRunStep(steps);\n    if (!hashedStepIdToRun) {\n      return;\n    }\n\n    const step = steps.find(\n      (step) => step.hashedId === hashedStepIdToRun && step.fn,\n    );\n\n    if (step) {\n      return await this.executeStep(step);\n    }\n\n    /**\n     * Ensure we reset the timeout if we have a requested run step but couldn't\n     * find it, but also that we don't reset if we found and executed it.\n     */\n    return void this.timeout?.reset();\n  }\n\n  /**\n   * Given a list of outgoing ops, decide if we can execute an op early and\n   * return the ID of the step to execute if we can.\n   */\n  private getEarlyExecRunStep(steps: FoundStep[]): string | undefined {\n    /**\n     * We may have been disabled due to parallelism, in which case we can't\n     * immediately execute unless explicitly requested.\n     */\n    if (this.options.disableImmediateExecution) return;\n\n    const unfulfilledSteps = steps.filter((step) => !step.fulfilled);\n    if (unfulfilledSteps.length !== 1) return;\n\n    const op = unfulfilledSteps[0];\n\n    if (\n      op &&\n      op.op === StepOpCode.StepPlanned\n      // TODO We must individually check properties here that we do not want to\n      // execute on, such as retry counts. Nothing exists here that falls in to\n      // this case, but should be accounted for when we add them.\n      // && typeof op.opts === \"undefined\"\n    ) {\n      return op.hashedId;\n    }\n\n    return;\n  }\n\n  private async filterNewSteps(\n    foundSteps: FoundStep[],\n  ): Promise<[OutgoingOp, ...OutgoingOp[]] | undefined> {\n    if (this.options.requestedRunStep) {\n      return;\n    }\n\n    /**\n     * Gather any steps that aren't memoized and report them.\n     */\n    const newSteps = foundSteps.filter((step) => !step.fulfilled);\n\n    if (!newSteps.length) {\n      return;\n    }\n\n    /**\n     * Warn if we've found new steps but haven't yet seen all previous\n     * steps. This may indicate that step presence isn't determinate.\n     */\n    let knownSteps = 0;\n    for (const step of foundSteps) {\n      if (step.fulfilled) {\n        knownSteps++;\n      }\n    }\n    const foundAllCompletedSteps = this.state.stepsToFulfill === knownSteps;\n\n    if (!foundAllCompletedSteps) {\n      // TODO Tag\n      console.warn(\n        prettyError({\n          type: \"warn\",\n          whatHappened: \"Function may be indeterminate\",\n          why: \"We found new steps before seeing all previous steps, which may indicate that the function is non-deterministic.\",\n          consequences:\n            \"This may cause unexpected behaviour as Inngest executes your function.\",\n          reassurance:\n            \"This is expected if a function is updated in the middle of a run, but may indicate a bug if not.\",\n        }),\n      );\n    }\n\n    /**\n     * We're finishing up; let's trigger the last of the hooks.\n     */\n    await this.state.hooks?.afterMemoization?.();\n    await this.state.hooks?.beforeExecution?.();\n    await this.state.hooks?.afterExecution?.();\n\n    const stepList = newSteps.map<OutgoingOp>((step) => ({\n      displayName: step.displayName,\n      op: step.op,\n      id: step.hashedId,\n      name: step.name,\n      opts: step.opts,\n    })) as [OutgoingOp, ...OutgoingOp[]];\n\n    /**\n     * We also run `onSendEvent` middleware hooks against `step.invoke()` steps\n     * to ensure that their `data` is transformed correctly.\n     */\n    return await this.transformNewSteps(stepList);\n  }\n\n  /**\n   * Using middleware, transform any newly-found steps before returning them to\n   * an Inngest Server.\n   */\n  private async transformNewSteps<T extends [OutgoingOp, ...OutgoingOp[]]>(\n    steps: T,\n  ): Promise<T> {\n    return Promise.all(\n      steps.map(async (step) => {\n        if (step.op !== StepOpCode.InvokeFunction) {\n          return step;\n        }\n\n        const onSendEventHooks = await getHookStack(\n          this.options.fn[\"middleware\"],\n          \"onSendEvent\",\n          undefined,\n          {\n            transformInput: (prev, output) => {\n              return { ...prev, ...output };\n            },\n            transformOutput: (prev, output) => {\n              return {\n                result: { ...prev.result, ...output?.result },\n              };\n            },\n          },\n        );\n\n        /**\n         * For each event being sent, create a new `onSendEvent` hook stack to\n         * process it. We do this as middleware hooks are intended to run once\n         * during each lifecycle (onFunctionRun or onSendEvent) and here, a hook\n         * is run for every single event.\n         *\n         * This is done because a developer can use this hook to filter out\n         * events entirely; if we batch all of the events together, we can't\n         * tell which ones were filtered out if we're processing >1 invocation\n         * here.\n         */\n        const transformedPayload = await onSendEventHooks.transformInput?.({\n          payloads: [\n            {\n              ...(step.opts?.payload ?? {}),\n              name: internalEvents.FunctionInvoked,\n            },\n          ],\n        });\n\n        const newPayload = invokePayloadSchema.parse(\n          transformedPayload?.payloads?.[0] ?? {},\n        );\n\n        return {\n          ...step,\n          opts: {\n            ...step.opts,\n            payload: {\n              ...(step.opts?.payload ?? {}),\n              ...newPayload,\n            },\n          },\n        };\n      }),\n    ) as Promise<T>;\n  }\n\n  private async executeStep({\n    id,\n    name,\n    opts,\n    fn,\n    displayName,\n  }: FoundStep): Promise<OutgoingOp> {\n    this.timeout?.clear();\n    await this.state.hooks?.afterMemoization?.();\n    await this.state.hooks?.beforeExecution?.();\n\n    const outgoingOp: OutgoingOp = {\n      id,\n      op: StepOpCode.StepRun,\n      name,\n      opts,\n      displayName,\n    };\n    this.state.executingStep = outgoingOp;\n\n    const store = await getAsyncCtx();\n\n    if (store) {\n      store.executingStep = {\n        id,\n        name: displayName,\n      };\n    }\n\n    this.debug(`executing step \"${id}\"`);\n\n    return runAsPromise(fn)\n      .finally(async () => {\n        if (store) {\n          delete store.executingStep;\n        }\n\n        await this.state.hooks?.afterExecution?.();\n      })\n      .then<OutgoingOp>((data) => {\n        return {\n          ...outgoingOp,\n          data,\n        };\n      })\n      .catch<OutgoingOp>((error) => {\n        let errorIsRetriable = true;\n\n        if (error instanceof NonRetriableError) {\n          errorIsRetriable = false;\n        } else if (\n          this.fnArg.maxAttempts &&\n          this.fnArg?.maxAttempts - 1 === this.fnArg.attempt\n        ) {\n          errorIsRetriable = false;\n        }\n\n        if (errorIsRetriable) {\n          return {\n            ...outgoingOp,\n            op: StepOpCode.StepError,\n            // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n            error,\n          };\n        } else {\n          return {\n            ...outgoingOp,\n            op: StepOpCode.StepFailed,\n            // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n            error,\n          };\n        }\n      });\n  }\n\n  /**\n   * Starts execution of the user's function, including triggering checkpoints\n   * and middleware hooks where appropriate.\n   */\n  private async startExecution(): Promise<void> {\n    /**\n     * Mutate input as neccessary based on middleware.\n     */\n    await this.transformInput();\n\n    /**\n     * Start the timer to time out the run if needed.\n     */\n    void this.timeout?.start();\n\n    await this.state.hooks?.beforeMemoization?.();\n\n    /**\n     * If we had no state to begin with, immediately end the memoization phase.\n     */\n    if (this.state.allStateUsed()) {\n      await this.state.hooks?.afterMemoization?.();\n      await this.state.hooks?.beforeExecution?.();\n    }\n\n    /**\n     * Trigger the user's function.\n     */\n    runAsPromise(() => this.userFnToRun(this.fnArg))\n      .finally(async () => {\n        await this.state.hooks?.afterMemoization?.();\n        await this.state.hooks?.beforeExecution?.();\n        await this.state.hooks?.afterExecution?.();\n      })\n      .then((data) => {\n        this.state.setCheckpoint({ type: \"function-resolved\", data });\n      })\n      .catch((error) => {\n        this.state.setCheckpoint({ type: \"function-rejected\", error });\n      });\n  }\n\n  /**\n   * Using middleware, transform input before running.\n   */\n  private async transformInput() {\n    const inputMutations = await this.state.hooks?.transformInput?.({\n      ctx: { ...this.fnArg },\n      steps: Object.values(this.state.stepState),\n      fn: this.options.fn,\n      reqArgs: this.options.reqArgs,\n    });\n\n    if (inputMutations?.ctx) {\n      this.fnArg = inputMutations.ctx;\n    }\n\n    if (inputMutations?.steps) {\n      this.state.stepState = Object.fromEntries(\n        inputMutations.steps.map((step) => [step.id, step]),\n      );\n    }\n  }\n\n  /**\n   * Using middleware, transform output before returning.\n   */\n  private async transformOutput(\n    dataOrError: Parameters<\n      NonNullable<RunHookStack[\"transformOutput\"]>\n    >[0][\"result\"],\n  ): Promise<ExecutionResult> {\n    const output = { ...dataOrError } as Partial<OutgoingOp>;\n\n    const isStepExecution = Boolean(this.state.executingStep);\n\n    const transformedOutput = await this.state.hooks?.transformOutput?.({\n      result: { ...output },\n      step: this.state.executingStep,\n    });\n\n    const { data, error } = { ...output, ...transformedOutput?.result };\n\n    if (!isStepExecution) {\n      await this.state.hooks?.finished?.({\n        result: { ...(typeof error !== \"undefined\" ? { error } : { data }) },\n      });\n    }\n\n    if (typeof error !== \"undefined\") {\n      /**\n       * Ensure we give middleware the chance to decide on retriable behaviour\n       * by looking at the error returned from output transformation.\n       */\n      let retriable: boolean | string = !(\n        error instanceof NonRetriableError ||\n        (error instanceof StepError &&\n          error === this.state.recentlyRejectedStepError)\n      );\n      if (retriable && error instanceof RetryAfterError) {\n        retriable = error.retryAfter;\n      }\n      const serializedError = minifyPrettyError(serializeError(error));\n\n      return {\n        type: \"function-rejected\",\n        ctx: this.fnArg,\n        ops: this.ops,\n        error: serializedError,\n        retriable,\n      };\n    }\n\n    return {\n      type: \"function-resolved\",\n      ctx: this.fnArg,\n      ops: this.ops,\n      data: undefinedToNull(data),\n    };\n  }\n\n  private createExecutionState(): V2ExecutionState {\n    const d = createDeferredPromiseWithStack<Checkpoint>();\n    let checkpointResolve = d.deferred.resolve;\n    const checkpointResults = d.results;\n\n    const loop: V2ExecutionState[\"loop\"] = (async function* (\n      cleanUp?: () => void,\n    ) {\n      try {\n        while (true) {\n          const res = (await checkpointResults.next()).value;\n          if (res) {\n            yield res;\n          }\n        }\n      } finally {\n        cleanUp?.();\n      }\n    })(() => {\n      this.timeout?.clear();\n      void checkpointResults.return();\n    });\n\n    const stepsToFulfill = Object.keys(this.options.stepState).length;\n\n    const state: V2ExecutionState = {\n      stepState: this.options.stepState,\n      stepsToFulfill,\n      steps: new Map(),\n      loop,\n      hasSteps: Boolean(stepsToFulfill),\n      stepCompletionOrder: [...this.options.stepCompletionOrder],\n      remainingStepsToBeSeen: new Set(this.options.stepCompletionOrder),\n      setCheckpoint: (checkpoint: Checkpoint) => {\n        ({ resolve: checkpointResolve } = checkpointResolve(checkpoint));\n      },\n      allStateUsed: () => {\n        return this.state.remainingStepsToBeSeen.size === 0;\n      },\n    };\n\n    return state;\n  }\n\n  get ops(): Record<string, MemoizedOp> {\n    return Object.fromEntries(this.state.steps);\n  }\n\n  private createFnArg(): Context.Any {\n    const step = this.createStepTools();\n\n    let fnArg = {\n      ...(this.options.data as { event: EventPayload }),\n      step,\n    } as Context.Any;\n\n    /**\n     * Handle use of the `onFailure` option by deserializing the error.\n     */\n    if (this.options.isFailureHandler) {\n      const eventData = z\n        .object({ error: jsonErrorSchema })\n        .parse(fnArg.event?.data);\n\n      (fnArg as Partial<Pick<FailureEventArgs, \"error\">>) = {\n        ...fnArg,\n        error: deserializeError(eventData.error),\n      };\n    }\n\n    return this.options.transformCtx?.(fnArg) ?? fnArg;\n  }\n\n  private createStepTools(): ReturnType<typeof createStepTools> {\n    /**\n     * A list of steps that have been found and are being rolled up before being\n     * reported to the core loop.\n     */\n    const foundStepsToReport: Map<string, FoundStep> = new Map();\n\n    /**\n     * A map of the subset of found steps to report that have not yet been\n     * handled. Used for fast access to steps that need to be handled in order.\n     */\n    const unhandledFoundStepsToReport: Map<string, FoundStep> = new Map();\n\n    /**\n     * A map of the latest sequential step indexes found for each step ID. Used\n     * to ensure that we don't index steps in parallel.\n     *\n     * Note that these must be sequential; if we've seen or assigned `a:1`,\n     * `a:2` and `a:4`, the latest sequential step index is `2`.\n     *\n     */\n    const expectedNextStepIndexes: Map<string, number> = new Map();\n\n    /**\n     * A promise that's used to ensure that step reporting cannot be run more than\n     * once in a given asynchronous time span.\n     */\n    let foundStepsReportPromise: Promise<void> | undefined;\n\n    /**\n     * A promise that's used to represent middleware hooks running before\n     * execution.\n     */\n    let beforeExecHooksPromise: Promise<void> | undefined;\n\n    /**\n     * A helper used to report steps to the core loop. Used after adding an item\n     * to `foundStepsToReport`.\n     */\n    const reportNextTick = () => {\n      // Being explicit instead of using `??=` to appease TypeScript.\n      if (foundStepsReportPromise) {\n        return;\n      }\n\n      foundStepsReportPromise = new Promise((resolve) => setImmediate(resolve))\n        /**\n         * Ensure that we wait for this promise to resolve before continuing.\n         *\n         * The groups in which steps are reported can affect how we detect some\n         * more complex determinism issues like parallel indexing. This promise\n         * can represent middleware hooks being run early, in the middle of\n         * ingesting steps to report.\n         *\n         * Because of this, it's important we wait for this middleware to resolve\n         * before continuing to report steps to ensure that all steps have a\n         * chance to be reported throughout this asynchronous action.\n         */\n        .then(() => beforeExecHooksPromise)\n        .then(() => {\n          foundStepsReportPromise = undefined;\n\n          for (const [hashedId, step] of unhandledFoundStepsToReport) {\n            if (step.handle()) {\n              unhandledFoundStepsToReport.delete(hashedId);\n              if (step.fulfilled) {\n                foundStepsToReport.delete(step.id);\n              }\n            }\n          }\n\n          if (foundStepsToReport.size) {\n            const steps = [...foundStepsToReport.values()] as [\n              FoundStep,\n              ...FoundStep[],\n            ];\n\n            foundStepsToReport.clear();\n\n            return void this.state.setCheckpoint({\n              type: \"steps-found\",\n              steps: steps,\n            });\n          }\n        });\n    };\n\n    /**\n     * A helper used to push a step to the list of steps to report.\n     */\n    const pushStepToReport = (step: FoundStep) => {\n      foundStepsToReport.set(step.id, step);\n      unhandledFoundStepsToReport.set(step.hashedId, step);\n      reportNextTick();\n    };\n\n    const stepHandler: StepHandler = async ({\n      args,\n      matchOp,\n      opts,\n    }): Promise<unknown> => {\n      await beforeExecHooksPromise;\n\n      const stepOptions = getStepOptions(args[0]);\n      const opId = matchOp(stepOptions, ...args.slice(1));\n\n      if (this.state.executingStep) {\n        /**\n         * If a step is found after asynchronous actions during another step's\n         * execution, everything is fine. The problem here is if we've found\n         * that a step nested inside another a step, which is something we don't\n         * support at the time of writing.\n         *\n         * In this case, we could use something like Async Hooks to understand\n         * how the step is being triggered, though this isn't available in all\n         * environments.\n         *\n         * Therefore, we'll only show a warning here to indicate that this is\n         * potentially an issue.\n         */\n        console.warn(\n          prettyError({\n            whatHappened: `We detected that you have nested \\`step.*\\` tooling in \\`${\n              opId.displayName ?? opId.id\n            }\\``,\n            consequences: \"Nesting `step.*` tooling is not supported.\",\n            type: \"warn\",\n            reassurance:\n              \"It's possible to see this warning if steps are separated by regular asynchronous calls, which is fine.\",\n            stack: true,\n            toFixNow:\n              \"Make sure you're not using `step.*` tooling inside of other `step.*` tooling. If you need to compose steps together, you can create a new async function and call it from within your step function, or use promise chaining.\",\n            code: ErrCode.NESTING_STEPS,\n          }),\n        );\n      }\n\n      if (this.state.steps.has(opId.id)) {\n        const originalId = opId.id;\n\n        const expectedNextIndex = expectedNextStepIndexes.get(originalId) ?? 1;\n        for (let i = expectedNextIndex; ; i++) {\n          const newId = originalId + STEP_INDEXING_SUFFIX + i;\n\n          if (!this.state.steps.has(newId)) {\n            expectedNextStepIndexes.set(originalId, i + 1);\n            opId.id = newId;\n            break;\n          }\n        }\n      }\n\n      const { promise, resolve, reject } = createDeferredPromise();\n      const hashedId = _internals.hashId(opId.id);\n      const stepState = this.state.stepState[hashedId];\n      let isFulfilled = false;\n      if (stepState) {\n        stepState.seen = true;\n        this.state.remainingStepsToBeSeen.delete(hashedId);\n\n        if (typeof stepState.input === \"undefined\") {\n          isFulfilled = true;\n        }\n      }\n\n      let extraOpts: Record<string, unknown> | undefined;\n      let fnArgs = [...args];\n\n      if (\n        typeof stepState?.input !== \"undefined\" &&\n        Array.isArray(stepState.input)\n      ) {\n        switch (opId.op) {\n          // `step.run()` has its function input affected\n          case StepOpCode.StepPlanned: {\n            fnArgs = [...args.slice(0, 2), ...stepState.input];\n\n            extraOpts = { input: [...stepState.input] };\n            break;\n          }\n\n          // `step.ai.infer()` has its body affected\n          case StepOpCode.AiGateway: {\n            extraOpts = {\n              body: {\n                ...(typeof opId.opts?.body === \"object\"\n                  ? { ...opId.opts.body }\n                  : {}),\n                ...stepState.input[0],\n              },\n            };\n            break;\n          }\n        }\n      }\n\n      const step: FoundStep = {\n        ...opId,\n        opts: { ...opId.opts, ...extraOpts },\n        rawArgs: fnArgs, // TODO What is the right value here? Should this be raw args without affected input?\n        hashedId,\n        input: stepState?.input,\n\n        fn: opts?.fn ? () => opts.fn?.(...fnArgs) : undefined,\n        promise,\n        fulfilled: isFulfilled,\n        hasStepState: Boolean(stepState),\n        displayName: opId.displayName ?? opId.id,\n        handled: false,\n        handle: () => {\n          if (step.handled) {\n            return false;\n          }\n\n          step.handled = true;\n\n          if (isFulfilled && stepState) {\n            stepState.fulfilled = true;\n\n            // For some execution scenarios such as testing, `data`, `error`,\n            // and `input` may be `Promises`. This could also be the case for\n            // future middleware applications. For this reason, we'll make sure\n            // the values are fully resolved before continuing.\n            void Promise.all([\n              stepState.data,\n              stepState.error,\n              stepState.input,\n            ]).then(() => {\n              if (typeof stepState.data !== \"undefined\") {\n                resolve(stepState.data);\n              } else {\n                this.state.recentlyRejectedStepError = new StepError(\n                  opId.id,\n                  stepState.error,\n                );\n                reject(this.state.recentlyRejectedStepError);\n              }\n            });\n          }\n\n          return true;\n        },\n      };\n\n      this.state.steps.set(opId.id, step);\n      this.state.hasSteps = true;\n      pushStepToReport(step);\n\n      /**\n       * If this is the last piece of state we had, we've now finished\n       * memoizing.\n       */\n      if (!beforeExecHooksPromise && this.state.allStateUsed()) {\n        // biome-ignore lint/suspicious/noAssignInExpressions: <explanation>\n        await (beforeExecHooksPromise = (async () => {\n          await this.state.hooks?.afterMemoization?.();\n          await this.state.hooks?.beforeExecution?.();\n        })());\n      }\n\n      return promise;\n    };\n\n    return createStepTools(this.options.client, this, stepHandler);\n  }\n\n  private getUserFnToRun(): Handler.Any {\n    if (!this.options.isFailureHandler) {\n      return this.options.fn[\"fn\"];\n    }\n\n    if (!this.options.fn[\"onFailureFn\"]) {\n      /**\n       * Somehow, we've ended up detecting that this is a failure handler but\n       * doesn't have an `onFailure` function. This should never happen.\n       */\n      throw new Error(\"Cannot find function `onFailure` handler\");\n    }\n\n    return this.options.fn[\"onFailureFn\"];\n  }\n\n  private initializeTimer(state: V2ExecutionState): void {\n    if (!this.options.requestedRunStep) {\n      return;\n    }\n\n    this.timeout = createTimeoutPromise(this.timeoutDuration);\n\n    void this.timeout.then(async () => {\n      await this.state.hooks?.afterMemoization?.();\n      await this.state.hooks?.beforeExecution?.();\n      await this.state.hooks?.afterExecution?.();\n\n      state.setCheckpoint({\n        type: \"step-not-found\",\n        step: {\n          id: this.options.requestedRunStep as string,\n          op: StepOpCode.StepNotFound,\n        },\n      });\n    });\n  }\n\n  private async initializeMiddleware(): Promise<RunHookStack> {\n    const ctx = this.options.data as Pick<\n      Readonly<BaseContext<Inngest.Any>>,\n      \"event\" | \"events\" | \"runId\"\n    >;\n\n    const hooks = await getHookStack(\n      this.options.fn[\"middleware\"],\n      \"onFunctionRun\",\n      {\n        ctx,\n        fn: this.options.fn,\n        steps: Object.values(this.options.stepState),\n        reqArgs: this.options.reqArgs,\n      },\n      {\n        transformInput: (prev, output) => {\n          return {\n            ctx: { ...prev.ctx, ...output?.ctx },\n            fn: this.options.fn,\n            steps: prev.steps.map((step, i) => ({\n              ...step,\n              ...output?.steps?.[i],\n            })),\n            reqArgs: prev.reqArgs,\n          };\n        },\n        transformOutput: (prev, output) => {\n          return {\n            result: { ...prev.result, ...output?.result },\n            step: prev.step,\n          };\n        },\n      },\n    );\n\n    return hooks;\n  }\n}\n\n/**\n * Types of checkpoints that can be reached during execution.\n */\nexport interface Checkpoints {\n  \"steps-found\": { steps: [FoundStep, ...FoundStep[]] };\n  \"function-rejected\": { error: unknown };\n  \"function-resolved\": { data: unknown };\n  \"step-not-found\": { step: OutgoingOp };\n}\n\ntype Checkpoint = {\n  [K in keyof Checkpoints]: Simplify<{ type: K } & Checkpoints[K]>;\n}[keyof Checkpoints];\n\ntype CheckpointHandlers = {\n  [C in Checkpoint as C[\"type\"]]: (\n    checkpoint: C,\n  ) => MaybePromise<ExecutionResult | undefined>;\n} & {\n  \"\": (checkpoint: Checkpoint) => MaybePromise<void>;\n};\n\nexport interface V2ExecutionState {\n  /**\n   * A value that indicates that we're executing this step. Can be used to\n   * ensure steps are not accidentally nested until we support this across all\n   * platforms.\n   */\n  executingStep?: Readonly<Omit<OutgoingOp, \"id\">>;\n\n  /**\n   * A map of step IDs to their data, used to fill previously-completed steps\n   * with state from the executor.\n   */\n  stepState: Record<string, MemoizedOp>;\n\n  /**\n   * The number of steps we expect to fulfil based on the state passed from the\n   * Executor.\n   */\n  stepsToFulfill: number;\n\n  /**\n   * A map of step IDs to their functions to run. The executor can request a\n   * specific step to run, so we need to store the function to run here.\n   */\n  steps: Map<string, FoundStep>;\n\n  /**\n   * A flag which represents whether or not steps are understood to be used in\n   * this function. This is used to determine whether or not we should run\n   * some steps (such as `step.sendEvent`) inline as they are found.\n   */\n  hasSteps: boolean;\n\n  /**\n   * The core loop - a generator used to take an action upon finding the next\n   * checkpoint. Manages the flow of execution and cleaning up after itself.\n   */\n  loop: AsyncGenerator<Checkpoint, void, void>;\n\n  /**\n   * A function that resolves the `Promise` returned by `waitForNextDecision`.\n   */\n  setCheckpoint: (data: Checkpoint) => void;\n\n  /**\n   * Initialized middleware hooks for this execution.\n   *\n   * Middleware hooks are cached to ensure they can only be run once, which\n   * means that these hooks can be called in many different places to ensure we\n   * handle all possible execution paths.\n   */\n  hooks?: RunHookStack;\n\n  /**\n   * Returns whether or not all state passed from the executor has been used to\n   * fulfill found steps.\n   */\n  allStateUsed: () => boolean;\n\n  /**\n   * An ordered list of step IDs that represents the order in which their\n   * execution was completed.\n   */\n  stepCompletionOrder: string[];\n\n  /**\n   * An set of step IDs that have yet to be seen in this execution. Used to\n   * decide when to trigger middleware based on the current state.\n   */\n  remainingStepsToBeSeen: Set<string>;\n\n  /**\n   * If defined, this is the error that purposefully thrown when memoizing step\n   * state in order to support per-step errors.\n   *\n   * We use this so that if the function itself rejects with the same error, we\n   * know that it was entirely uncaught (or at the very least rethrown), so we\n   * should send a `NonRetriableError` to stop needless execution of a function\n   * that will continue to fail.\n   *\n   * TODO This is imperfect, as this state is currently kept around for longer\n   * than it needs to be. It should disappear as soon as we've seen that the\n   * error did not immediately throw. It may need to be refactored to work a\n   * little more smoothly with the core loop.\n   */\n  recentlyRejectedStepError?: StepError;\n}\n\nconst hashId = (id: string): string => {\n  return sha1().update(id).digest(\"hex\");\n};\n\nconst hashOp = (op: OutgoingOp): OutgoingOp => {\n  return {\n    ...op,\n    id: hashId(op.id),\n  };\n};\n\n/**\n * Exported for testing.\n */\nexport const _internals = { hashOp, hashId };\n","import { trace } from \"@opentelemetry/api\";\nimport hashjs from \"hash.js\";\nimport { z } from \"zod/v3\";\nimport { headerKeys, internalEvents } from \"../../helpers/consts.ts\";\nimport {\n  deserializeError,\n  ErrCode,\n  minifyPrettyError,\n  prettyError,\n  serializeError,\n} from \"../../helpers/errors.js\";\nimport { undefinedToNull } from \"../../helpers/functions.js\";\nimport {\n  createDeferredPromise,\n  createDeferredPromiseWithStack,\n  createTimeoutPromise,\n  resolveAfterPending,\n  runAsPromise,\n} from \"../../helpers/promises.ts\";\nimport type { MaybePromise, Simplify } from \"../../helpers/types.ts\";\nimport {\n  type BaseContext,\n  type Context,\n  type EventPayload,\n  type FailureEventArgs,\n  type Handler,\n  jsonErrorSchema,\n  type OutgoingOp,\n  StepOpCode,\n} from \"../../types.ts\";\nimport { version } from \"../../version.ts\";\nimport type { Inngest } from \"../Inngest.ts\";\nimport { getHookStack, type RunHookStack } from \"../InngestMiddleware.ts\";\nimport {\n  createStepTools,\n  type FoundStep,\n  getStepOptions,\n  invokePayloadSchema,\n  STEP_INDEXING_SUFFIX,\n  type StepHandler,\n} from \"../InngestStepTools.ts\";\nimport { NonRetriableError } from \"../NonRetriableError.ts\";\nimport { RetryAfterError } from \"../RetryAfterError.ts\";\nimport { StepError } from \"../StepError.ts\";\nimport { getAsyncCtx, getAsyncLocalStorage } from \"./als.ts\";\nimport {\n  type ExecutionResult,\n  type IInngestExecution,\n  InngestExecution,\n  type InngestExecutionFactory,\n  type InngestExecutionOptions,\n  type MemoizedOp,\n} from \"./InngestExecution.ts\";\nimport { clientProcessorMap } from \"./otel/access.ts\";\n\nconst { sha1 } = hashjs;\n\nexport const createV1InngestExecution: InngestExecutionFactory = (options) => {\n  return new V1InngestExecution(options);\n};\n\nclass V1InngestExecution extends InngestExecution implements IInngestExecution {\n  private state: V1ExecutionState;\n  private fnArg: Context.Any;\n  private checkpointHandlers: CheckpointHandlers;\n  private timeoutDuration = 1000 * 10;\n  private execution: Promise<ExecutionResult> | undefined;\n  private userFnToRun: Handler.Any;\n\n  /**\n   * If we're supposed to run a particular step via `requestedRunStep`, this\n   * will be a `Promise` that resolves after no steps have been found for\n   * `timeoutDuration` milliseconds.\n   *\n   * If we're not supposed to run a particular step, this will be `undefined`.\n   */\n  private timeout?: ReturnType<typeof createTimeoutPromise>;\n\n  constructor(options: InngestExecutionOptions) {\n    super(options);\n\n    this.userFnToRun = this.getUserFnToRun();\n    this.state = this.createExecutionState();\n    this.fnArg = this.createFnArg();\n    this.checkpointHandlers = this.createCheckpointHandlers();\n    this.initializeTimer(this.state);\n\n    this.debug(\n      \"created new V1 execution for run;\",\n      this.options.requestedRunStep\n        ? `wanting to run step \"${this.options.requestedRunStep}\"`\n        : \"discovering steps\",\n    );\n\n    this.debug(\"existing state keys:\", Object.keys(this.state.stepState));\n  }\n\n  /**\n   * Idempotently start the execution of the user's function.\n   */\n  public start() {\n    if (!this.execution) {\n      this.debug(\"starting V1 execution\");\n\n      const tracer = trace.getTracer(\"inngest\", version);\n\n      this.execution = getAsyncLocalStorage().then((als) => {\n        return als.run(\n          { app: this.options.client, ctx: this.fnArg },\n          async () => {\n            return tracer.startActiveSpan(\"inngest.execution\", (span) => {\n              clientProcessorMap.get(this.options.client)?.declareStartingSpan({\n                span,\n                runId: this.options.runId,\n                traceparent: this.options.headers[headerKeys.TraceParent],\n                tracestate: this.options.headers[headerKeys.TraceState],\n              });\n\n              return this._start()\n                .then((result) => {\n                  this.debug(\"result:\", result);\n                  return result;\n                })\n                .finally(() => {\n                  span.end();\n                });\n            });\n          },\n        );\n      });\n    }\n\n    return this.execution;\n  }\n\n  /**\n   * Starts execution of the user's function and the core loop.\n   */\n  private async _start(): Promise<ExecutionResult> {\n    try {\n      const allCheckpointHandler = this.getCheckpointHandler(\"\");\n      this.state.hooks = await this.initializeMiddleware();\n      await this.startExecution();\n\n      for await (const checkpoint of this.state.loop) {\n        await allCheckpointHandler(checkpoint);\n\n        const handler = this.getCheckpointHandler(checkpoint.type);\n        const result = await handler(checkpoint);\n\n        if (result) {\n          return result;\n        }\n      }\n    } catch (error) {\n      return await this.transformOutput({ error });\n    } finally {\n      void this.state.loop.return();\n      await this.state.hooks?.beforeResponse?.();\n    }\n\n    /**\n     * If we're here, the generator somehow finished without returning a value.\n     * This should never happen.\n     */\n    throw new Error(\"Core loop finished without returning a value\");\n  }\n\n  /**\n   * Creates a handler for every checkpoint type, defining what to do when we\n   * reach that checkpoint in the core loop.\n   */\n  private createCheckpointHandlers(): CheckpointHandlers {\n    return {\n      /**\n       * Run for all checkpoints. Best used for logging or common actions.\n       * Use other handlers to return values and interrupt the core loop.\n       */\n      \"\": (checkpoint) => {\n        this.debug(\"checkpoint:\", checkpoint);\n      },\n\n      /**\n       * The user's function has completed and returned a value.\n       */\n      \"function-resolved\": async (checkpoint) => {\n        return await this.transformOutput({ data: checkpoint.data });\n      },\n\n      /**\n       * The user's function has thrown an error.\n       */\n      \"function-rejected\": async (checkpoint) => {\n        return await this.transformOutput({ error: checkpoint.error });\n      },\n\n      /**\n       * We've found one or more steps. Here we may want to run a step or report\n       * them back to Inngest.\n       */\n      \"steps-found\": async ({ steps }) => {\n        const stepResult = await this.tryExecuteStep(steps);\n        if (stepResult) {\n          const transformResult = await this.transformOutput(stepResult);\n\n          /**\n           * Transforming output will always return either function rejection or\n           * resolution. In most cases, this can be immediately returned, but in\n           * this particular case we want to handle it differently.\n           */\n          if (transformResult.type === \"function-resolved\") {\n            return {\n              type: \"step-ran\",\n              ctx: transformResult.ctx,\n              ops: transformResult.ops,\n              step: _internals.hashOp({\n                ...stepResult,\n                data: transformResult.data,\n              }),\n            };\n          } else if (transformResult.type === \"function-rejected\") {\n            const stepForResponse = _internals.hashOp({\n              ...stepResult,\n              error: transformResult.error,\n            });\n\n            if (stepResult.op === StepOpCode.StepFailed) {\n              const ser = serializeError(transformResult.error);\n              stepForResponse.data = {\n                __serialized: true,\n                name: ser.name,\n                message: ser.message,\n                stack: \"\",\n              };\n            }\n\n            return {\n              type: \"step-ran\",\n              ctx: transformResult.ctx,\n              ops: transformResult.ops,\n              retriable: transformResult.retriable,\n              step: stepForResponse,\n            };\n          }\n\n          return transformResult;\n        }\n\n        const newSteps = await this.filterNewSteps(\n          Array.from(this.state.steps.values()),\n        );\n        if (newSteps) {\n          return {\n            type: \"steps-found\",\n            ctx: this.fnArg,\n            ops: this.ops,\n            steps: newSteps,\n          };\n        }\n\n        return;\n      },\n\n      /**\n       * While trying to find a step that Inngest has told us to run, we've\n       * timed out or have otherwise decided that it doesn't exist.\n       */\n      \"step-not-found\": ({ step }) => {\n        return { type: \"step-not-found\", ctx: this.fnArg, ops: this.ops, step };\n      },\n    };\n  }\n\n  private getCheckpointHandler(type: keyof CheckpointHandlers) {\n    return this.checkpointHandlers[type] as (\n      checkpoint: Checkpoint,\n    ) => MaybePromise<ExecutionResult | undefined>;\n  }\n\n  private async tryExecuteStep(\n    steps: FoundStep[],\n  ): Promise<OutgoingOp | undefined> {\n    const hashedStepIdToRun =\n      this.options.requestedRunStep || this.getEarlyExecRunStep(steps);\n    if (!hashedStepIdToRun) {\n      return;\n    }\n\n    const step = steps.find(\n      (step) => step.hashedId === hashedStepIdToRun && step.fn,\n    );\n\n    if (step) {\n      return await this.executeStep(step);\n    }\n\n    /**\n     * Ensure we reset the timeout if we have a requested run step but couldn't\n     * find it, but also that we don't reset if we found and executed it.\n     */\n    return void this.timeout?.reset();\n  }\n\n  /**\n   * Given a list of outgoing ops, decide if we can execute an op early and\n   * return the ID of the step to execute if we can.\n   */\n  private getEarlyExecRunStep(steps: FoundStep[]): string | undefined {\n    /**\n     * We may have been disabled due to parallelism, in which case we can't\n     * immediately execute unless explicitly requested.\n     */\n    if (this.options.disableImmediateExecution) return;\n\n    const unfulfilledSteps = steps.filter((step) => !step.fulfilled);\n    if (unfulfilledSteps.length !== 1) return;\n\n    const op = unfulfilledSteps[0];\n\n    if (\n      op &&\n      op.op === StepOpCode.StepPlanned\n      // TODO We must individually check properties here that we do not want to\n      // execute on, such as retry counts. Nothing exists here that falls in to\n      // this case, but should be accounted for when we add them.\n      // && typeof op.opts === \"undefined\"\n    ) {\n      return op.hashedId;\n    }\n\n    return;\n  }\n\n  private async filterNewSteps(\n    foundSteps: FoundStep[],\n  ): Promise<[OutgoingOp, ...OutgoingOp[]] | undefined> {\n    if (this.options.requestedRunStep) {\n      return;\n    }\n\n    /**\n     * Gather any steps that aren't memoized and report them.\n     */\n    const newSteps = foundSteps.filter((step) => !step.fulfilled);\n\n    if (!newSteps.length) {\n      return;\n    }\n\n    /**\n     * Warn if we've found new steps but haven't yet seen all previous\n     * steps. This may indicate that step presence isn't determinate.\n     */\n    let knownSteps = 0;\n    for (const step of foundSteps) {\n      if (step.fulfilled) {\n        knownSteps++;\n      }\n    }\n    const foundAllCompletedSteps = this.state.stepsToFulfill === knownSteps;\n\n    if (!foundAllCompletedSteps) {\n      // TODO Tag\n      console.warn(\n        prettyError({\n          type: \"warn\",\n          whatHappened: \"Function may be indeterminate\",\n          why: \"We found new steps before seeing all previous steps, which may indicate that the function is non-deterministic.\",\n          consequences:\n            \"This may cause unexpected behaviour as Inngest executes your function.\",\n          reassurance:\n            \"This is expected if a function is updated in the middle of a run, but may indicate a bug if not.\",\n        }),\n      );\n    }\n\n    /**\n     * We're finishing up; let's trigger the last of the hooks.\n     */\n    await this.state.hooks?.afterMemoization?.();\n    await this.state.hooks?.beforeExecution?.();\n    await this.state.hooks?.afterExecution?.();\n\n    const stepList = newSteps.map<OutgoingOp>((step) => ({\n      displayName: step.displayName,\n      op: step.op,\n      id: step.hashedId,\n      name: step.name,\n      opts: step.opts,\n    })) as [OutgoingOp, ...OutgoingOp[]];\n\n    /**\n     * We also run `onSendEvent` middleware hooks against `step.invoke()` steps\n     * to ensure that their `data` is transformed correctly.\n     */\n    return await this.transformNewSteps(stepList);\n  }\n\n  /**\n   * Using middleware, transform any newly-found steps before returning them to\n   * an Inngest Server.\n   */\n  private async transformNewSteps<T extends [OutgoingOp, ...OutgoingOp[]]>(\n    steps: T,\n  ): Promise<T> {\n    return Promise.all(\n      steps.map(async (step) => {\n        if (step.op !== StepOpCode.InvokeFunction) {\n          return step;\n        }\n\n        const onSendEventHooks = await getHookStack(\n          this.options.fn[\"middleware\"],\n          \"onSendEvent\",\n          undefined,\n          {\n            transformInput: (prev, output) => {\n              return { ...prev, ...output };\n            },\n            transformOutput: (prev, output) => {\n              return {\n                result: { ...prev.result, ...output?.result },\n              };\n            },\n          },\n        );\n\n        /**\n         * For each event being sent, create a new `onSendEvent` hook stack to\n         * process it. We do this as middleware hooks are intended to run once\n         * during each lifecycle (onFunctionRun or onSendEvent) and here, a hook\n         * is run for every single event.\n         *\n         * This is done because a developer can use this hook to filter out\n         * events entirely; if we batch all of the events together, we can't\n         * tell which ones were filtered out if we're processing >1 invocation\n         * here.\n         */\n        const transformedPayload = await onSendEventHooks.transformInput?.({\n          payloads: [\n            {\n              ...(step.opts?.payload ?? {}),\n              name: internalEvents.FunctionInvoked,\n            },\n          ],\n        });\n\n        const newPayload = invokePayloadSchema.parse(\n          transformedPayload?.payloads?.[0] ?? {},\n        );\n\n        return {\n          ...step,\n          opts: {\n            ...step.opts,\n            payload: {\n              ...(step.opts?.payload ?? {}),\n              ...newPayload,\n            },\n          },\n        };\n      }),\n    ) as Promise<T>;\n  }\n\n  private async executeStep({\n    id,\n    name,\n    opts,\n    fn,\n    displayName,\n  }: FoundStep): Promise<OutgoingOp> {\n    this.timeout?.clear();\n    await this.state.hooks?.afterMemoization?.();\n    await this.state.hooks?.beforeExecution?.();\n\n    const outgoingOp: OutgoingOp = {\n      id,\n      op: StepOpCode.StepRun,\n      name,\n      opts,\n      displayName,\n    };\n    this.state.executingStep = outgoingOp;\n\n    const store = await getAsyncCtx();\n\n    if (store) {\n      store.executingStep = {\n        id,\n        name: displayName,\n      };\n    }\n\n    this.debug(`executing step \"${id}\"`);\n\n    return runAsPromise(fn)\n      .finally(async () => {\n        if (store) {\n          delete store.executingStep;\n        }\n\n        await this.state.hooks?.afterExecution?.();\n      })\n      .then<OutgoingOp>((data) => {\n        return {\n          ...outgoingOp,\n          data,\n        };\n      })\n      .catch<OutgoingOp>((error) => {\n        let errorIsRetriable = true;\n\n        if (error instanceof NonRetriableError) {\n          errorIsRetriable = false;\n        } else if (\n          this.fnArg.maxAttempts &&\n          this.fnArg?.maxAttempts - 1 === this.fnArg.attempt\n        ) {\n          errorIsRetriable = false;\n        }\n\n        if (errorIsRetriable) {\n          return {\n            ...outgoingOp,\n            op: StepOpCode.StepError,\n            // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n            error,\n          };\n        } else {\n          return {\n            ...outgoingOp,\n            op: StepOpCode.StepFailed,\n            // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n            error,\n          };\n        }\n      });\n  }\n\n  /**\n   * Starts execution of the user's function, including triggering checkpoints\n   * and middleware hooks where appropriate.\n   */\n  private async startExecution(): Promise<void> {\n    /**\n     * Mutate input as neccessary based on middleware.\n     */\n    await this.transformInput();\n\n    /**\n     * Start the timer to time out the run if needed.\n     */\n    void this.timeout?.start();\n\n    await this.state.hooks?.beforeMemoization?.();\n\n    /**\n     * If we had no state to begin with, immediately end the memoization phase.\n     */\n    if (this.state.allStateUsed()) {\n      await this.state.hooks?.afterMemoization?.();\n      await this.state.hooks?.beforeExecution?.();\n    }\n\n    /**\n     * Trigger the user's function.\n     */\n    runAsPromise(() => this.userFnToRun(this.fnArg))\n      .finally(async () => {\n        await this.state.hooks?.afterMemoization?.();\n        await this.state.hooks?.beforeExecution?.();\n        await this.state.hooks?.afterExecution?.();\n      })\n      .then((data) => {\n        this.state.setCheckpoint({ type: \"function-resolved\", data });\n      })\n      .catch((error) => {\n        this.state.setCheckpoint({ type: \"function-rejected\", error });\n      });\n  }\n\n  /**\n   * Using middleware, transform input before running.\n   */\n  private async transformInput() {\n    const inputMutations = await this.state.hooks?.transformInput?.({\n      ctx: { ...this.fnArg },\n      steps: Object.values(this.state.stepState),\n      fn: this.options.fn,\n      reqArgs: this.options.reqArgs,\n    });\n\n    if (inputMutations?.ctx) {\n      this.fnArg = inputMutations.ctx;\n    }\n\n    if (inputMutations?.steps) {\n      this.state.stepState = Object.fromEntries(\n        inputMutations.steps.map((step) => [step.id, step]),\n      );\n    }\n  }\n\n  /**\n   * Using middleware, transform output before returning.\n   */\n  private async transformOutput(\n    dataOrError: Parameters<\n      NonNullable<RunHookStack[\"transformOutput\"]>\n    >[0][\"result\"],\n  ): Promise<ExecutionResult> {\n    const output = { ...dataOrError } as Partial<OutgoingOp>;\n\n    const isStepExecution = Boolean(this.state.executingStep);\n\n    const transformedOutput = await this.state.hooks?.transformOutput?.({\n      result: { ...output },\n      step: this.state.executingStep,\n    });\n\n    const { data, error } = { ...output, ...transformedOutput?.result };\n\n    if (!isStepExecution) {\n      await this.state.hooks?.finished?.({\n        result: { ...(typeof error !== \"undefined\" ? { error } : { data }) },\n      });\n    }\n\n    if (typeof error !== \"undefined\") {\n      /**\n       * Ensure we give middleware the chance to decide on retriable behaviour\n       * by looking at the error returned from output transformation.\n       */\n      let retriable: boolean | string = !(\n        error instanceof NonRetriableError ||\n        (error instanceof StepError &&\n          error === this.state.recentlyRejectedStepError)\n      );\n      if (retriable && error instanceof RetryAfterError) {\n        retriable = error.retryAfter;\n      }\n\n      const serializedError = minifyPrettyError(serializeError(error));\n\n      return {\n        type: \"function-rejected\",\n        ctx: this.fnArg,\n        ops: this.ops,\n        error: serializedError,\n        retriable,\n      };\n    }\n\n    return {\n      type: \"function-resolved\",\n      ctx: this.fnArg,\n      ops: this.ops,\n      data: undefinedToNull(data),\n    };\n  }\n\n  private createExecutionState(): V1ExecutionState {\n    const d = createDeferredPromiseWithStack<Checkpoint>();\n    let checkpointResolve = d.deferred.resolve;\n    const checkpointResults = d.results;\n\n    const loop: V1ExecutionState[\"loop\"] = (async function* (\n      cleanUp?: () => void,\n    ) {\n      try {\n        while (true) {\n          const res = (await checkpointResults.next()).value;\n          if (res) {\n            yield res;\n          }\n        }\n      } finally {\n        cleanUp?.();\n      }\n    })(() => {\n      this.timeout?.clear();\n      void checkpointResults.return();\n    });\n\n    const stepsToFulfill = Object.keys(this.options.stepState).length;\n\n    const state: V1ExecutionState = {\n      stepState: this.options.stepState,\n      stepsToFulfill,\n      steps: new Map(),\n      loop,\n      hasSteps: Boolean(stepsToFulfill),\n      stepCompletionOrder: [...this.options.stepCompletionOrder],\n      remainingStepsToBeSeen: new Set(this.options.stepCompletionOrder),\n      setCheckpoint: (checkpoint: Checkpoint) => {\n        ({ resolve: checkpointResolve } = checkpointResolve(checkpoint));\n      },\n      allStateUsed: () => {\n        return this.state.remainingStepsToBeSeen.size === 0;\n      },\n    };\n\n    return state;\n  }\n\n  get ops(): Record<string, MemoizedOp> {\n    return Object.fromEntries(this.state.steps);\n  }\n\n  private createFnArg(): Context.Any {\n    const step = this.createStepTools();\n\n    let fnArg = {\n      ...(this.options.data as { event: EventPayload }),\n      step,\n    } as Context.Any;\n\n    /**\n     * Handle use of the `onFailure` option by deserializing the error.\n     */\n    if (this.options.isFailureHandler) {\n      const eventData = z\n        .object({ error: jsonErrorSchema })\n        .parse(fnArg.event?.data);\n\n      (fnArg as Partial<Pick<FailureEventArgs, \"error\">>) = {\n        ...fnArg,\n        error: deserializeError(eventData.error),\n      };\n    }\n\n    return this.options.transformCtx?.(fnArg) ?? fnArg;\n  }\n\n  private createStepTools(): ReturnType<typeof createStepTools> {\n    /**\n     * A list of steps that have been found and are being rolled up before being\n     * reported to the core loop.\n     */\n    const foundStepsToReport: Map<string, FoundStep> = new Map();\n\n    /**\n     * A map of the subset of found steps to report that have not yet been\n     * handled. Used for fast access to steps that need to be handled in order.\n     */\n    const unhandledFoundStepsToReport: Map<string, FoundStep> = new Map();\n\n    /**\n     * A map of the latest sequential step indexes found for each step ID. Used\n     * to ensure that we don't index steps in parallel.\n     *\n     * Note that these must be sequential; if we've seen or assigned `a:1`,\n     * `a:2` and `a:4`, the latest sequential step index is `2`.\n     *\n     */\n    const expectedNextStepIndexes: Map<string, number> = new Map();\n\n    /**\n     * An ordered list of step IDs that have yet to be handled in this\n     * execution. Used to ensure that we handle steps in the order they were\n     * found and based on the `stepCompletionOrder` in this execution's state.\n     */\n    const remainingStepCompletionOrder: string[] =\n      this.state.stepCompletionOrder.slice();\n\n    /**\n     * A promise that's used to ensure that step reporting cannot be run more than\n     * once in a given asynchronous time span.\n     */\n    let foundStepsReportPromise: Promise<void> | undefined;\n\n    /**\n     * A promise that's used to represent middleware hooks running before\n     * execution.\n     */\n    let beforeExecHooksPromise: Promise<void> | undefined;\n\n    /**\n     * A flag used to ensure that we only warn about parallel indexing once per\n     * execution to avoid spamming the console.\n     */\n    let warnOfParallelIndexing = false;\n\n    /**\n     * Counts the number of times we've extended this tick.\n     */\n    let tickExtensionCount = 0;\n\n    /**\n     * Given a colliding step ID, maybe warn the user about parallel indexing.\n     */\n    const maybeWarnOfParallelIndexing = (collisionId: string) => {\n      if (warnOfParallelIndexing) {\n        return;\n      }\n\n      const stepExists = this.state.steps.has(collisionId);\n      if (stepExists) {\n        const stepFoundThisTick = foundStepsToReport.has(collisionId);\n        if (!stepFoundThisTick) {\n          warnOfParallelIndexing = true;\n\n          console.warn(\n            prettyError({\n              type: \"warn\",\n              whatHappened:\n                \"We detected that you have multiple steps with the same ID.\",\n              code: ErrCode.AUTOMATIC_PARALLEL_INDEXING,\n              why: `This can happen if you're using the same ID for multiple steps across different chains of parallel work. We found the issue with step \"${collisionId}\".`,\n              reassurance:\n                \"Your function is still running, though it may exhibit unexpected behaviour.\",\n              consequences:\n                \"Using the same IDs across parallel chains of work can cause unexpected behaviour.\",\n              toFixNow:\n                \"We recommend using a unique ID for each step, especially those happening in parallel.\",\n            }),\n          );\n        }\n      }\n    };\n\n    /**\n     * A helper used to report steps to the core loop. Used after adding an item\n     * to `foundStepsToReport`.\n     */\n    const reportNextTick = () => {\n      // Being explicit instead of using `??=` to appease TypeScript.\n      if (foundStepsReportPromise) {\n        return;\n      }\n\n      let extensionPromise: Promise<void>;\n      if (++tickExtensionCount >= 10) {\n        tickExtensionCount = 0;\n        extensionPromise = new Promise((resolve) => setTimeout(resolve));\n      } else {\n        extensionPromise = resolveAfterPending();\n      }\n\n      foundStepsReportPromise = extensionPromise\n        /**\n         * Ensure that we wait for this promise to resolve before continuing.\n         *\n         * The groups in which steps are reported can affect how we detect some\n         * more complex determinism issues like parallel indexing. This promise\n         * can represent middleware hooks being run early, in the middle of\n         * ingesting steps to report.\n         *\n         * Because of this, it's important we wait for this middleware to resolve\n         * before continuing to report steps to ensure that all steps have a\n         * chance to be reported throughout this asynchronous action.\n         */\n        .then(() => beforeExecHooksPromise)\n        .then(() => {\n          foundStepsReportPromise = undefined;\n\n          for (let i = 0; i < remainingStepCompletionOrder.length; i++) {\n            const nextStepId = remainingStepCompletionOrder[i];\n            if (!nextStepId) {\n              // Strange - skip this empty index\n              continue;\n            }\n\n            const handled = unhandledFoundStepsToReport\n              .get(nextStepId)\n              ?.handle();\n            if (handled) {\n              remainingStepCompletionOrder.splice(i, 1);\n              unhandledFoundStepsToReport.delete(nextStepId);\n              return void reportNextTick();\n            }\n          }\n\n          // If we've handled no steps in this \"tick,\" roll up everything we've\n          // found and report it.\n          const steps = [...foundStepsToReport.values()] as [\n            FoundStep,\n            ...FoundStep[],\n          ];\n          foundStepsToReport.clear();\n          unhandledFoundStepsToReport.clear();\n\n          return void this.state.setCheckpoint({\n            type: \"steps-found\",\n            steps: steps,\n          });\n        });\n    };\n\n    /**\n     * A helper used to push a step to the list of steps to report.\n     */\n    const pushStepToReport = (step: FoundStep) => {\n      foundStepsToReport.set(step.id, step);\n      unhandledFoundStepsToReport.set(step.hashedId, step);\n      reportNextTick();\n    };\n\n    const stepHandler: StepHandler = async ({\n      args,\n      matchOp,\n      opts,\n    }): Promise<unknown> => {\n      await beforeExecHooksPromise;\n\n      const stepOptions = getStepOptions(args[0]);\n      const opId = matchOp(stepOptions, ...args.slice(1));\n\n      if (this.state.executingStep) {\n        /**\n         * If a step is found after asynchronous actions during another step's\n         * execution, everything is fine. The problem here is if we've found\n         * that a step nested inside another a step, which is something we don't\n         * support at the time of writing.\n         *\n         * In this case, we could use something like Async Hooks to understand\n         * how the step is being triggered, though this isn't available in all\n         * environments.\n         *\n         * Therefore, we'll only show a warning here to indicate that this is\n         * potentially an issue.\n         */\n        console.warn(\n          prettyError({\n            whatHappened: `We detected that you have nested \\`step.*\\` tooling in \\`${\n              opId.displayName ?? opId.id\n            }\\``,\n            consequences: \"Nesting `step.*` tooling is not supported.\",\n            type: \"warn\",\n            reassurance:\n              \"It's possible to see this warning if steps are separated by regular asynchronous calls, which is fine.\",\n            stack: true,\n            toFixNow:\n              \"Make sure you're not using `step.*` tooling inside of other `step.*` tooling. If you need to compose steps together, you can create a new async function and call it from within your step function, or use promise chaining.\",\n            code: ErrCode.NESTING_STEPS,\n          }),\n        );\n      }\n\n      if (this.state.steps.has(opId.id)) {\n        const originalId = opId.id;\n        maybeWarnOfParallelIndexing(originalId);\n\n        const expectedNextIndex = expectedNextStepIndexes.get(originalId) ?? 1;\n        for (let i = expectedNextIndex; ; i++) {\n          const newId = originalId + STEP_INDEXING_SUFFIX + i;\n\n          if (!this.state.steps.has(newId)) {\n            expectedNextStepIndexes.set(originalId, i + 1);\n            opId.id = newId;\n            break;\n          }\n        }\n      }\n\n      const { promise, resolve, reject } = createDeferredPromise();\n      const hashedId = _internals.hashId(opId.id);\n      const stepState = this.state.stepState[hashedId];\n      let isFulfilled = false;\n      if (stepState) {\n        stepState.seen = true;\n        this.state.remainingStepsToBeSeen.delete(hashedId);\n\n        if (typeof stepState.input === \"undefined\") {\n          isFulfilled = true;\n        }\n      }\n\n      let extraOpts: Record<string, unknown> | undefined;\n      let fnArgs = [...args];\n\n      if (\n        typeof stepState?.input !== \"undefined\" &&\n        Array.isArray(stepState.input)\n      ) {\n        switch (opId.op) {\n          // `step.run()` has its function input affected\n          case StepOpCode.StepPlanned: {\n            fnArgs = [...args.slice(0, 2), ...stepState.input];\n\n            extraOpts = { input: [...stepState.input] };\n            break;\n          }\n\n          // `step.ai.infer()` has its body affected\n          case StepOpCode.AiGateway: {\n            extraOpts = {\n              body: {\n                ...(typeof opId.opts?.body === \"object\"\n                  ? { ...opId.opts.body }\n                  : {}),\n                ...stepState.input[0],\n              },\n            };\n            break;\n          }\n        }\n      }\n\n      const step: FoundStep = {\n        ...opId,\n        opts: { ...opId.opts, ...extraOpts },\n        rawArgs: fnArgs, // TODO What is the right value here? Should this be raw args without affected input?\n        hashedId,\n        input: stepState?.input,\n\n        fn: opts?.fn ? () => opts.fn?.(...fnArgs) : undefined,\n        promise,\n        fulfilled: isFulfilled,\n        hasStepState: Boolean(stepState),\n        displayName: opId.displayName ?? opId.id,\n        handled: false,\n        handle: () => {\n          if (step.handled) {\n            return false;\n          }\n\n          step.handled = true;\n\n          if (isFulfilled && stepState) {\n            stepState.fulfilled = true;\n\n            // For some execution scenarios such as testing, `data`, `error`,\n            // and `input` may be `Promises`. This could also be the case for\n            // future middleware applications. For this reason, we'll make sure\n            // the values are fully resolved before continuing.\n            void Promise.all([\n              stepState.data,\n              stepState.error,\n              stepState.input,\n            ]).then(() => {\n              if (typeof stepState.data !== \"undefined\") {\n                resolve(stepState.data);\n              } else {\n                this.state.recentlyRejectedStepError = new StepError(\n                  opId.id,\n                  stepState.error,\n                );\n                reject(this.state.recentlyRejectedStepError);\n              }\n            });\n          }\n\n          return true;\n        },\n      };\n\n      this.state.steps.set(opId.id, step);\n      this.state.hasSteps = true;\n      pushStepToReport(step);\n\n      /**\n       * If this is the last piece of state we had, we've now finished\n       * memoizing.\n       */\n      if (!beforeExecHooksPromise && this.state.allStateUsed()) {\n        // biome-ignore lint/suspicious/noAssignInExpressions: <explanation>\n        await (beforeExecHooksPromise = (async () => {\n          await this.state.hooks?.afterMemoization?.();\n          await this.state.hooks?.beforeExecution?.();\n        })());\n      }\n\n      return promise;\n    };\n\n    return createStepTools(this.options.client, this, stepHandler);\n  }\n\n  private getUserFnToRun(): Handler.Any {\n    if (!this.options.isFailureHandler) {\n      return this.options.fn[\"fn\"];\n    }\n\n    if (!this.options.fn[\"onFailureFn\"]) {\n      /**\n       * Somehow, we've ended up detecting that this is a failure handler but\n       * doesn't have an `onFailure` function. This should never happen.\n       */\n      throw new Error(\"Cannot find function `onFailure` handler\");\n    }\n\n    return this.options.fn[\"onFailureFn\"];\n  }\n\n  private initializeTimer(state: V1ExecutionState): void {\n    if (!this.options.requestedRunStep) {\n      return;\n    }\n\n    this.timeout = createTimeoutPromise(this.timeoutDuration);\n\n    void this.timeout.then(async () => {\n      await this.state.hooks?.afterMemoization?.();\n      await this.state.hooks?.beforeExecution?.();\n      await this.state.hooks?.afterExecution?.();\n\n      state.setCheckpoint({\n        type: \"step-not-found\",\n        step: {\n          id: this.options.requestedRunStep as string,\n          op: StepOpCode.StepNotFound,\n        },\n      });\n    });\n  }\n\n  private async initializeMiddleware(): Promise<RunHookStack> {\n    const ctx = this.options.data as Pick<\n      Readonly<BaseContext<Inngest.Any>>,\n      \"event\" | \"events\" | \"runId\"\n    >;\n\n    const hooks = await getHookStack(\n      this.options.fn[\"middleware\"],\n      \"onFunctionRun\",\n      {\n        ctx,\n        fn: this.options.fn,\n        steps: Object.values(this.options.stepState),\n        reqArgs: this.options.reqArgs,\n      },\n      {\n        transformInput: (prev, output) => {\n          return {\n            ctx: { ...prev.ctx, ...output?.ctx },\n            fn: this.options.fn,\n            steps: prev.steps.map((step, i) => ({\n              ...step,\n              ...output?.steps?.[i],\n            })),\n            reqArgs: prev.reqArgs,\n          };\n        },\n        transformOutput: (prev, output) => {\n          return {\n            result: { ...prev.result, ...output?.result },\n            step: prev.step,\n          };\n        },\n      },\n    );\n\n    return hooks;\n  }\n}\n\n/**\n * Types of checkpoints that can be reached during execution.\n */\nexport interface Checkpoints {\n  \"steps-found\": { steps: [FoundStep, ...FoundStep[]] };\n  \"function-rejected\": { error: unknown };\n  \"function-resolved\": { data: unknown };\n  \"step-not-found\": { step: OutgoingOp };\n}\n\ntype Checkpoint = {\n  [K in keyof Checkpoints]: Simplify<{ type: K } & Checkpoints[K]>;\n}[keyof Checkpoints];\n\ntype CheckpointHandlers = {\n  [C in Checkpoint as C[\"type\"]]: (\n    checkpoint: C,\n  ) => MaybePromise<ExecutionResult | undefined>;\n} & {\n  \"\": (checkpoint: Checkpoint) => MaybePromise<void>;\n};\n\nexport interface V1ExecutionState {\n  /**\n   * A value that indicates that we're executing this step. Can be used to\n   * ensure steps are not accidentally nested until we support this across all\n   * platforms.\n   */\n  executingStep?: Readonly<Omit<OutgoingOp, \"id\">>;\n\n  /**\n   * A map of step IDs to their data, used to fill previously-completed steps\n   * with state from the executor.\n   */\n  stepState: Record<string, MemoizedOp>;\n\n  /**\n   * The number of steps we expect to fulfil based on the state passed from the\n   * Executor.\n   */\n  stepsToFulfill: number;\n\n  /**\n   * A map of step IDs to their functions to run. The executor can request a\n   * specific step to run, so we need to store the function to run here.\n   */\n  steps: Map<string, FoundStep>;\n\n  /**\n   * A flag which represents whether or not steps are understood to be used in\n   * this function. This is used to determine whether or not we should run\n   * some steps (such as `step.sendEvent`) inline as they are found.\n   */\n  hasSteps: boolean;\n\n  /**\n   * The core loop - a generator used to take an action upon finding the next\n   * checkpoint. Manages the flow of execution and cleaning up after itself.\n   */\n  loop: AsyncGenerator<Checkpoint, void, void>;\n\n  /**\n   * A function that resolves the `Promise` returned by `waitForNextDecision`.\n   */\n  setCheckpoint: (data: Checkpoint) => void;\n\n  /**\n   * Initialized middleware hooks for this execution.\n   *\n   * Middleware hooks are cached to ensure they can only be run once, which\n   * means that these hooks can be called in many different places to ensure we\n   * handle all possible execution paths.\n   */\n  hooks?: RunHookStack;\n\n  /**\n   * Returns whether or not all state passed from the executor has been used to\n   * fulfill found steps.\n   */\n  allStateUsed: () => boolean;\n\n  /**\n   * An ordered list of step IDs that represents the order in which their\n   * execution was completed.\n   */\n  stepCompletionOrder: string[];\n\n  /**\n   * An set of step IDs that have yet to be seen in this execution. Used to\n   * decide when to trigger middleware based on the current state.\n   */\n  remainingStepsToBeSeen: Set<string>;\n\n  /**\n   * If defined, this is the error that purposefully thrown when memoizing step\n   * state in order to support per-step errors.\n   *\n   * We use this so that if the function itself rejects with the same error, we\n   * know that it was entirely uncaught (or at the very least rethrown), so we\n   * should send a `NonRetriableError` to stop needless execution of a function\n   * that will continue to fail.\n   *\n   * TODO This is imperfect, as this state is currently kept around for longer\n   * than it needs to be. It should disappear as soon as we've seen that the\n   * error did not immediately throw. It may need to be refactored to work a\n   * little more smoothly with the core loop.\n   */\n  recentlyRejectedStepError?: StepError;\n}\n\nconst hashId = (id: string): string => {\n  return sha1().update(id).digest(\"hex\");\n};\n\nconst hashOp = (op: OutgoingOp): OutgoingOp => {\n  return {\n    ...op,\n    id: hashId(op.id),\n  };\n};\n\n/**\n * Exported for testing.\n */\nexport const _internals = { hashOp, hashId };\n","import { cacheFn, waterfall } from \"../helpers/functions.ts\";\nimport type {\n  Await,\n  MaybePromise,\n  ObjectAssign,\n  PartialK,\n  Simplify,\n} from \"../helpers/types.ts\";\nimport type {\n  BaseContext,\n  EventPayload,\n  IncomingOp,\n  OutgoingOp,\n  SendEventBaseOutput,\n  TriggersFromClient,\n} from \"../types.ts\";\nimport type { Inngest } from \"./Inngest.ts\";\nimport type { InngestFunction } from \"./InngestFunction.ts\";\n\n/**\n * A middleware that can be registered with Inngest to hook into various\n * lifecycles of the SDK and affect input and output of Inngest functionality.\n *\n * See {@link https://innge.st/middleware}\n *\n * @example\n *\n * ```ts\n * export const inngest = new Inngest({\n *   middleware: [\n *     new InngestMiddleware({\n *       name: \"My Middleware\",\n *       init: () => {\n *         // ...\n *       }\n *     })\n *   ]\n * });\n * ```\n *\n * @public\n */\nexport class InngestMiddleware<TOpts extends MiddlewareOptions>\n  implements InngestMiddleware.Like\n{\n  get [Symbol.toStringTag](): typeof InngestMiddleware.Tag {\n    return InngestMiddleware.Tag;\n  }\n\n  /**\n   * The name of this middleware. Used primarily for debugging and logging\n   * purposes.\n   */\n  public readonly name: TOpts[\"name\"];\n\n  /**\n   * This function is used to initialize your middleware and register any hooks\n   * you want to use. It will be called once when the SDK is initialized, and\n   * should be used to store any state you want to use in other parts of your\n   * middleware.\n   *\n   * It can be synchronous or asynchronous, in which case the client will wait\n   * for it to resolve before continuing to initialize the next middleware.\n   *\n   * Multiple clients could be used in the same application with differing\n   * middleware, so do not store state in global variables or assume that your\n   * middleware will only be used once.\n   *\n   * Must return an object detailing the hooks you want to register.\n   */\n  public readonly init: TOpts[\"init\"];\n\n  constructor({ name, init }: TOpts) {\n    this.name = name;\n    this.init = init;\n  }\n}\n\nexport namespace InngestMiddleware {\n  export const Tag = \"Inngest.Middleware\" as const;\n\n  export type Any = InngestMiddleware<MiddlewareOptions>;\n  export interface Like {\n    readonly [Symbol.toStringTag]: typeof InngestMiddleware.Tag;\n  }\n  export type Stack = [InngestMiddleware.Like, ...InngestMiddleware.Like[]];\n}\n\ntype FnsWithSameInputAsOutput<\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n  TRecord extends Record<string, (arg: any) => any>,\n> = {\n  [K in keyof TRecord as Await<TRecord[K]> extends Parameters<TRecord[K]>[0]\n    ? K\n    : // biome-ignore lint/suspicious/noConfusingVoidType: <explanation>\n      Await<TRecord[K]> extends undefined | void\n      ? // biome-ignore lint/suspicious/noConfusingVoidType: <explanation>\n        Parameters<TRecord[K]>[0] extends undefined | void\n        ? K\n        : never\n      : never]: TRecord[K];\n};\n\ntype PromisifiedFunctionRecord<\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n  TRecord extends Record<string, (arg: any) => any>,\n> = Pick<\n  Partial<{\n    [K in keyof TRecord]: (\n      ...args: Parameters<TRecord[K]>\n    ) => Promise<Await<TRecord[K]>>;\n  }>,\n  keyof FnsWithSameInputAsOutput<TRecord>\n> &\n  Omit<\n    Partial<{\n      [K in keyof TRecord]: (\n        ...args: Parameters<TRecord[K]>\n      ) => Promise<Parameters<TRecord[K]>[0]>;\n    }>,\n    keyof FnsWithSameInputAsOutput<TRecord>\n  >;\n\nexport type RunHookStack = PromisifiedFunctionRecord<\n  Await<MiddlewareRegisterReturn[\"onFunctionRun\"]>\n>;\n\nexport type SendEventHookStack = PromisifiedFunctionRecord<\n  Await<MiddlewareRegisterReturn[\"onSendEvent\"]>\n>;\n\n/**\n * Given some middleware and an entrypoint, runs the initializer for the given\n * `key` and returns functions that will pass arguments through a stack of each\n * given hook in a middleware's lifecycle.\n *\n * Lets the middleware initialize before starting.\n */\nexport const getHookStack = async <\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n  TMiddleware extends Record<string, (arg: any) => any>,\n  TKey extends keyof TMiddleware,\n  TResult extends Await<TMiddleware[TKey]>,\n  TRet extends\n    PromisifiedFunctionRecord<TResult> = PromisifiedFunctionRecord<TResult>,\n>(\n  /**\n   * The stack of middleware that will be used to run hooks.\n   */\n  middleware: Promise<TMiddleware[]>,\n\n  /**\n   * The hook type to initialize.\n   */\n  key: TKey,\n\n  /**\n   * Arguments for the initial hook.\n   */\n  arg: Parameters<TMiddleware[TKey]>[0],\n\n  transforms: PartialK<\n    {\n      [K in keyof TResult]-?: (\n        prev: Parameters<TResult[K]>[0],\n        output: Await<TResult[K]>,\n      ) => Parameters<TResult[K]>[0];\n    },\n    keyof {\n      [K in keyof TResult as Await<TResult[K]> extends Parameters<TResult[K]>[0]\n        ? K\n        : // biome-ignore lint/suspicious/noConfusingVoidType: <explanation>\n          Await<TResult[K]> extends undefined | void\n          ? K\n          : never]: undefined;\n    }\n  >,\n): Promise<TRet> => {\n  // Get directions of hooks before we start running the middleware.\n  const hookDirs = hookDirections[key as keyof typeof hookDirections];\n  if (!hookDirs) {\n    throw new Error(\n      `No hook directions found for key \"${String(key)}\". This is likely a bug in the Inngest SDK.`,\n    );\n  }\n\n  // Wait for middleware to initialize\n  const mwStack = await middleware;\n\n  // Step through each middleware and get the hook for the given key\n  const keyFns = mwStack.reduce(\n    (acc, mw) => {\n      const fn = mw[key];\n\n      if (fn) {\n        return [...acc, fn];\n      }\n\n      return acc;\n    },\n    [] as NonNullable<TMiddleware[TKey]>[],\n  );\n\n  // Run each hook found in sequence and collect the results\n  const hooksRegistered = await keyFns.reduce<\n    Promise<Await<TMiddleware[TKey]>[]>\n  >(async (acc, fn) => {\n    return [...(await acc), await fn(arg)];\n  }, Promise.resolve([]));\n\n  // Prepare the return object - mutating this instead of using reduce as it\n  // results in cleaner code.\n  const ret = {} as TRet;\n\n  // Step through each hook result and create a waterfall joining each key\n  for (const hook of hooksRegistered) {\n    const hookKeys = Object.keys(hook) as (keyof TRet)[];\n\n    for (const key of hookKeys) {\n      let fns = [hook[key]];\n\n      const existingWaterfall = ret[key];\n      if (existingWaterfall) {\n        if (hookDirs[key as keyof typeof hookDirs] === \"forward\") {\n          fns = [existingWaterfall, hook[key]];\n        } else {\n          // For backward hooks, put the new hook before the existing waterfall\n          // This creates the proper onion pattern: [foo, bar] -> [bar, foo] for after* hooks\n          fns = [hook[key], existingWaterfall];\n        }\n      }\n\n      const transform = transforms[key as keyof typeof transforms] as (\n        arg: Await<(typeof fns)[number]>,\n      ) => Parameters<(typeof fns)[number]>;\n\n      ret[key] = waterfall(fns, transform) as TRet[keyof TRet];\n    }\n  }\n\n  // Cache each function in the stack to ensure each can only be called once\n  for (const k of Object.keys(ret)) {\n    const key = k as keyof typeof ret;\n\n    ret[key] = cacheFn(\n      ret[key] as (...args: unknown[]) => unknown,\n    ) as unknown as TRet[keyof TRet];\n  }\n\n  return ret;\n};\n\n/**\n * Options passed to new {@link InngestMiddleware} instance.\n *\n * @public\n */\nexport interface MiddlewareOptions {\n  /**\n   * The name of this middleware. Used primarily for debugging and logging\n   * purposes.\n   */\n  name: string;\n\n  /**\n   * This function is used to initialize your middleware and register any hooks\n   * you want to use. It will be called once when the SDK is initialized, and\n   * should be used to store any state you want to use in other parts of your\n   * middleware.\n   *\n   * It can be synchronous or asynchronous, in which case the client will wait\n   * for it to resolve before continuing to initialize the next middleware.\n   *\n   * Multiple clients could be used in the same application with differing\n   * middleware, so do not store state in global variables or assume that your\n   * middleware will only be used once.\n   *\n   * Must return an object detailing the hooks you want to register.\n   */\n  init: MiddlewareRegisterFn;\n}\n\n/**\n * @public\n */\nexport type MiddlewareRegisterReturn = {\n  /**\n   * This hook is called for every function execution and allows you to hook\n   * into various stages of a run's lifecycle. Use this to store any state you\n   * want to use for the entirety of a particular run.\n   *\n   * It can be synchronous or asynchronous, in which case the client will wait\n   * for it to resolve before continuing to initialize the next middleware.\n   *\n   * Must return an object detailing the hooks you want to register.\n   */\n  onFunctionRun?: (ctx: InitialRunInfo) => MaybePromise<{\n    /**\n     * The `input` hook is called once the input for the function has been\n     * properly set up. This is where you can modify the input before the\n     * function starts to memoize or execute by returning an object containing\n     * changes to the context.\n     *\n     * For example, to add `foo` to the context, you'd return\n     * `{ ctx: { foo: \"bar\" } }`.\n     *\n     * @param ctx - The context for the incoming request.\n     * @param steps - The step data in state. Does not include internal IDs.\n     */\n    transformInput?: MiddlewareRunInput;\n\n    /**\n     * The `beforeMemoization` hook is called before the function starts to\n     * memoize.\n     */\n    beforeMemoization?: BlankHook;\n\n    /**\n     * The `afterMemoization` hook is called after the function has finished\n     * memoizing.\n     */\n    afterMemoization?: BlankHook;\n\n    /**\n     * The `beforeExecution` hook is called before the function starts to\n     * execute. Execution here means that new code is being seen/run for the\n     * first time.\n     */\n    beforeExecution?: BlankHook;\n\n    /**\n     * The `afterExecution` hook is called after the function has finished\n     * executing.\n     */\n    afterExecution?: BlankHook;\n\n    /**\n     * The `output` hook is called after the function has finished executing\n     * and before the response is sent back to Inngest. This is where you\n     * can modify the output before it's sent back to Inngest by returning\n     * an object containing changes.\n     *\n     * @param err - The raw error that was thrown by the function, if any, so\n     * that you can capture exact error messages and stack traces.\n     *\n     * @param data - The prepared-but-unserialized data that was returned by\n     * the function, if any, so that you can modify the output.\n     */\n    transformOutput?: MiddlewareRunOutput;\n\n    /**\n     * The `finished` hook is called when the function has finished executing\n     * and has returned a final response that will end the run, either a\n     * successful or error response. In the case of an error response, further\n     * retries may be attempted and call this hook again.\n     *\n     * The output provided will be after `transformOutput` has been applied.\n     *\n     * This is not guaranteed to be called on every execution, and may be called\n     * multiple times if many parallel executions reach the end of the function;\n     * for a guaranteed single execution, create a function with an event\n     * trigger of `\"inngest/function.finished\"`.\n     */\n    finished?: MiddlewareRunFinished;\n\n    /**\n     * The `beforeResponse` hook is called after the output has been set and\n     * before the response is sent back to Inngest. This is where you can\n     * perform any final actions before the response is sent back to Inngest and\n     * is the final hook called.\n     */\n    beforeResponse?: BlankHook;\n  }>;\n\n  /**\n   * The `sendEvent` hook is called every time an event is sent to Inngest.\n   */\n  onSendEvent?: () => MaybePromise<{\n    /**\n     * The `input` hook is called before the event is sent to Inngest. This\n     * is where you can modify the event before it's sent to Inngest by\n     * returning an object containing changes.\n     */\n    transformInput?: MiddlewareSendEventInput;\n\n    /**\n     * The `output` hook is called after the event has been sent to Inngest.\n     * This is where you can perform any final actions after the event has\n     * been sent to Inngest and can modify the output the SDK sees.\n     */\n    transformOutput?: MiddlewareSendEventOutput;\n  }>;\n};\n\n/**\n * The direction of each hook that exists in the middleware lifecycle.\n * This is used to determine whether hooks found in a stack run forwards or\n * backwards, creating onion-like behaviour.\n */\nconst hookDirections: {\n  [K in keyof MiddlewareRegisterReturn]: Record<\n    keyof Await<NonNullable<MiddlewareRegisterReturn[K]>>,\n    \"forward\" | \"backward\"\n  >;\n} = {\n  onFunctionRun: {\n    transformInput: \"forward\",\n    beforeMemoization: \"forward\",\n    afterMemoization: \"backward\",\n    beforeExecution: \"forward\",\n    afterExecution: \"backward\",\n    transformOutput: \"backward\",\n    beforeResponse: \"forward\",\n    finished: \"forward\",\n  },\n  onSendEvent: {\n    transformInput: \"forward\",\n    transformOutput: \"backward\",\n  },\n};\n\n/**\n * @public\n */\nexport type MiddlewareRegisterFn = (ctx: {\n  /**\n   * The client this middleware is being registered on.\n   */\n  client: Inngest.Any;\n\n  /**\n   * If defined, this middleware has been applied directly to an Inngest\n   * function rather than on the client.\n   */\n  fn?: InngestFunction.Any;\n}) => MaybePromise<MiddlewareRegisterReturn>;\n\n/**\n * A blank, no-op hook that passes nothing and expects nothing in return.\n *\n * @internal\n */\ntype BlankHook = () => MaybePromise<void>;\n\n/**\n * Arguments sent to some `run` lifecycle hooks of a middleware.\n *\n * @internal\n */\ntype MiddlewareRunArgs = Readonly<{\n  /**\n   * The context object that will be passed to the function. This contains\n   * event data, some contextual data such as the run's ID, and step tooling.\n   */\n  ctx: Record<string, unknown> &\n    Readonly<BaseContext<Inngest.Any, TriggersFromClient<Inngest.Any>>>; // TODO Acceptable?\n\n  /**\n   * The step data that will be passed to the function.\n   */\n  steps: Readonly<IncomingOp>[];\n\n  /**\n   * The function that is being executed.\n   */\n  fn: InngestFunction.Any;\n\n  /**\n   * The raw arguments given to serve handler being used to execute the\n   * function.\n   */\n  reqArgs: Readonly<unknown[]>;\n}>;\n\n/**\n * The specific arguments sent to the `run` hook when an execution has begun.\n * Differs from {@link MiddlewareRunArgs} in that we don't have a complete\n * context yet.\n *\n * @internal\n */\ntype InitialRunInfo = Readonly<\n  Simplify<\n    Omit<MiddlewareRunArgs, \"ctx\"> & {\n      /**\n       * A partial context object that will be passed to the function. Does not\n       * necessarily contain all the data that will be passed to the function.\n       */\n      ctx: Readonly<{\n        event: EventPayload;\n        runId: string;\n      }>;\n    }\n  >\n>;\n\n/**\n * The shape of an `input` hook within a `run`, optionally returning change to\n * the context or steps.\n *\n * @internal\n */\ntype MiddlewareRunInput = (ctx: MiddlewareRunArgs) => MaybePromise<\n  | {\n      ctx?: Record<string, unknown>;\n      steps?: Pick<IncomingOp, \"data\">[];\n      // We need these in the future to allow users to specify their own complex\n      // types for transforming data above using just inference. e.g. every field\n      // ending with \"_at\" is transformed to a Date.\n      //\n      // transformEvent?: (event: EventPayload) => unknown;\n      // transformStep?: (data: unknown) => unknown;\n    }\n  | undefined\n  // biome-ignore lint/suspicious/noConfusingVoidType: <explanation>\n  | void\n>;\n\n/**\n * Arguments for the SendEventInput hook\n *\n * @internal\n */\ntype MiddlewareSendEventInputArgs = Readonly<{\n  payloads: ReadonlyArray<EventPayload>;\n}>;\n\n/**\n * The shape of an `input` hook within a `sendEvent`, optionally returning\n * change to the payloads.\n *\n * @internal\n */\ntype MiddlewareSendEventInput = (\n  ctx: MiddlewareSendEventInputArgs,\n) => MaybePromise<\n  | {\n      payloads?: EventPayload[];\n    }\n  | undefined\n  // biome-ignore lint/suspicious/noConfusingVoidType: <explanation>\n  | void\n>;\n\n/**\n * Arguments for the SendEventOutput hook\n *\n * @internal\n */\ntype MiddlewareSendEventOutputArgs = { result: Readonly<SendEventBaseOutput> };\n\n/**\n * The shape of an `output` hook within a `sendEvent`, optionally returning a\n * change to the result value.\n */\ntype MiddlewareSendEventOutput = (\n  ctx: MiddlewareSendEventOutputArgs,\n  // biome-ignore lint/suspicious/noConfusingVoidType: <explanation>\n) => MaybePromise<{ result?: Record<string, unknown> } | undefined | void>;\n\n/**\n * @internal\n */\ntype MiddlewareRunOutput = (ctx: {\n  result: Readonly<Pick<OutgoingOp, \"error\" | \"data\">>;\n  step?: Readonly<Omit<OutgoingOp, \"id\">>;\n}) => MaybePromise<\n  | {\n      result?: Partial<Pick<OutgoingOp, \"data\" | \"error\">>;\n    }\n  | undefined\n  // biome-ignore lint/suspicious/noConfusingVoidType: <explanation>\n  | void\n>;\n\ntype MiddlewareRunFinished = (ctx: {\n  result: Readonly<Pick<OutgoingOp, \"error\" | \"data\">>;\n}) => MaybePromise<void>;\n\n/**\n * @internal\n */\ntype GetMiddlewareRunInputMutation<TMiddleware extends InngestMiddleware.Like> =\n  TMiddleware extends InngestMiddleware<infer TOpts>\n    ? TOpts[\"init\"] extends MiddlewareRegisterFn\n      ? Await<\n          Await<Await<TOpts[\"init\"]>[\"onFunctionRun\"]>[\"transformInput\"]\n        > extends {\n          ctx: infer TCtx;\n        }\n        ? {\n            [K in keyof TCtx]: TCtx[K];\n          }\n        : {}\n      : {}\n    : {};\n\n/**\n * @internal\n */\ntype GetMiddlewareSendEventOutputMutation<\n  TMiddleware extends InngestMiddleware.Like,\n> = TMiddleware extends InngestMiddleware<infer TOpts>\n  ? TOpts[\"init\"] extends MiddlewareRegisterFn\n    ? Await<\n        Await<Await<TOpts[\"init\"]>[\"onSendEvent\"]>[\"transformOutput\"]\n      > extends {\n        result: infer TResult;\n      }\n      ? {\n          [K in keyof TResult]: TResult[K];\n        }\n      : {}\n    : {}\n  : {};\n\n/**\n * @internal\n */\nexport type MiddlewareStackSendEventOutputMutation<\n  TContext,\n  TMiddleware extends InngestMiddleware.Stack,\n> = ObjectAssign<\n  {\n    [K in keyof TMiddleware]: GetMiddlewareSendEventOutputMutation<\n      TMiddleware[K]\n    >;\n  },\n  TContext\n>;\n\nexport type ExtendWithMiddleware<\n  TMiddlewareStacks extends InngestMiddleware.Stack[],\n  TContext = {},\n> = ObjectAssign<\n  {\n    [K in keyof TMiddlewareStacks]: MiddlewareStackRunInputMutation<\n      {},\n      TMiddlewareStacks[K]\n    >;\n  },\n  TContext\n>;\n\nexport type ExtendSendEventWithMiddleware<\n  TMiddlewareStacks extends InngestMiddleware.Stack[],\n  TContext = {},\n> = ObjectAssign<\n  {\n    [K in keyof TMiddlewareStacks]: MiddlewareStackSendEventOutputMutation<\n      {},\n      TMiddlewareStacks[K]\n    >;\n  },\n  TContext\n>;\n\n/**\n * @internal\n */\nexport type MiddlewareStackRunInputMutation<\n  TContext,\n  TMiddleware extends InngestMiddleware.Stack,\n> = ObjectAssign<\n  {\n    [K in keyof TMiddleware]: GetMiddlewareRunInputMutation<TMiddleware[K]>;\n  },\n  TContext\n>;\n","import { InngestApi } from \"../api/api.ts\";\nimport {\n  defaultDevServerHost,\n  defaultInngestApiBaseUrl,\n  defaultInngestEventBaseUrl,\n  dummyEventKey,\n  envKeys,\n  headerKeys,\n  logPrefix,\n} from \"../helpers/consts.ts\";\nimport { createEntropy } from \"../helpers/crypto.ts\";\nimport { devServerAvailable, devServerUrl } from \"../helpers/devserver.ts\";\nimport {\n  allProcessEnv,\n  getFetch,\n  getMode,\n  inngestHeaders,\n  type Mode,\n  processEnv,\n} from \"../helpers/env.ts\";\nimport { fixEventKeyMissingSteps, prettyError } from \"../helpers/errors.ts\";\nimport type { Jsonify } from \"../helpers/jsonify.ts\";\nimport { retryWithBackoff } from \"../helpers/promises.ts\";\nimport { stringify } from \"../helpers/strings.ts\";\nimport type {\n  AsArray,\n  IsNever,\n  SendEventPayload,\n  SimplifyDeep,\n  SingleOrArray,\n  WithoutInternal,\n} from \"../helpers/types.ts\";\nimport {\n  DefaultLogger,\n  type Logger,\n  ProxyLogger,\n} from \"../middleware/logger.ts\";\nimport {\n  type ClientOptions,\n  type EventNameFromTrigger,\n  type EventPayload,\n  type FailureEventArgs,\n  type Handler,\n  type InvokeTargetFunctionDefinition,\n  type SendEventOutput,\n  type SendEventResponse,\n  sendEventResponseSchema,\n  type TriggersFromClient,\n} from \"../types.ts\";\nimport type { EventSchemas } from \"./EventSchemas.ts\";\nimport { InngestFunction } from \"./InngestFunction.ts\";\nimport type { InngestFunctionReference } from \"./InngestFunctionReference.ts\";\nimport {\n  type ExtendWithMiddleware,\n  getHookStack,\n  InngestMiddleware,\n  type MiddlewareRegisterFn,\n  type MiddlewareRegisterReturn,\n  type SendEventHookStack,\n} from \"./InngestMiddleware.ts\";\n\n/**\n * Capturing the global type of fetch so that we can reliably access it below.\n */\ntype FetchT = typeof fetch;\n\n/**\n * Given a set of client options for Inngest, return the event types that can\n * be sent or received.\n *\n * @public\n */\nexport type EventsFromOpts<TOpts extends ClientOptions> =\n  TOpts[\"schemas\"] extends EventSchemas<infer U>\n    ? U\n    : Record<string, EventPayload>;\n\n/**\n * A client used to interact with the Inngest API by sending or reacting to\n * events.\n *\n * To provide event typing, see {@link EventSchemas}.\n *\n * ```ts\n * const inngest = new Inngest({ id: \"my-app\" });\n *\n * // or to provide event typing too\n * const inngest = new Inngest({\n *   id: \"my-app\",\n *   schemas: new EventSchemas().fromRecord<{\n *     \"app/user.created\": {\n *       data: { userId: string };\n *     };\n *   }>(),\n * });\n * ```\n *\n * @public\n */\nexport class Inngest<TClientOpts extends ClientOptions = ClientOptions>\n  implements Inngest.Like\n{\n  get [Symbol.toStringTag](): typeof Inngest.Tag {\n    return Inngest.Tag;\n  }\n\n  /**\n   * The ID of this instance, most commonly a reference to the application it\n   * resides in.\n   *\n   * The ID of your client should remain the same for its lifetime; if you'd\n   * like to change the name of your client as it appears in the Inngest UI,\n   * change the `name` property instead.\n   */\n  public readonly id: string;\n\n  /**\n   * Stores the options so we can remember explicit settings the user has\n   * provided.\n   */\n  private readonly options: TClientOpts;\n\n  /**\n   * Inngest event key, used to send events to Inngest Cloud.\n   */\n  private eventKey = \"\";\n\n  private _apiBaseUrl: string | undefined;\n  private _eventBaseUrl: string | undefined;\n\n  private readonly inngestApi: InngestApi;\n\n  /**\n   * The absolute URL of the Inngest Cloud API.\n   */\n  private sendEventUrl: URL = new URL(\n    `e/${this.eventKey}`,\n    defaultInngestEventBaseUrl,\n  );\n\n  private headers!: Record<string, string>;\n\n  private readonly fetch: FetchT;\n\n  // biome-ignore lint/correctness/noUnusedPrivateClassMembers: used in the SDK\n  private readonly logger: Logger;\n\n  private localFns: InngestFunction.Any[] = [];\n\n  /**\n   * A promise that resolves when the middleware stack has been initialized and\n   * the client is ready to be used.\n   */\n  private readonly middleware: Promise<MiddlewareRegisterReturn[]>;\n\n  /**\n   * Whether the client is running in a production environment. This can\n   * sometimes be `undefined` if the client has expressed no preference or\n   * perhaps environment variables are only available at a later stage in the\n   * runtime, for example when receiving a request.\n   *\n   * An {@link InngestCommHandler} should prioritize this value over all other\n   * settings, but should still check for the presence of an environment\n   * variable if it is not set.\n   */\n  private _mode!: Mode;\n\n  protected readonly schemas?: NonNullable<TClientOpts[\"schemas\"]>;\n\n  private _appVersion: string | undefined;\n\n  get apiBaseUrl(): string | undefined {\n    return this._apiBaseUrl;\n  }\n\n  get eventBaseUrl(): string | undefined {\n    return this._eventBaseUrl;\n  }\n\n  get env(): string | null {\n    return this.headers[headerKeys.Environment] ?? null;\n  }\n\n  get appVersion(): string | undefined {\n    return this._appVersion;\n  }\n\n  /**\n   * A client used to interact with the Inngest API by sending or reacting to\n   * events.\n   *\n   * To provide event typing, see {@link EventSchemas}.\n   *\n   * ```ts\n   * const inngest = new Inngest({ name: \"My App\" });\n   *\n   * // or to provide event typing too\n   * const inngest = new Inngest({\n   *   name: \"My App\",\n   *   schemas: new EventSchemas().fromRecord<{\n   *     \"app/user.created\": {\n   *       data: { userId: string };\n   *     };\n   *   }>(),\n   * });\n   * ```\n   */\n  constructor(options: TClientOpts) {\n    this.options = options;\n\n    const {\n      id,\n      fetch,\n      logger = new DefaultLogger(),\n      middleware,\n      isDev,\n      schemas,\n      appVersion,\n    } = this.options;\n\n    if (!id) {\n      // TODO PrettyError\n      throw new Error(\"An `id` must be passed to create an Inngest instance.\");\n    }\n\n    this.id = id;\n\n    this._mode = getMode({\n      explicitMode:\n        typeof isDev === \"boolean\" ? (isDev ? \"dev\" : \"cloud\") : undefined,\n    });\n\n    this.fetch = getFetch(fetch);\n\n    this.inngestApi = new InngestApi({\n      baseUrl: this.apiBaseUrl,\n      signingKey: processEnv(envKeys.InngestSigningKey) || \"\",\n      signingKeyFallback: processEnv(envKeys.InngestSigningKeyFallback),\n      fetch: this.fetch,\n      mode: this.mode,\n    });\n\n    this.schemas = schemas;\n    this.loadModeEnvVars();\n\n    this.logger = logger;\n\n    this.middleware = this.initializeMiddleware([\n      ...builtInMiddleware,\n      ...(middleware || []),\n    ]);\n\n    this._appVersion = appVersion;\n  }\n\n  /**\n   * Returns a `Promise` that resolves when the app is ready and all middleware\n   * has been initialized.\n   */\n  public get ready(): Promise<void> {\n    return this.middleware.then(() => {});\n  }\n\n  /**\n   * Set the environment variables for this client. This is useful if you are\n   * passed environment variables at runtime instead of as globals and need to\n   * update the client with those values as requests come in.\n   */\n  public setEnvVars(\n    env: Record<string, string | undefined> = allProcessEnv(),\n  ): this {\n    this.mode = getMode({ env, client: this });\n\n    return this;\n  }\n\n  private loadModeEnvVars(): void {\n    this._apiBaseUrl =\n      this.options.baseUrl ||\n      this.mode[\"env\"][envKeys.InngestApiBaseUrl] ||\n      this.mode[\"env\"][envKeys.InngestBaseUrl] ||\n      this.mode.getExplicitUrl(defaultInngestApiBaseUrl);\n\n    this._eventBaseUrl =\n      this.options.baseUrl ||\n      this.mode[\"env\"][envKeys.InngestEventApiBaseUrl] ||\n      this.mode[\"env\"][envKeys.InngestBaseUrl] ||\n      this.mode.getExplicitUrl(defaultInngestEventBaseUrl);\n\n    this.setEventKey(\n      this.options.eventKey || this.mode[\"env\"][envKeys.InngestEventKey] || \"\",\n    );\n\n    this.headers = inngestHeaders({\n      inngestEnv: this.options.env,\n      env: this.mode[\"env\"],\n    });\n\n    this.inngestApi[\"mode\"] = this.mode;\n    this.inngestApi[\"apiBaseUrl\"] = this._apiBaseUrl;\n  }\n\n  /**\n   * Initialize all passed middleware, running the `register` function on each\n   * in sequence and returning the requested hook registrations.\n   */\n  private async initializeMiddleware(\n    middleware: InngestMiddleware.Like[] = [],\n    opts?: {\n      registerInput?: Omit<Parameters<MiddlewareRegisterFn>[0], \"client\">;\n      prefixStack?: Promise<MiddlewareRegisterReturn[]>;\n    },\n  ): Promise<MiddlewareRegisterReturn[]> {\n    /**\n     * Wait for the prefix stack to run first; do not trigger ours before this\n     * is complete.\n     */\n    const prefix = await (opts?.prefixStack ?? []);\n\n    const stack = middleware.reduce<Promise<MiddlewareRegisterReturn[]>>(\n      async (acc, m) => {\n        // Be explicit about waiting for the previous middleware to finish\n        const prev = await acc;\n        const next = await (m as InngestMiddleware.Any).init({\n          client: this,\n          ...opts?.registerInput,\n        });\n\n        return [...prev, next];\n      },\n      Promise.resolve([]),\n    );\n\n    return [...prefix, ...(await stack)];\n  }\n\n  private get mode(): Mode {\n    return this._mode;\n  }\n\n  private set mode(m) {\n    this._mode = m;\n    this.loadModeEnvVars();\n  }\n\n  /**\n   * Given a response from Inngest, relay the error to the caller.\n   */\n  private async getResponseError(\n    response: globalThis.Response,\n    rawBody: unknown,\n    foundErr = \"Unknown error\",\n  ): Promise<Error> {\n    let errorMessage = foundErr;\n\n    if (errorMessage === \"Unknown error\") {\n      switch (response.status) {\n        case 401:\n          errorMessage = \"Event key Not Found\";\n          break;\n        case 400:\n          errorMessage = \"Cannot process event payload\";\n          break;\n        case 403:\n          errorMessage = \"Forbidden\";\n          break;\n        case 404:\n          errorMessage = \"Event key not found\";\n          break;\n        case 406:\n          errorMessage = `${JSON.stringify(await rawBody)}`;\n          break;\n        case 409:\n        case 412:\n          errorMessage = \"Event transformation failed\";\n          break;\n        case 413:\n          errorMessage = \"Event payload too large\";\n          break;\n        case 500:\n          errorMessage = \"Internal server error\";\n          break;\n        default:\n          try {\n            errorMessage = await response.text();\n          } catch (_err) {\n            errorMessage = `${JSON.stringify(await rawBody)}`;\n          }\n          break;\n      }\n    }\n\n    return new Error(`Inngest API Error: ${response.status} ${errorMessage}`);\n  }\n\n  /**\n   * Set the event key for this instance of Inngest. This is useful if for some\n   * reason the key is not available at time of instantiation or present in the\n   * `INNGEST_EVENT_KEY` environment variable.\n   */\n  public setEventKey(\n    /**\n     * Inngest event key, used to send events to Inngest Cloud. Use this is your\n     * key is for some reason not available at time of instantiation or present\n     * in the `INNGEST_EVENT_KEY` environment variable.\n     */\n    eventKey: string,\n  ): void {\n    this.eventKey = eventKey || dummyEventKey;\n\n    this.sendEventUrl = new URL(\n      `e/${this.eventKey}`,\n      this.eventBaseUrl || defaultInngestEventBaseUrl,\n    );\n  }\n\n  private eventKeySet(): boolean {\n    return Boolean(this.eventKey) && this.eventKey !== dummyEventKey;\n  }\n\n  /**\n   * EXPERIMENTAL: This API is not yet stable and may change in the future\n   * without a major version bump.\n   *\n   * Send a Signal to Inngest.\n   */\n  public async sendSignal({\n    signal,\n    data,\n    env,\n  }: {\n    /**\n     * The signal to send.\n     */\n    signal: string;\n\n    /**\n     * The data to send with the signal.\n     */\n    data?: unknown;\n\n    /**\n     * The Inngest environment to send the signal to. Defaults to whichever\n     * environment this client's key is associated with.\n     *\n     * It's like you never need to change this unless you're trying to sync\n     * multiple systems together using branch names.\n     */\n    env?: string;\n  }): Promise<InngestApi.SendSignalResponse> {\n    const headers: Record<string, string> = {\n      ...(env ? { [headerKeys.Environment]: env } : {}),\n    };\n\n    return this._sendSignal({ signal, data, headers });\n  }\n\n  private async _sendSignal({\n    signal,\n    data,\n    headers,\n  }: {\n    signal: string;\n    data?: unknown;\n    headers?: Record<string, string>;\n  }): Promise<InngestApi.SendSignalResponse> {\n    const res = await this.inngestApi.sendSignal(\n      { signal, data },\n      { ...this.headers, ...headers },\n    );\n    if (res.ok) {\n      return res.value;\n    }\n\n    throw new Error(\n      `Failed to send signal: ${res.error?.error || \"Unknown error\"}`,\n    );\n  }\n\n  /**\n   * Send one or many events to Inngest. Takes an entire payload (including\n   * name) as each input.\n   *\n   * ```ts\n   * await inngest.send({ name: \"app/user.created\", data: { id: 123 } });\n   * ```\n   *\n   * Returns a promise that will resolve if the event(s) were sent successfully,\n   * else throws with an error explaining what went wrong.\n   *\n   * If you wish to send an event with custom types (i.e. one that hasn't been\n   * generated), make sure to add it when creating your Inngest instance, like\n   * so:\n   *\n   * ```ts\n   * const inngest = new Inngest({\n   *   name: \"My App\",\n   *   schemas: new EventSchemas().fromRecord<{\n   *     \"my/event\": {\n   *       name: \"my/event\";\n   *       data: { bar: string };\n   *     };\n   *   }>(),\n   * });\n   * ```\n   */\n  public async send<Payload extends SendEventPayload<GetEvents<this>>>(\n    payload: Payload,\n    options?: {\n      /**\n       * The Inngest environment to send events to. Defaults to whichever\n       * environment this client's event key is associated with.\n       *\n       * It's likely you never need to change this unless you're trying to sync\n       * multiple systems together using branch names.\n       */\n      env?: string;\n    },\n  ): Promise<SendEventOutput<TClientOpts>> {\n    const headers: Record<string, string> = {\n      ...(options?.env ? { [headerKeys.Environment]: options.env } : {}),\n    };\n\n    return this._send({ payload, headers });\n  }\n\n  /**\n   * Internal method for sending an event, used to allow Inngest internals to\n   * further customize the request sent to an Inngest Server.\n   */\n  private async _send<Payload extends SendEventPayload<GetEvents<this>>>({\n    payload,\n    headers,\n  }: {\n    payload: Payload;\n    headers?: Record<string, string>;\n  }): Promise<SendEventOutput<TClientOpts>> {\n    const nowMillis = new Date().getTime();\n\n    let maxAttempts = 5;\n\n    // Attempt to set the event ID seed header. If it fails then disable retries\n    // (but we still want to send the event).\n    try {\n      const entropy = createEntropy(10);\n      const entropyBase64 = Buffer.from(entropy).toString(\"base64\");\n      headers = {\n        ...headers,\n        [headerKeys.EventIdSeed]: `${nowMillis},${entropyBase64}`,\n      };\n    } catch (err) {\n      let message = \"Event-sending retries disabled\";\n      if (err instanceof Error) {\n        message += `: ${err.message}`;\n      }\n\n      console.debug(message);\n\n      // Disable retries.\n      maxAttempts = 1;\n    }\n\n    const hooks = await getHookStack(\n      this.middleware,\n      \"onSendEvent\",\n      undefined,\n      {\n        transformInput: (prev, output) => {\n          return { ...prev, ...output };\n        },\n        transformOutput(prev, output) {\n          return {\n            result: { ...prev.result, ...output?.result },\n          };\n        },\n      },\n    );\n\n    let payloads: EventPayload[] = Array.isArray(payload)\n      ? (payload as EventPayload[])\n      : payload\n        ? ([payload] as [EventPayload])\n        : [];\n\n    const inputChanges = await hooks.transformInput?.({\n      payloads: [...payloads],\n    });\n    if (inputChanges?.payloads) {\n      payloads = [...inputChanges.payloads];\n    }\n\n    // Ensure that we always add \"ts\" and \"data\" fields to events. \"ts\" is auto-\n    // filled by the event server so is safe, and adding here fixes Next.js\n    // server action cache issues.\n    payloads = payloads.map((p) => {\n      return {\n        ...p,\n        // Always generate an idempotency ID for an event for retries\n        id: p.id,\n        ts: p.ts || nowMillis,\n        data: p.data || {},\n      };\n    });\n\n    const applyHookToOutput = async (\n      arg: Parameters<NonNullable<SendEventHookStack[\"transformOutput\"]>>[0],\n    ): Promise<SendEventOutput<TClientOpts>> => {\n      const hookOutput = await hooks.transformOutput?.(arg);\n      return {\n        ...arg.result,\n        ...hookOutput?.result,\n        // ðŸ¤®\n      } as unknown as SendEventOutput<TClientOpts>;\n    };\n\n    /**\n     * It can be valid for a user to send an empty list of events; if this\n     * happens, show a warning that this may not be intended, but don't throw.\n     */\n    if (!payloads.length) {\n      console.warn(\n        prettyError({\n          type: \"warn\",\n          whatHappened: \"`inngest.send()` called with no events\",\n          reassurance:\n            \"This is not an error, but you may not have intended to do this.\",\n          consequences:\n            \"The returned promise will resolve, but no events have been sent to Inngest.\",\n          stack: true,\n        }),\n      );\n\n      return await applyHookToOutput({ result: { ids: [] } });\n    }\n\n    // When sending events, check if the dev server is available.  If so, use the\n    // dev server.\n    let url = this.sendEventUrl.href;\n\n    /**\n     * If in prod mode and key is not present, fail now.\n     */\n    if (this.mode.isCloud && !this.eventKeySet()) {\n      throw new Error(\n        prettyError({\n          whatHappened: \"Failed to send event\",\n          consequences: \"Your event or events were not sent to Inngest.\",\n          why: \"We couldn't find an event key to use to send events to Inngest.\",\n          toFixNow: fixEventKeyMissingSteps,\n        }),\n      );\n    }\n\n    /**\n     * If dev mode has been inferred, try to hit the dev server first to see if\n     * it exists. If it does, use it, otherwise fall back to whatever server we\n     * have configured.\n     *\n     * `INNGEST_BASE_URL` is used to set both dev server and prod URLs, so if a\n     * user has set this it means they have already chosen a URL to hit.\n     */\n    if (this.mode.isDev && this.mode.isInferred && !this.eventBaseUrl) {\n      const devAvailable = await devServerAvailable(\n        defaultDevServerHost,\n        this.fetch,\n      );\n\n      if (devAvailable) {\n        url = devServerUrl(defaultDevServerHost, `e/${this.eventKey}`).href;\n      }\n    }\n\n    const body = await retryWithBackoff(\n      async () => {\n        let rawBody: unknown;\n        let body: SendEventResponse | undefined;\n\n        // We don't need to do fallback auth here because this uses event keys and\n        // not signing keys\n        const response = await this.fetch(url, {\n          method: \"POST\",\n          body: stringify(payloads),\n          headers: { ...this.headers, ...headers },\n        });\n\n        try {\n          rawBody = await response.json();\n          body = await sendEventResponseSchema.parseAsync(rawBody);\n        } catch (_err) {\n          throw await this.getResponseError(response, rawBody);\n        }\n\n        if (body.status !== 200 || body.error) {\n          throw await this.getResponseError(response, rawBody, body.error);\n        }\n\n        return body;\n      },\n      {\n        maxAttempts,\n        baseDelay: 100,\n      },\n    );\n\n    return await applyHookToOutput({ result: { ids: body.ids } });\n  }\n\n  public createFunction: Inngest.CreateFunction<this> = (\n    rawOptions,\n    rawTrigger,\n    handler,\n  ) => {\n    const fn = this._createFunction(rawOptions, rawTrigger, handler);\n\n    this.localFns.push(fn);\n\n    return fn;\n  };\n\n  public get funcs() {\n    return this.localFns;\n  }\n\n  private _createFunction: Inngest.CreateFunction<this> = (\n    rawOptions,\n    rawTrigger,\n    handler,\n  ) => {\n    const options = this.sanitizeOptions(rawOptions);\n    const triggers = this.sanitizeTriggers(rawTrigger);\n\n    return new InngestFunction(\n      this,\n      {\n        ...options,\n        triggers,\n      },\n      handler,\n    );\n  };\n\n  /**\n   * Runtime-only validation.\n   */\n  private sanitizeOptions<T extends InngestFunction.Options>(options: T): T {\n    if (Object.hasOwn(options, \"fns\")) {\n      // v2 -> v3 migration warning\n      console.warn(\n        `${logPrefix} InngestFunction: \\`fns\\` option has been deprecated in v3; use \\`middleware\\` instead. See https://www.inngest.com/docs/sdk/migration`,\n      );\n    }\n\n    if (typeof options === \"string\") {\n      // v2 -> v3 runtime migraton warning\n      console.warn(\n        `${logPrefix} InngestFunction: Creating a function with a string as the first argument has been deprecated in v3; pass an object instead. See https://www.inngest.com/docs/sdk/migration`,\n      );\n\n      return { id: options as string } as T;\n    }\n\n    return options;\n  }\n\n  /**\n   * Runtime-only validation.\n   */\n  private sanitizeTriggers<\n    T extends SingleOrArray<InngestFunction.Trigger<string>>,\n  >(triggers: T): AsArray<T> {\n    if (typeof triggers === \"string\") {\n      // v2 -> v3 migration warning\n      console.warn(\n        `${logPrefix} InngestFunction: Creating a function with a string as the second argument has been deprecated in v3; pass an object instead. See https://www.inngest.com/docs/sdk/migration`,\n      );\n\n      return [{ event: triggers as string }] as AsArray<T>;\n    }\n\n    if (!Array.isArray(triggers)) {\n      return [triggers] as AsArray<T>;\n    }\n\n    return triggers as AsArray<T>;\n  }\n}\n\n/**\n * Default middleware that is included in every client, placed after the user's\n * middleware on the client but before function-level middleware.\n *\n * It is defined here to ensure that comments are included in the generated TS\n * definitions. Without this, we infer the stack of built-in middleware without\n * comments, losing a lot of value.\n *\n * If this is moved, please ensure that using this package in another project\n * can correctly access comments on mutated input and output.\n *\n * This return pattern mimics the output of a `satisfies` suffix; it's used as\n * we support versions of TypeScript prior to the introduction of `satisfies`.\n */\nexport const builtInMiddleware = (<T extends InngestMiddleware.Stack>(\n  m: T,\n): T => m)([\n  new InngestMiddleware({\n    name: \"Inngest: Logger\",\n    init({ client }) {\n      return {\n        onFunctionRun(arg) {\n          const { ctx } = arg;\n\n          const metadata = {\n            runID: ctx.runId,\n            eventName: ctx.event.name,\n            functionName: arg.fn.name,\n          };\n\n          let providedLogger: Logger = client[\"logger\"];\n          // create a child logger if the provided logger has child logger implementation\n          try {\n            if (\"child\" in providedLogger) {\n              type ChildLoggerFn = (\n                metadata: Record<string, unknown>,\n              ) => Logger;\n              providedLogger = (providedLogger.child as ChildLoggerFn)(\n                metadata,\n              );\n            }\n          } catch (err) {\n            console.error('failed to create \"childLogger\" with error: ', err);\n            // no-op\n          }\n          const logger = new ProxyLogger(providedLogger);\n\n          return {\n            transformInput() {\n              return {\n                ctx: {\n                  /**\n                   * The passed in logger from the user.\n                   * Defaults to a console logger if not provided.\n                   */\n                  logger: logger as Logger,\n                },\n              };\n            },\n            beforeExecution() {\n              logger.enable();\n            },\n            transformOutput({ result: { error } }) {\n              if (error) {\n                logger.error(error);\n              }\n            },\n            async beforeResponse() {\n              await logger.flush();\n            },\n          };\n        },\n      };\n    },\n  }),\n]);\n\n/**\n * A client used to interact with the Inngest API by sending or reacting to\n * events.\n *\n * To provide event typing, see {@link EventSchemas}.\n *\n * ```ts\n * const inngest = new Inngest({ name: \"My App\" });\n *\n * // or to provide event typing too\n * const inngest = new Inngest({\n *   name: \"My App\",\n *   schemas: new EventSchemas().fromRecord<{\n *     \"app/user.created\": {\n *       data: { userId: string };\n *     };\n *   }>(),\n * });\n * ```\n *\n * @public\n */\nexport namespace Inngest {\n  export const Tag = \"Inngest.App\" as const;\n\n  /**\n   * Represents any `Inngest` instance, regardless of generics and inference.\n   *\n   * Prefer use of `Inngest.Like` where possible to ensure compatibility with\n   * multiple versions.\n   */\n  export type Any = Inngest;\n\n  /**\n   * References any `Inngest` instance across library versions, useful for use\n   * in public APIs to ensure compatibility with multiple versions.\n   *\n   * Prefer use of `Inngest.Any` internally and `Inngest.Like` for public APIs.\n   */\n  export interface Like {\n    readonly [Symbol.toStringTag]: typeof Inngest.Tag;\n  }\n\n  export type CreateFunction<TClient extends Inngest.Any> = <\n    TMiddleware extends InngestMiddleware.Stack,\n    TTrigger extends SingleOrArray<\n      InngestFunction.Trigger<TriggersFromClient<TClient>>\n    >,\n    THandler extends Handler.Any = Handler<\n      TClient,\n      EventNameFromTrigger<GetEvents<TClient, true>, AsArray<TTrigger>[number]>,\n      ExtendWithMiddleware<\n        [\n          typeof builtInMiddleware,\n          NonNullable<ClientOptionsFromInngest<TClient>[\"middleware\"]>,\n          TMiddleware,\n        ]\n      >\n    >,\n    TFailureHandler extends Handler.Any = Handler<\n      TClient,\n      EventNameFromTrigger<GetEvents<TClient, true>, AsArray<TTrigger>[number]>,\n      ExtendWithMiddleware<\n        [\n          typeof builtInMiddleware,\n          NonNullable<ClientOptionsFromInngest<TClient>[\"middleware\"]>,\n          TMiddleware,\n        ],\n        FailureEventArgs<\n          GetEvents<TClient, true>[EventNameFromTrigger<\n            GetEvents<TClient, true>,\n            AsArray<TTrigger>[number]\n          >]\n        >\n      >\n    >,\n  >(\n    options: Omit<\n      InngestFunction.Options<\n        TClient,\n        TMiddleware,\n        AsArray<TTrigger>,\n        TFailureHandler\n      >,\n      \"triggers\"\n    >,\n    trigger: TTrigger,\n    handler: THandler,\n  ) => InngestFunction<\n    Omit<\n      InngestFunction.Options<\n        TClient,\n        TMiddleware,\n        AsArray<TTrigger>,\n        TFailureHandler\n      >,\n      \"triggers\"\n    >,\n    THandler,\n    TFailureHandler,\n    TClient,\n    TMiddleware,\n    AsArray<TTrigger>\n  >;\n}\n\n/**\n * A helper type to extract the type of a set of event tooling from a given\n * Inngest instance and optionally a trigger.\n *\n * @example Get generic step tools for an Inngest instance.\n * ```ts\n * type StepTools = GetStepTools<typeof inngest>;\n * ```\n *\n * @example Get step tools with a trigger, ensuring tools like `waitForEvent` are typed.\n * ```ts\n * type StepTools = GetStepTools<typeof Inngest, \"github/pull_request\">;\n * ```\n *\n * @public\n */\nexport type GetStepTools<\n  TInngest extends Inngest.Any,\n  TTrigger extends keyof GetEvents<TInngest> &\n    string = keyof GetEvents<TInngest> & string,\n> = GetFunctionInput<TInngest, TTrigger> extends { step: infer TStep }\n  ? TStep\n  : never;\n\n/**\n * A helper type to extract the type of the input to a function from a given\n * Inngest instance and optionally a trigger.\n *\n * @example Get generic function input for an Inngest instance.\n * ```ts\n * type Input = GetFunctionInput<typeof inngest>;\n * ```\n *\n * @example Get function input with a trigger, ensuring tools like `waitForEvent` are typed.\n * ```ts\n * type Input = GetFunctionInput<typeof Inngest, \"github/pull_request\">;\n * ```\n *\n * @public\n */\nexport type GetFunctionInput<\n  TClient extends Inngest.Any,\n  TTrigger extends TriggersFromClient<TClient> = TriggersFromClient<TClient>,\n> = Parameters<\n  // Handler<\n  //   ClientOptionsFromInngest<TInngest>,\n  //   GetEvents<TInngest, true>,\n  //   TTrigger,\n  //   ExtendWithMiddleware<\n  //     [\n  //       typeof builtInMiddleware,\n  //       NonNullable<ClientOptionsFromInngest<TInngest>[\"middleware\"]>,\n  //     ]\n  //   >\n  // >\n  Handler<\n    TClient,\n    TTrigger,\n    ExtendWithMiddleware<\n      [\n        typeof builtInMiddleware,\n        NonNullable<ClientOptionsFromInngest<TClient>[\"middleware\"]>,\n      ]\n    >\n  >\n>[0];\n\n/**\n * A helper type to extract the type of the output of an Inngest function.\n *\n * @example Get a function's output\n * ```ts\n * type Output = GetFunctionOutput<typeof myFunction>;\n * ```\n *\n * @public\n */\nexport type GetFunctionOutput<\n  TFunction extends InvokeTargetFunctionDefinition,\n> = TFunction extends InngestFunction.Any\n  ? GetFunctionOutputFromInngestFunction<TFunction>\n  : TFunction extends InngestFunctionReference.Any\n    ? GetFunctionOutputFromReferenceInngestFunction<TFunction>\n    : unknown;\n\n/**\n * A helper type to extract the type of the output of an Inngest function.\n *\n * Used internally for {@link GetFunctionOutput}. Code outside of this package\n * should use {@link GetFunctionOutput} instead.\n *\n * @internal\n */\nexport type GetFunctionOutputFromInngestFunction<\n  TFunction extends InngestFunction.Any,\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n> = TFunction extends InngestFunction<any, infer IHandler, any, any, any, any>\n  ? IsNever<SimplifyDeep<Jsonify<Awaited<ReturnType<IHandler>>>>> extends true\n    ? null\n    : SimplifyDeep<Jsonify<Awaited<ReturnType<IHandler>>>>\n  : unknown;\n\n/**\n * A helper type to extract the type of the output of a referenced Inngest\n * function.\n *\n * Used internally for {@link GetFunctionOutput}. Code outside of this package\n * should use {@link GetFunctionOutput} instead.\n *\n * @internal\n */\nexport type GetFunctionOutputFromReferenceInngestFunction<\n  TFunction extends InngestFunctionReference.Any,\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n> = TFunction extends InngestFunctionReference<any, infer IOutput>\n  ? IsNever<SimplifyDeep<Jsonify<IOutput>>> extends true\n    ? null\n    : SimplifyDeep<Jsonify<IOutput>>\n  : unknown;\n\n/**\n * When passed an Inngest client, will return all event types for that client.\n *\n * It's recommended to use this instead of directly reusing your event types, as\n * Inngest will add extra properties and internal events such as `ts` and\n * `inngest/function.finished`.\n *\n * @example\n * ```ts\n * import { EventSchemas, Inngest, type GetEvents } from \"inngest\";\n *\n * export const inngest = new Inngest({\n *   id: \"example-app\",\n *   schemas: new EventSchemas().fromRecord<{\n *     \"app/user.created\": { data: { userId: string } };\n *   }>(),\n * });\n *\n * type Events = GetEvents<typeof inngest>;\n * type AppUserCreated = Events[\"app/user.created\"];\n *\n * ```\n *\n * @public\n */\nexport type GetEvents<\n  TInngest extends Inngest.Any,\n  TWithInternal extends boolean = false,\n> = TWithInternal extends true\n  ? EventsFromOpts<ClientOptionsFromInngest<TInngest>>\n  : WithoutInternal<EventsFromOpts<ClientOptionsFromInngest<TInngest>>>;\n\n/**\n * A helper type to extract the inferred options from a given Inngest instance.\n *\n * @example\n * ```ts\n * type Options = ClientOptionsFromInngest<typeof inngest>;\n * ```\n *\n * @public\n */\n\nexport type ClientOptionsFromInngest<TInngest extends Inngest.Any> =\n  TInngest extends Inngest<infer U> ? U : ClientOptions;\n"],"names":["Debug","stepFetch: StepFetch","opts: { functionId: string; appId?: string }","options: InngestExecutionOptions","createV1InngestExecution: InngestExecutionFactory","devServerHost","fetch","opts: HashedOp[\"opts\"]","serializeError","reject: DeferredPromiseReturn<T>[\"reject\"]","timeStr","target: unknown","data: unknown","key","hookDirections: {\n  [K in keyof MiddlewareRegisterReturn]: Record<\n    keyof Await<NonNullable<MiddlewareRegisterReturn[K]>>,\n    \"forward\" | \"backward\"\n  >;\n}","err","ret: TimeoutPromise","config: FunctionConfig[]","deserializeError","json: unknown","why: string | undefined","logPrefix: string","Temporal.isTemporalDuration","Temporal.getISOString","state: V0ExecutionState","opts: {\n        payload: MinimalEventPayload;\n        function_id: string;\n        timeout?: string;\n      }","streamingChecks: Partial<\n  Record<\n    keyof typeof platformChecks,\n    (framework: SupportedFrameworkName, env: Env) => boolean\n  >\n>","headers: Record<string, string>","customFetch: typeof fetch","outgoingOp: OutgoingOp","payloads: EventPayload[]","rawBody: unknown","body: SendEventResponse | undefined","retriable: boolean | string","body","loop: V2ExecutionState[\"loop\"]","providedLogger: Logger","unhandledFoundStepsToReport: Map<string, FoundStep>","expectedNextStepIndexes: Map<string, number>","foundStepsReportPromise: Promise<void> | undefined","remainingStepCompletionOrder: string[]","beforeExecHooksPromise: Promise<void> | undefined","stepHandler: StepHandler","extensionPromise: Promise<void>","step: FoundStep","extraOpts: Record<string, unknown> | undefined"],"mappings":"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","ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,26,27,43,44,45,46,47,48,49,50,51,52,53,54,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75]}