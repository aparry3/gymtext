{"version":3,"sources":["../../../../../../node_modules/.pnpm/next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1.0/node_modules/next/src/server/route-modules/app-page/vendored/contexts/app-router-context.ts","../../../../../../node_modules/.pnpm/next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1.0/node_modules/next/src/server/route-modules/app-page/vendored/contexts/hooks-client-context.ts","../../../../../../node_modules/.pnpm/next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1.0/node_modules/next/src/server/route-modules/app-page/vendored/contexts/server-inserted-html.ts","../../../../../../node_modules/.pnpm/next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1.0/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-server-dom-turbopack-client.ts","../../../../../../apps/admin/src/components/ui/skeleton.tsx","../../../../../../apps/admin/src/components/ui/button.tsx","../../../../../../apps/admin/src/components/ui/card.tsx","../../../../../../node_modules/.pnpm/next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1.0/node_modules/next/src/client/use-merged-ref.ts","../../../../../../node_modules/.pnpm/next%4016.0.7_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.1.0_react%4019.1.0__react%4019.1.0/node_modules/next/src/shared/lib/utils/warn-once.ts","../../../../../../apps/admin/src/components/ui/breadcrumb.tsx","../../../../../../apps/admin/src/app/%28protected%29/users/%5Bid%5D/chat/page.tsx"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].AppRouterContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].HooksClientContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].ServerInsertedHtml\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactServerDOMTurbopackClient\n","import * as React from \"react\"\n\nexport interface SkeletonProps extends React.HTMLAttributes<HTMLDivElement> {\n  children?: React.ReactNode\n}\n\nconst Skeleton = React.forwardRef<HTMLDivElement, SkeletonProps>(\n  ({ className = \"\", ...props }, ref) => {\n    return (\n      <div\n        ref={ref}\n        className={`animate-pulse rounded-md bg-muted ${className}`}\n        {...props}\n      />\n    )\n  }\n)\nSkeleton.displayName = \"Skeleton\"\n\nexport { Skeleton }","import * as React from \"react\"\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement> {\n  variant?: 'default' | 'destructive' | 'outline' | 'secondary' | 'ghost' | 'link'\n  size?: 'default' | 'sm' | 'lg' | 'icon'\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className = \"\", variant = 'default', size = 'default', ...props }, ref) => {\n    const baseStyles = \"inline-flex items-center justify-center whitespace-nowrap rounded-xl text-sm font-medium transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 shadow-sm\"\n    \n    const variants = {\n      default: \"bg-blue-600 text-white hover:bg-blue-700 shadow-lg shadow-blue-600/25 hover:shadow-xl hover:shadow-blue-600/30 hover:scale-[1.02]\",\n      destructive: \"bg-red-600 text-white hover:bg-red-700 shadow-lg shadow-red-600/25 hover:shadow-xl hover:shadow-red-600/30 hover:scale-[1.02]\",\n      outline: \"border border-gray-200 bg-white text-gray-700 hover:bg-gray-50 shadow-sm hover:shadow-md hover:border-gray-300\",\n      secondary: \"bg-gray-100 text-gray-700 hover:bg-gray-200 hover:scale-[1.02]\",\n      ghost: \"text-gray-600 hover:bg-gray-100 hover:text-gray-900\",\n      link: \"text-blue-600 underline-offset-4 hover:underline hover:text-blue-700\"\n    }\n    \n    const sizes = {\n      default: \"h-10 px-4 py-2\",\n      sm: \"h-9 rounded-xl px-3 text-sm\",\n      lg: \"h-11 rounded-xl px-8 text-base\",\n      icon: \"h-10 w-10\"\n    }\n    \n    return (\n      <button\n        className={`${baseStyles} ${variants[variant]} ${sizes[size]} ${className}`}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button }","import * as React from \"react\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className = \"\", ...props }, ref) => (\n  <div\n    ref={ref}\n    className={`rounded-2xl border-0 bg-white shadow-lg shadow-black/[0.03] ring-1 ring-black/[0.05] ${className}`}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className = \"\", ...props }, ref) => (\n  <div\n    ref={ref}\n    className={`flex flex-col space-y-1.5 p-6 ${className}`}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className = \"\", ...props }, ref) => (\n  <h3\n    ref={ref}\n    className={`text-2xl font-semibold leading-none tracking-tight ${className}`}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className = \"\", ...props }, ref) => (\n  <p\n    ref={ref}\n    className={`text-sm text-muted-foreground ${className}`}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className = \"\", ...props }, ref) => (\n  <div ref={ref} className={`p-6 pt-0 ${className}`} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className = \"\", ...props }, ref) => (\n  <div\n    ref={ref}\n    className={`flex items-center p-6 pt-0 ${className}`}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }","import { useCallback, useRef, type Ref } from 'react'\n\n// This is a compatibility hook to support React 18 and 19 refs.\n// In 19, a cleanup function from refs may be returned.\n// In 18, returning a cleanup function creates a warning.\n// Since we take userspace refs, we don't know ahead of time if a cleanup function will be returned.\n// This implements cleanup functions with the old behavior in 18.\n// We know refs are always called alternating with `null` and then `T`.\n// So a call with `null` means we need to call the previous cleanup functions.\nexport function useMergedRef<TElement>(\n  refA: Ref<TElement>,\n  refB: Ref<TElement>\n): Ref<TElement> {\n  const cleanupA = useRef<(() => void) | null>(null)\n  const cleanupB = useRef<(() => void) | null>(null)\n\n  // NOTE: In theory, we could skip the wrapping if only one of the refs is non-null.\n  // (this happens often if the user doesn't pass a ref to Link/Form/Image)\n  // But this can cause us to leak a cleanup-ref into user code (previously via `<Link legacyBehavior>`),\n  // and the user might pass that ref into ref-merging library that doesn't support cleanup refs\n  // (because it hasn't been updated for React 19)\n  // which can then cause things to blow up, because a cleanup-returning ref gets called with `null`.\n  // So in practice, it's safer to be defensive and always wrap the ref, even on React 19.\n  return useCallback(\n    (current: TElement | null): void => {\n      if (current === null) {\n        const cleanupFnA = cleanupA.current\n        if (cleanupFnA) {\n          cleanupA.current = null\n          cleanupFnA()\n        }\n        const cleanupFnB = cleanupB.current\n        if (cleanupFnB) {\n          cleanupB.current = null\n          cleanupFnB()\n        }\n      } else {\n        if (refA) {\n          cleanupA.current = applyRef(refA, current)\n        }\n        if (refB) {\n          cleanupB.current = applyRef(refB, current)\n        }\n      }\n    },\n    [refA, refB]\n  )\n}\n\nfunction applyRef<TElement>(\n  refA: NonNullable<Ref<TElement>>,\n  current: TElement\n) {\n  if (typeof refA === 'function') {\n    const cleanup = refA(current)\n    if (typeof cleanup === 'function') {\n      return cleanup\n    } else {\n      return () => refA(null)\n    }\n  } else {\n    refA.current = current\n    return () => {\n      refA.current = null\n    }\n  }\n}\n","let warnOnce = (_: string) => {}\nif (process.env.NODE_ENV !== 'production') {\n  const warnings = new Set<string>()\n  warnOnce = (msg: string) => {\n    if (!warnings.has(msg)) {\n      console.warn(msg)\n    }\n    warnings.add(msg)\n  }\n}\n\nexport { warnOnce }\n","import * as React from \"react\"\nimport Link from \"next/link\"\n\nexport interface BreadcrumbProps extends React.HTMLAttributes<HTMLElement> {\n  children?: React.ReactNode\n}\n\nconst Breadcrumb = React.forwardRef<HTMLElement, BreadcrumbProps>(\n  ({ className = \"\", ...props }, ref) => {\n    return (\n      <nav\n        ref={ref}\n        aria-label=\"breadcrumb\"\n        className={className}\n        {...props}\n      />\n    )\n  }\n)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nexport interface BreadcrumbListProps extends React.HTMLAttributes<HTMLOListElement> {\n  children?: React.ReactNode\n}\n\nconst BreadcrumbList = React.forwardRef<HTMLOListElement, BreadcrumbListProps>(\n  ({ className = \"\", ...props }, ref) => {\n    return (\n      <ol\n        ref={ref}\n        className={`flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5 ${className}`}\n        {...props}\n      />\n    )\n  }\n)\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nexport interface BreadcrumbItemProps extends React.HTMLAttributes<HTMLLIElement> {\n  children?: React.ReactNode\n}\n\nconst BreadcrumbItem = React.forwardRef<HTMLLIElement, BreadcrumbItemProps>(\n  ({ className = \"\", ...props }, ref) => {\n    return (\n      <li\n        ref={ref}\n        className={`inline-flex items-center gap-1.5 ${className}`}\n        {...props}\n      />\n    )\n  }\n)\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nexport interface BreadcrumbLinkProps extends React.ComponentProps<typeof Link> {\n  children?: React.ReactNode\n}\n\nconst BreadcrumbLink = React.forwardRef<HTMLAnchorElement, BreadcrumbLinkProps>(\n  ({ className = \"\", ...props }, ref) => {\n    return (\n      <Link\n        ref={ref}\n        className={`transition-colors hover:text-foreground ${className}`}\n        {...props}\n      />\n    )\n  }\n)\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nexport interface BreadcrumbPageProps extends React.HTMLAttributes<HTMLSpanElement> {\n  children?: React.ReactNode\n}\n\nconst BreadcrumbPage = React.forwardRef<HTMLSpanElement, BreadcrumbPageProps>(\n  ({ className = \"\", ...props }, ref) => {\n    return (\n      <span\n        ref={ref}\n        role=\"link\"\n        aria-disabled=\"true\"\n        aria-current=\"page\"\n        className={`font-normal text-foreground ${className}`}\n        {...props}\n      />\n    )\n  }\n)\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({ children, className = \"\", ...props }: React.HTMLAttributes<HTMLLIElement>) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={`[&>svg]:size-3.5 ${className}`}\n    {...props}\n  >\n    {children ?? <ChevronRightIcon />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\n// Simple chevron right icon\nconst ChevronRightIcon = () => (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    fill=\"none\"\n    viewBox=\"0 0 24 24\"\n    strokeWidth={1.5}\n    stroke=\"currentColor\"\n    className=\"w-4 h-4\"\n  >\n    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"m8.25 4.5 7.5 7.5-7.5 7.5\" />\n  </svg>\n)\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n}","'use client'\n\nimport { useState, useEffect, useRef, useCallback } from 'react'\nimport { useParams, useRouter } from 'next/navigation'\nimport { Card } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Skeleton } from '@/components/ui/skeleton'\nimport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbSeparator,\n  BreadcrumbPage\n} from '@/components/ui/breadcrumb'\n\ninterface Message {\n  id: string\n  content: string\n  direction: 'inbound' | 'outbound'\n  timestamp: string\n  from: string\n  to: string\n}\n\nexport default function AdminChatPage() {\n  const { id } = useParams()\n  const router = useRouter()\n  const [messages, setMessages] = useState<Message[]>([])\n  const [inputMessage, setInputMessage] = useState('')\n  const [isInitialLoading, setIsInitialLoading] = useState(true)\n  const [isSending, setIsSending] = useState(false)\n  const [userName, setUserName] = useState<string>('')\n  const [userPhoneNumber, setUserPhoneNumber] = useState<string>('')\n  const [sseConnected, setSseConnected] = useState(false)\n  const [hasMore, setHasMore] = useState(true)\n  const [isLoadingMore, setIsLoadingMore] = useState(false)\n  const [offset, setOffset] = useState(0)\n  const messagesEndRef = useRef<HTMLDivElement>(null)\n  const messagesContainerRef = useRef<HTMLDivElement>(null)\n  const eventSourceRef = useRef<EventSource | null>(null)\n  const MESSAGES_PER_PAGE = 20\n\n  const scrollToBottom = useCallback(() => {\n    // Use setTimeout to ensure DOM has updated before scrolling\n    setTimeout(() => {\n      messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' })\n    }, 100)\n  }, [])\n\n  useEffect(() => {\n    scrollToBottom()\n  }, [messages, scrollToBottom])\n\n  const fetchConversations = useCallback(async (isInitialLoad = false) => {\n    if (isInitialLoad) {\n      setIsInitialLoading(true)\n    }\n    try {\n      const response = await fetch(`/api/admin/users/${id}/chat?limit=${MESSAGES_PER_PAGE}&offset=0`)\n      const result = await response.json()\n\n      if (!response.ok || !result.success) {\n        throw new Error(result.error || 'Failed to fetch messages')\n      }\n\n      // Get messages from the API (already sorted oldest-to-newest)\n      const messages = result.data.messages ?? []\n      setMessages(messages)\n      setHasMore(result.data.pagination?.hasMore ?? false)\n      setOffset(MESSAGES_PER_PAGE)\n\n      // Fetch user name and phone number on initial load\n      if (isInitialLoad) {\n        const userResponse = await fetch(`/api/admin/users/${id}`)\n        const userResult = await userResponse.json()\n        if (userResult.success) {\n          setUserName(userResult.data.user.name || 'User')\n          setUserPhoneNumber(userResult.data.user.phoneNumber || '')\n        }\n      }\n    } catch (err) {\n      console.error('Error fetching messages:', err)\n    } finally {\n      if (isInitialLoad) {\n        setIsInitialLoading(false)\n      }\n    }\n  }, [id, MESSAGES_PER_PAGE])\n\n  const loadMoreMessages = useCallback(async () => {\n    if (!hasMore || isLoadingMore) return\n\n    setIsLoadingMore(true)\n    try {\n      const response = await fetch(`/api/admin/users/${id}/chat?limit=${MESSAGES_PER_PAGE}&offset=${offset}`)\n      const result = await response.json()\n\n      if (!response.ok || !result.success) {\n        throw new Error(result.error || 'Failed to fetch more messages')\n      }\n\n      const olderMessages = result.data.messages ?? []\n\n      // Prepend older messages to the existing list\n      setMessages(prev => [...olderMessages, ...prev])\n      setHasMore(result.data.pagination?.hasMore ?? false)\n      setOffset(prev => prev + MESSAGES_PER_PAGE)\n    } catch (err) {\n      console.error('Error loading more messages:', err)\n    } finally {\n      setIsLoadingMore(false)\n    }\n  }, [id, offset, hasMore, isLoadingMore, MESSAGES_PER_PAGE])\n\n  useEffect(() => {\n    if (id) {\n      fetchConversations(true)\n    }\n  }, [id, fetchConversations])\n\n  // Handle scroll to top for loading more messages\n  useEffect(() => {\n    const container = messagesContainerRef.current\n    if (!container) return\n\n    const handleScroll = () => {\n      // Load more when scrolled within 100px of the top\n      if (container.scrollTop < 100 && hasMore && !isLoadingMore) {\n        // Save current scroll position\n        const scrollHeightBefore = container.scrollHeight\n        const scrollTopBefore = container.scrollTop\n\n        loadMoreMessages().then(() => {\n          // Restore scroll position after loading more messages\n          // This prevents the view from jumping to the top\n          requestAnimationFrame(() => {\n            const scrollHeightAfter = container.scrollHeight\n            container.scrollTop = scrollTopBefore + (scrollHeightAfter - scrollHeightBefore)\n          })\n        })\n      }\n    }\n\n    container.addEventListener('scroll', handleScroll)\n    return () => container.removeEventListener('scroll', handleScroll)\n  }, [hasMore, isLoadingMore, loadMoreMessages])\n\n  // Set up SSE connection for real-time messages\n  useEffect(() => {\n    if (!id || !userPhoneNumber) return\n\n    // Try to connect to SSE endpoint (only works with MESSAGING_PROVIDER=local)\n    const eventSource = new EventSource(`/api/messages/stream?phoneNumber=${encodeURIComponent(userPhoneNumber)}`)\n    eventSourceRef.current = eventSource\n\n    eventSource.onopen = () => {\n      console.log('[SSE] Connected to message stream')\n      setSseConnected(true)\n    }\n\n    eventSource.addEventListener('message', (event) => {\n      try {\n        const data = JSON.parse(event.data)\n\n        if (data.type === 'connected') {\n          console.log('[SSE] Stream ready:', data)\n        } else if (data.type === 'message' && data.message) {\n          // Add the new outbound message to the messages list\n          const newMessage: Message = {\n            id: data.message.id,\n            content: data.message.content,\n            direction: 'outbound',\n            timestamp: data.message.timestamp,\n            from: data.message.from,\n            to: data.message.to,\n          }\n\n          setMessages(prev => {\n            // Remove any temporary ack messages (starts with \"temp-ack-\")\n            // and avoid duplicates\n            const withoutTempAck = prev.filter(m => !m.id.startsWith('temp-ack-'))\n\n            if (withoutTempAck.some(m => m.id === newMessage.id)) {\n              return prev\n            }\n\n            return [...withoutTempAck, newMessage]\n          })\n\n          console.log('[SSE] Received message:', newMessage)\n        }\n      } catch (error) {\n        console.error('[SSE] Error parsing message:', error)\n      }\n    })\n\n    eventSource.onerror = (error) => {\n      console.log('[SSE] Connection error (may not be using local provider):', error)\n      setSseConnected(false)\n      eventSource.close()\n    }\n\n    // Cleanup on unmount\n    return () => {\n      console.log('[SSE] Disconnecting')\n      eventSource.close()\n      setSseConnected(false)\n    }\n  }, [id, userPhoneNumber])\n\n  const handleSendMessage = async (e: React.FormEvent) => {\n    e.preventDefault()\n    if (!inputMessage.trim() || isSending) return\n\n    const userMessage = inputMessage.trim()\n    setInputMessage('')\n    setIsSending(true)\n\n    // Optimistically add user message\n    const optimisticUserMessage: Message = {\n      id: `temp-user-${Date.now()}`,\n      content: userMessage,\n      direction: 'inbound',\n      timestamp: new Date().toISOString(),\n      from: 'user',\n      to: 'system'\n    }\n    setMessages(prev => [...prev, optimisticUserMessage])\n\n    try {\n      const response = await fetch(`/api/admin/users/${id}/chat`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ message: userMessage, userId: id }),\n      })\n\n      const result = await response.json()\n\n      if (!response.ok || !result.success) {\n        throw new Error(result.error || 'Failed to send message')\n      }\n\n      // The API now returns ack instead of the actual response\n      // Show the ack message temporarily (will be replaced by real response via SSE)\n      const ackMessage: Message = {\n        id: `temp-ack-${result.data.jobId}`,\n        content: result.data.ackMessage,\n        direction: 'outbound',\n        timestamp: result.data.timestamp,\n        from: 'system',\n        to: 'user'\n      }\n\n      // Add the ack message\n      // The actual response will arrive via SSE and replace this\n      setMessages(prev => [...prev, ackMessage])\n\n      console.log('[Admin Chat] Message queued:', {\n        jobId: result.data.jobId,\n        conversationId: result.data.conversationId,\n      })\n    } catch (err) {\n      console.error('Failed to send message:', err)\n      // Remove optimistic user message on error\n      setMessages(prev => prev.filter(m => m.id !== optimisticUserMessage.id))\n    } finally {\n      setIsSending(false)\n    }\n  }\n\n  if (isInitialLoading) {\n    return <ChatSkeleton />\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50/50\">\n      <div className=\"container mx-auto px-4 py-6 max-w-4xl\">\n        <div className=\"space-y-6\">\n          {/* Breadcrumb */}\n          <Breadcrumb>\n            <BreadcrumbList>\n              <BreadcrumbItem>\n                <BreadcrumbLink href=\"/admin/users\">Users</BreadcrumbLink>\n              </BreadcrumbItem>\n              <BreadcrumbSeparator />\n              <BreadcrumbItem>\n                <BreadcrumbLink href={`/admin/users/${id}`}>\n                  {userName || 'User'}\n                </BreadcrumbLink>\n              </BreadcrumbItem>\n              <BreadcrumbSeparator />\n              <BreadcrumbItem>\n                <BreadcrumbPage>Chat</BreadcrumbPage>\n              </BreadcrumbItem>\n            </BreadcrumbList>\n          </Breadcrumb>\n\n          {/* Chat Interface */}\n          <Card className=\"flex flex-col h-[calc(100vh-200px)]\">\n            {/* Header */}\n            <div className=\"p-4 border-b bg-white\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <h1 className=\"text-xl font-semibold\">{userName}</h1>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Admin Chat Simulator\n                    {sseConnected && (\n                      <span className=\"ml-2 inline-flex items-center gap-1 text-green-600\">\n                        <span className=\"h-2 w-2 rounded-full bg-green-600 animate-pulse\" />\n                        Live\n                      </span>\n                    )}\n                  </p>\n                </div>\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => router.push(`/admin/users/${id}`)}\n                >\n                  Back to Profile\n                </Button>\n              </div>\n            </div>\n\n            {/* Messages */}\n            <div ref={messagesContainerRef} className=\"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50\">\n              {/* Loading indicator at the top */}\n              {isLoadingMore && (\n                <div className=\"flex justify-center py-2\">\n                  <Loader className=\"h-5 w-5 animate-spin text-muted-foreground\" />\n                </div>\n              )}\n\n              {/* Show \"no more messages\" when at the end */}\n              {!hasMore && messages.length > 0 && (\n                <div className=\"flex justify-center py-2\">\n                  <p className=\"text-xs text-muted-foreground\">No more messages</p>\n                </div>\n              )}\n\n              {messages.length === 0 ? (\n                <div className=\"flex items-center justify-center h-full\">\n                  <div className=\"text-center\">\n                    <MessageCircle className=\"h-12 w-12 text-muted-foreground mx-auto mb-2\" />\n                    <p className=\"text-muted-foreground\">\n                      No messages yet. Start a conversation!\n                    </p>\n                  </div>\n                </div>\n              ) : (\n                messages.map((message) => (\n                  <MessageBubble key={message.id} message={message} />\n                ))\n              )}\n              <div ref={messagesEndRef} />\n            </div>\n\n            {/* Input */}\n            <div className=\"p-4 border-t bg-white\">\n              <form onSubmit={handleSendMessage} className=\"flex gap-2\">\n                <input\n                  type=\"text\"\n                  value={inputMessage}\n                  onChange={(e) => setInputMessage(e.target.value)}\n                  placeholder=\"Type a message...\"\n                  disabled={isSending}\n                  className=\"flex-1 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary disabled:opacity-50\"\n                />\n                <Button\n                  type=\"submit\"\n                  disabled={!inputMessage.trim() || isSending}\n                  className=\"gap-2\"\n                >\n                  {isSending ? (\n                    <>\n                      <Loader className=\"h-4 w-4 animate-spin\" />\n                      Sending...\n                    </>\n                  ) : (\n                    <>\n                      <Send className=\"h-4 w-4\" />\n                      Send\n                    </>\n                  )}\n                </Button>\n              </form>\n            </div>\n          </Card>\n        </div>\n      </div>\n    </div>\n  )\n}\n\ninterface MessageBubbleProps {\n  message: Message\n}\n\nfunction MessageBubble({ message }: MessageBubbleProps) {\n  const isInbound = message.direction === 'inbound'\n  const timestamp = new Date(message.timestamp).toLocaleTimeString('en-US', {\n    hour: 'numeric',\n    minute: '2-digit',\n  })\n\n  return (\n    <div className={`flex ${isInbound ? 'justify-end' : 'justify-start'}`}>\n      <div\n        className={`max-w-[70%] rounded-2xl px-4 py-2 ${\n          isInbound\n            ? 'bg-blue-500 text-white rounded-br-sm'\n            : 'bg-white border border-gray-200 text-gray-900 rounded-bl-sm'\n        }`}\n      >\n        <p className=\"text-sm whitespace-pre-wrap break-words\">{message.content}</p>\n        <p\n          className={`text-xs mt-1 ${\n            isInbound ? 'text-blue-100' : 'text-gray-500'\n          }`}\n        >\n          {timestamp}\n        </p>\n      </div>\n    </div>\n  )\n}\n\nfunction ChatSkeleton() {\n  return (\n    <div className=\"min-h-screen bg-gray-50/50\">\n      <div className=\"container mx-auto px-4 py-6 max-w-4xl\">\n        <div className=\"space-y-6\">\n          <Skeleton className=\"h-6 w-64\" />\n          <Card className=\"h-[calc(100vh-200px)]\">\n            <div className=\"p-4 border-b\">\n              <Skeleton className=\"h-6 w-32 mb-2\" />\n              <Skeleton className=\"h-4 w-48\" />\n            </div>\n            <div className=\"p-4 space-y-4\">\n              {Array.from({ length: 5 }).map((_, i) => (\n                <div\n                  key={i}\n                  className={`flex ${i % 2 === 0 ? 'justify-end' : 'justify-start'}`}\n                >\n                  <Skeleton className=\"h-16 w-64 rounded-2xl\" />\n                </div>\n              ))}\n            </div>\n          </Card>\n        </div>\n      </div>\n    </div>\n  )\n}\n\n// Simple icons\nconst Send = ({ className }: { className?: string }) => (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1.5} stroke=\"currentColor\" className={className}>\n    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5\" />\n  </svg>\n)\n\nconst Loader = ({ className }: { className?: string }) => (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" className={className}>\n    <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n    <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n  </svg>\n)\n\nconst MessageCircle = ({ className }: { className?: string }) => (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1.5} stroke=\"currentColor\" className={className}>\n    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z\" />\n  </svg>\n)\n"],"names":["module","exports","require","vendored","AppRouterContext","HooksClientContext","ServerInsertedHtml","ReactServerDOMTurbopackClient","useMergedRef","refA","refB","cleanupA","useRef","cleanupB","useCallback","current","cleanupFnA","cleanupFnB","applyRef","cleanup","warnOnce","_","process","env","NODE_ENV","warnings","Set","msg","has","console","warn","add"],"mappings":"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","ignoreList":[0,1,2,3,7,8]}